/**
 * Minified by jsDelivr using UglifyJS v3.3.20.
 * Original file: /npm/dragonbones-pixi@5.6.0/out/dragonBones.js
 * 
 * Do NOT use SRI with dynamically generated files! More information: https://www.jsdelivr.com/using-sri-with-dynamic-files
 */
"use strict";var dragonBones,__extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])};return function(t,e){function i(){this.constructor=t}a(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();dragonBones||(dragonBones={}),function(s){var t=function(){function e(t){this._clock=new s.WorldClock,this._events=[],this._objects=[],this._eventManager=null,this._eventManager=t,console.info("DragonBones: "+e.VERSION+"\nWebsite: http://www.dragonbones.com/\nSource: http://www.github.com/dragonbones/")}return e.prototype.advanceTime=function(t){if(0<this._objects.length){for(var e=0,i=this._objects;e<i.length;e++){i[e].returnToPool()}this._objects.length=0}if(this._clock.advanceTime(t),0<this._events.length){for(var a=0;a<this._events.length;++a){var n=this._events[a],r=n.armature;null!==r._armatureData&&(r.eventDispatcher.dispatchDBEvent(n.type,n),n.type===s.EventObject.SOUND_EVENT&&this._eventManager.dispatchDBEvent(n.type,n)),this.bufferObject(n)}this._events.length=0}},e.prototype.bufferEvent=function(t){this._events.indexOf(t)<0&&this._events.push(t)},e.prototype.bufferObject=function(t){this._objects.indexOf(t)<0&&this._objects.push(t)},Object.defineProperty(e.prototype,"clock",{get:function(){return this._clock},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"eventManager",{get:function(){return this._eventManager},enumerable:!0,configurable:!0}),e.VERSION="5.6.0",e.yDown=!0,e.debug=!1,e.debugDraw=!1,e.webAssembly=!1,e}();s.DragonBones=t,console.warn||(console.warn=function(){}),console.assert||(console.assert=function(){})}(dragonBones||(dragonBones={})),function(t){var e=function(){function r(){this.hashCode=r._hashCode++,this._isInPool=!1}return r._returnObject=function(t){var e=String(t.constructor),i=e in r._maxCountMap?r._maxCountMap[e]:r._defaultMaxCount,a=r._poolsMap[e]=r._poolsMap[e]||[];a.length<i&&(t._isInPool?console.warn("The object is already in the pool."):(t._isInPool=!0,a.push(t)))},r.toString=function(){throw new Error},r.setMaxCount=function(t,e){if((e<0||e!=e)&&(e=0),null!==t)null!==(a=(i=String(t))in r._poolsMap?r._poolsMap[i]:null)&&a.length>e&&(a.length=e),r._maxCountMap[i]=e;else for(var i in r._defaultMaxCount=e,r._poolsMap){var a;(a=r._poolsMap[i]).length>e&&(a.length=e),i in r._maxCountMap&&(r._maxCountMap[i]=e)}},r.clearPool=function(t){if(void 0===t&&(t=null),null!==t){var e=String(t);null!==(a=e in r._poolsMap?r._poolsMap[e]:null)&&0<a.length&&(a.length=0)}else for(var i in r._poolsMap){var a;(a=r._poolsMap[i]).length=0}},r.borrowObject=function(t){var e=String(t),i=e in r._poolsMap?r._poolsMap[e]:null;if(null!==i&&0<i.length){var a=i.pop();return a._isInPool=!1,a}var n=new t;return n._onClear(),n},r.prototype.returnToPool=function(){this._onClear(),r._returnObject(this)},r._hashCode=0,r._defaultMaxCount=3e3,r._maxCountMap={},r._poolsMap={},r}();t.BaseObject=e}(dragonBones||(dragonBones={})),function(t){var e=function(){function t(t,e,i,a,n,r){void 0===t&&(t=1),void 0===e&&(e=0),void 0===i&&(i=0),void 0===a&&(a=1),void 0===n&&(n=0),void 0===r&&(r=0),this.a=t,this.b=e,this.c=i,this.d=a,this.tx=n,this.ty=r}return t.prototype.toString=function(){return"[object dragonBones.Matrix] a:"+this.a+" b:"+this.b+" c:"+this.c+" d:"+this.d+" tx:"+this.tx+" ty:"+this.ty},t.prototype.copyFrom=function(t){return this.a=t.a,this.b=t.b,this.c=t.c,this.d=t.d,this.tx=t.tx,this.ty=t.ty,this},t.prototype.copyFromArray=function(t,e){return void 0===e&&(e=0),this.a=t[e],this.b=t[e+1],this.c=t[e+2],this.d=t[e+3],this.tx=t[e+4],this.ty=t[e+5],this},t.prototype.identity=function(){return this.a=this.d=1,this.b=this.c=0,this.tx=this.ty=0,this},t.prototype.concat=function(t){var e=this.a*t.a,i=0,a=0,n=this.d*t.d,r=this.tx*t.a+t.tx,s=this.ty*t.d+t.ty;return 0===this.b&&0===this.c||(e+=this.b*t.c,i+=this.b*t.d,a+=this.c*t.a,n+=this.c*t.b),0===t.b&&0===t.c||(i+=this.a*t.b,a+=this.d*t.c,r+=this.ty*t.c,s+=this.tx*t.b),this.a=e,this.b=i,this.c=a,this.d=n,this.tx=r,this.ty=s,this},t.prototype.invert=function(){var t=this.a,e=this.b,i=this.c,a=this.d,n=this.tx,r=this.ty;if(0===e&&0===i)return this.b=this.c=0,0===t||0===a?this.a=this.b=this.tx=this.ty=0:(t=this.a=1/t,a=this.d=1/a,this.tx=-t*n,this.ty=-a*r),this;var s=t*a-e*i;if(0===s)return this.a=this.d=1,this.b=this.c=0,this.tx=this.ty=0,this;s=1/s;var o=this.a=a*s;return e=this.b=-e*s,i=this.c=-i*s,a=this.d=t*s,this.tx=-(o*n+i*r),this.ty=-(e*n+a*r),this},t.prototype.transformPoint=function(t,e,i,a){void 0===a&&(a=!1),i.x=this.a*t+this.c*e,i.y=this.b*t+this.d*e,a||(i.x+=this.tx,i.y+=this.ty)},t.prototype.transformRectangle=function(t,e){void 0===e&&(e=!1);var i=this.a,a=this.b,n=this.c,r=this.d,s=e?0:this.tx,o=e?0:this.ty,l=t.x,h=t.y,u=l+t.width,_=h+t.height,f=i*l+n*h+s,m=a*l+r*h+o,p=i*u+n*h+s,c=a*u+r*h+o,d=i*u+n*_+s,y=a*u+r*_+o,g=i*l+n*_+s,b=a*l+r*_+o,v=0;p<f&&(v=f,f=p,p=v),g<d&&(v=d,d=g,g=v),t.x=Math.floor(f<d?f:d),t.width=Math.ceil((g<p?p:g)-t.x),c<m&&(v=m,m=c,c=v),b<y&&(v=y,y=b,b=v),t.y=Math.floor(m<y?m:y),t.height=Math.ceil((b<c?c:b)-t.y)},t}();t.Matrix=e}(dragonBones||(dragonBones={})),function(t){var e=function(){function r(t,e,i,a,n,r){void 0===t&&(t=0),void 0===e&&(e=0),void 0===i&&(i=0),void 0===a&&(a=0),void 0===n&&(n=1),void 0===r&&(r=1),this.x=t,this.y=e,this.skew=i,this.rotation=a,this.scaleX=n,this.scaleY=r}return r.normalizeRadian=function(t){return t=(t+Math.PI)%(2*Math.PI),t+=0<t?-Math.PI:Math.PI},r.prototype.toString=function(){return"[object dragonBones.Transform] x:"+this.x+" y:"+this.y+" skewX:"+180*this.skew/Math.PI+" skewY:"+180*this.rotation/Math.PI+" scaleX:"+this.scaleX+" scaleY:"+this.scaleY},r.prototype.copyFrom=function(t){return this.x=t.x,this.y=t.y,this.skew=t.skew,this.rotation=t.rotation,this.scaleX=t.scaleX,this.scaleY=t.scaleY,this},r.prototype.identity=function(){return this.x=this.y=0,this.skew=this.rotation=0,this.scaleX=this.scaleY=1,this},r.prototype.add=function(t){return this.x+=t.x,this.y+=t.y,this.skew+=t.skew,this.rotation+=t.rotation,this.scaleX*=t.scaleX,this.scaleY*=t.scaleY,this},r.prototype.minus=function(t){return this.x-=t.x,this.y-=t.y,this.skew-=t.skew,this.rotation-=t.rotation,this.scaleX/=t.scaleX,this.scaleY/=t.scaleY,this},r.prototype.fromMatrix=function(t){var e=this.scaleX,i=this.scaleY,a=r.PI_Q;this.x=t.tx,this.y=t.ty,this.rotation=Math.atan(t.b/t.a);var n=Math.atan(-t.c/t.d);return this.scaleX=this.rotation>-a&&this.rotation<a?t.a/Math.cos(this.rotation):t.b/Math.sin(this.rotation),this.scaleY=-a<n&&n<a?t.d/Math.cos(n):-t.c/Math.sin(n),0<=e&&this.scaleX<0&&(this.scaleX=-this.scaleX,this.rotation=this.rotation-Math.PI),0<=i&&this.scaleY<0&&(this.scaleY=-this.scaleY,n-=Math.PI),this.skew=n-this.rotation,this},r.prototype.toMatrix=function(t){return 0!==this.skew||0!==this.rotation?(t.a=Math.cos(this.rotation),t.b=Math.sin(this.rotation),0===this.skew?(t.c=-t.b,t.d=t.a):(t.c=-Math.sin(this.skew+this.rotation),t.d=Math.cos(this.skew+this.rotation)),1!==this.scaleX&&(t.a*=this.scaleX,t.b*=this.scaleX),1!==this.scaleY&&(t.c*=this.scaleY,t.d*=this.scaleY)):(t.a=this.scaleX,t.b=0,t.c=0,t.d=this.scaleY),t.tx=this.x,t.ty=this.y,this},r.PI_D=2*Math.PI,r.PI_H=Math.PI/2,r.PI_Q=Math.PI/4,r.RAD_DEG=180/Math.PI,r.DEG_RAD=Math.PI/180,r}();t.Transform=e}(dragonBones||(dragonBones={})),function(t){var e=function(){function t(t,e,i,a,n,r,s,o){void 0===t&&(t=1),void 0===e&&(e=1),void 0===i&&(i=1),void 0===a&&(a=1),void 0===n&&(n=0),void 0===r&&(r=0),void 0===s&&(s=0),void 0===o&&(o=0),this.alphaMultiplier=t,this.redMultiplier=e,this.greenMultiplier=i,this.blueMultiplier=a,this.alphaOffset=n,this.redOffset=r,this.greenOffset=s,this.blueOffset=o}return t.prototype.copyFrom=function(t){this.alphaMultiplier=t.alphaMultiplier,this.redMultiplier=t.redMultiplier,this.greenMultiplier=t.greenMultiplier,this.blueMultiplier=t.blueMultiplier,this.alphaOffset=t.alphaOffset,this.redOffset=t.redOffset,this.greenOffset=t.greenOffset,this.blueOffset=t.blueOffset},t.prototype.identity=function(){this.alphaMultiplier=this.redMultiplier=this.greenMultiplier=this.blueMultiplier=1,this.alphaOffset=this.redOffset=this.greenOffset=this.blueOffset=0},t}();t.ColorTransform=e}(dragonBones||(dragonBones={})),function(t){var e=function(){function t(t,e){void 0===t&&(t=0),void 0===e&&(e=0),this.x=t,this.y=e}return t.prototype.copyFrom=function(t){this.x=t.x,this.y=t.y},t.prototype.clear=function(){this.x=this.y=0},t}();t.Point=e}(dragonBones||(dragonBones={})),function(t){var e=function(){function t(t,e,i,a){void 0===t&&(t=0),void 0===e&&(e=0),void 0===i&&(i=0),void 0===a&&(a=0),this.x=t,this.y=e,this.width=i,this.height=a}return t.prototype.copyFrom=function(t){this.x=t.x,this.y=t.y,this.width=t.width,this.height=t.height},t.prototype.clear=function(){this.x=this.y=0,this.width=this.height=0},t}();t.Rectangle=e}(dragonBones||(dragonBones={})),function(t){var e=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.ints=[],t.floats=[],t.strings=[],t}return __extends(t,e),t.toString=function(){return"[class dragonBones.UserData]"},t.prototype._onClear=function(){this.ints.length=0,this.floats.length=0,this.strings.length=0},t.prototype.addInt=function(t){this.ints.push(t)},t.prototype.addFloat=function(t){this.floats.push(t)},t.prototype.addString=function(t){this.strings.push(t)},t.prototype.getInt=function(t){return void 0===t&&(t=0),0<=t&&t<this.ints.length?this.ints[t]:0},t.prototype.getFloat=function(t){return void 0===t&&(t=0),0<=t&&t<this.floats.length?this.floats[t]:0},t.prototype.getString=function(t){return void 0===t&&(t=0),0<=t&&t<this.strings.length?this.strings[t]:""},t}(t.BaseObject);t.UserData=e;var i=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.data=null,t}return __extends(t,e),t.toString=function(){return"[class dragonBones.ActionData]"},t.prototype._onClear=function(){null!==this.data&&this.data.returnToPool(),this.type=0,this.name="",this.bone=null,this.slot=null,this.data=null},t}(t.BaseObject);t.ActionData=i}(dragonBones||(dragonBones={})),function(t){var e=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.frameIndices=[],t.cachedFrames=[],t.armatureNames=[],t.armatures={},t.userData=null,t}return __extends(t,e),t.toString=function(){return"[class dragonBones.DragonBonesData]"},t.prototype._onClear=function(){for(var t in this.armatures)this.armatures[t].returnToPool(),delete this.armatures[t];null!==this.userData&&this.userData.returnToPool(),this.autoSearch=!1,this.frameRate=0,this.version="",this.name="",this.stage=null,this.frameIndices.length=0,this.cachedFrames.length=0,this.armatureNames.length=0,this.binary=null,this.intArray=null,this.floatArray=null,this.frameIntArray=null,this.frameFloatArray=null,this.frameArray=null,this.timelineArray=null,this.userData=null},t.prototype.addArmature=function(t){t.name in this.armatures?console.warn("Same armature: "+t.name):((t.parent=this).armatures[t.name]=t,this.armatureNames.push(t.name))},t.prototype.getArmature=function(t){return t in this.armatures?this.armatures[t]:null},t.prototype.dispose=function(){console.warn("已废弃"),this.returnToPool()},t}(t.BaseObject);t.DragonBonesData=e}(dragonBones||(dragonBones={})),function(i){var t=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.aabb=new i.Rectangle,t.animationNames=[],t.sortedBones=[],t.sortedSlots=[],t.defaultActions=[],t.actions=[],t.bones={},t.slots={},t.constraints={},t.skins={},t.animations={},t.canvas=null,t.userData=null,t}return __extends(t,e),t.toString=function(){return"[class dragonBones.ArmatureData]"},t.prototype._onClear=function(){for(var t=0,e=this.defaultActions;t<e.length;t++){e[t].returnToPool()}for(var i=0,a=this.actions;i<a.length;i++){a[i].returnToPool()}for(var n in this.bones)this.bones[n].returnToPool(),delete this.bones[n];for(var n in this.slots)this.slots[n].returnToPool(),delete this.slots[n];for(var n in this.constraints)this.constraints[n].returnToPool(),delete this.constraints[n];for(var n in this.skins)this.skins[n].returnToPool(),delete this.skins[n];for(var n in this.animations)this.animations[n].returnToPool(),delete this.animations[n];null!==this.canvas&&this.canvas.returnToPool(),null!==this.userData&&this.userData.returnToPool(),this.type=0,this.frameRate=0,this.cacheFrameRate=0,this.scale=1,this.name="",this.aabb.clear(),this.animationNames.length=0,this.sortedBones.length=0,this.sortedSlots.length=0,this.defaultActions.length=0,this.actions.length=0,this.defaultSkin=null,this.defaultAnimation=null,this.canvas=null,this.userData=null,this.parent=null},t.prototype.sortBones=function(){var t=this.sortedBones.length;if(!(t<=0)){var e=this.sortedBones.concat(),i=0,a=0;for(this.sortedBones.length=0;a<t;){var n=e[i++];if(t<=i&&(i=0),!(0<=this.sortedBones.indexOf(n))){var r=!1;for(var s in this.constraints){var o=this.constraints[s];if(o.bone===n&&this.sortedBones.indexOf(o.target)<0){r=!0;break}}r||null!==n.parent&&this.sortedBones.indexOf(n.parent)<0||(this.sortedBones.push(n),a++)}}}},t.prototype.cacheFrames=function(t){if(!(0<this.cacheFrameRate))for(var e in this.cacheFrameRate=t,this.animations)this.animations[e].cacheFrames(this.cacheFrameRate)},t.prototype.setCacheFrame=function(t,e){var i=this.parent.cachedFrames,a=i.length;return i.length+=10,i[a]=t.a,i[a+1]=t.b,i[a+2]=t.c,i[a+3]=t.d,i[a+4]=t.tx,i[a+5]=t.ty,i[a+6]=e.rotation,i[a+7]=e.skew,i[a+8]=e.scaleX,i[a+9]=e.scaleY,a},t.prototype.getCacheFrame=function(t,e,i){var a=this.parent.cachedFrames;t.a=a[i],t.b=a[i+1],t.c=a[i+2],t.d=a[i+3],t.tx=a[i+4],t.ty=a[i+5],e.rotation=a[i+6],e.skew=a[i+7],e.scaleX=a[i+8],e.scaleY=a[i+9],e.x=t.tx,e.y=t.ty},t.prototype.addBone=function(t){t.name in this.bones?console.warn("Same bone: "+t.name):(this.bones[t.name]=t,this.sortedBones.push(t))},t.prototype.addSlot=function(t){t.name in this.slots?console.warn("Same slot: "+t.name):(this.slots[t.name]=t,this.sortedSlots.push(t))},t.prototype.addConstraint=function(t){t.name in this.constraints?console.warn("Same constraint: "+t.name):this.constraints[t.name]=t},t.prototype.addSkin=function(t){t.name in this.skins?console.warn("Same skin: "+t.name):((t.parent=this).skins[t.name]=t,null===this.defaultSkin&&(this.defaultSkin=t),"default"===t.name&&(this.defaultSkin=t))},t.prototype.addAnimation=function(t){t.name in this.animations?console.warn("Same animation: "+t.name):((t.parent=this).animations[t.name]=t,this.animationNames.push(t.name),null===this.defaultAnimation&&(this.defaultAnimation=t))},t.prototype.addAction=function(t,e){e?this.defaultActions.push(t):this.actions.push(t)},t.prototype.getBone=function(t){return t in this.bones?this.bones[t]:null},t.prototype.getSlot=function(t){return t in this.slots?this.slots[t]:null},t.prototype.getConstraint=function(t){return t in this.constraints?this.constraints[t]:null},t.prototype.getSkin=function(t){return t in this.skins?this.skins[t]:null},t.prototype.getAnimation=function(t){return t in this.animations?this.animations[t]:null},t}(i.BaseObject);i.ArmatureData=t;var e=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.transform=new i.Transform,t.userData=null,t}return __extends(t,e),t.toString=function(){return"[class dragonBones.BoneData]"},t.prototype._onClear=function(){null!==this.userData&&this.userData.returnToPool(),this.inheritTranslation=!1,this.inheritRotation=!1,this.inheritScale=!1,this.inheritReflection=!1,this.length=0,this.name="",this.transform.identity(),this.userData=null,this.parent=null},t}(i.BaseObject);i.BoneData=e;var a=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.color=null,t.userData=null,t}return __extends(t,e),t.createColor=function(){return new i.ColorTransform},t.toString=function(){return"[class dragonBones.SlotData]"},t.prototype._onClear=function(){null!==this.userData&&this.userData.returnToPool(),this.blendMode=0,this.displayIndex=0,this.zOrder=0,this.name="",this.color=null,this.userData=null,this.parent=null},t.DEFAULT_COLOR=new i.ColorTransform,t}(i.BaseObject);i.SlotData=a}(dragonBones||(dragonBones={})),function(t){var e=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype._onClear=function(){this.order=0,this.name="",this.target=null,this.bone=null,this.root=null},e}(t.BaseObject),i=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.toString=function(){return"[class dragonBones.IKConstraintData]"},e.prototype._onClear=function(){t.prototype._onClear.call(this),this.scaleEnabled=!1,this.bendPositive=!1,this.weight=1},e}(t.ConstraintData=e);t.IKConstraintData=i}(dragonBones||(dragonBones={})),function(t){var e=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.toString=function(){return"[class dragonBones.CanvasData]"},e.prototype._onClear=function(){this.hasBackground=!1,this.color=0,this.x=0,this.y=0,this.width=0,this.height=0},e}(t.BaseObject);t.CanvasData=e}(dragonBones||(dragonBones={})),function(t){var e=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.displays={},t}return __extends(t,e),t.toString=function(){return"[class dragonBones.SkinData]"},t.prototype._onClear=function(){for(var t in this.displays){for(var e=0,i=this.displays[t];e<i.length;e++){var a=i[e];null!==a&&a.returnToPool()}delete this.displays[t]}this.name="",this.parent=null},t.prototype.addDisplay=function(t,e){t in this.displays||(this.displays[t]=[]),null!==e&&(e.parent=this),this.displays[t].push(e)},t.prototype.getDisplay=function(t,e){var i=this.getDisplays(t);if(null!==i)for(var a=0,n=i;a<n.length;a++){var r=n[a];if(null!==r&&r.name===e)return r}return null},t.prototype.getDisplays=function(t){return t in this.displays?this.displays[t]:null},t}(t.BaseObject);t.SkinData=e}(dragonBones||(dragonBones={})),function(i){var t=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.transform=new i.Transform,t}return __extends(t,e),t.prototype._onClear=function(){this.name="",this.path="",this.transform.identity(),this.parent=null},t}(i.BaseObject),e=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.pivot=new i.Point,t}return __extends(t,e),t.toString=function(){return"[class dragonBones.ImageDisplayData]"},t.prototype._onClear=function(){e.prototype._onClear.call(this),this.type=0,this.pivot.clear(),this.texture=null},t}(i.DisplayData=t);i.ImageDisplayData=e;var a=function(i){function t(){var t=null!==i&&i.apply(this,arguments)||this;return t.actions=[],t}return __extends(t,i),t.toString=function(){return"[class dragonBones.ArmatureDisplayData]"},t.prototype._onClear=function(){i.prototype._onClear.call(this);for(var t=0,e=this.actions;t<e.length;t++){e[t].returnToPool()}this.type=1,this.inheritAnimation=!1,this.actions.length=0,this.armature=null},t.prototype.addAction=function(t){this.actions.push(t)},t}(t);i.ArmatureDisplayData=a;var n=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.weight=null,t}return __extends(t,e),t.toString=function(){return"[class dragonBones.MeshDisplayData]"},t.prototype._onClear=function(){e.prototype._onClear.call(this),null!==this.weight&&this.weight.returnToPool(),this.type=2,this.inheritAnimation=!1,this.offset=0,this.weight=null},t}(e);i.MeshDisplayData=n;var r=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.boundingBox=null,t}return __extends(t,e),t.toString=function(){return"[class dragonBones.BoundingBoxDisplayData]"},t.prototype._onClear=function(){e.prototype._onClear.call(this),null!==this.boundingBox&&this.boundingBox.returnToPool(),this.type=3,this.boundingBox=null},t}(t);i.BoundingBoxDisplayData=r;var s=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.bones=[],t}return __extends(t,e),t.toString=function(){return"[class dragonBones.WeightData]"},t.prototype._onClear=function(){this.count=0,this.offset=0,this.bones.length=0},t.prototype.addBone=function(t){this.bones.push(t)},t}(i.BaseObject);i.WeightData=s}(dragonBones||(dragonBones={})),function(t){var e=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype._onClear=function(){this.color=0,this.width=0,this.height=0},e}(t.BaseObject),h=function(t){function v(){return null!==t&&t.apply(this,arguments)||this}return __extends(v,t),v.toString=function(){return"[class dragonBones.RectangleBoundingBoxData]"},v._computeOutCode=function(t,e,i,a,n,r){var s=0;return t<i?s|=1:n<t&&(s|=2),e<a?s|=4:r<e&&(s|=8),s},v.rectangleIntersectsSegment=function(t,e,i,a,n,r,s,o,l,h,u){void 0===l&&(l=null),void 0===h&&(h=null),void 0===u&&(u=null);var _=n<t&&t<s&&r<e&&e<o,f=n<i&&i<s&&r<a&&a<o;if(_&&f)return-1;for(var m=0,p=v._computeOutCode(t,e,n,r,s,o),c=v._computeOutCode(i,a,n,r,s,o);;){if(0==(p|c)){m=2;break}if(0!=(p&c))break;var d=0,y=0,g=0,b=0!==p?p:c;0!=(4&b)?(d=t+(i-t)*(r-e)/(a-e),y=r,null!==u&&(g=.5*-Math.PI)):0!=(8&b)?(d=t+(i-t)*(o-e)/(a-e),y=o,null!==u&&(g=.5*Math.PI)):0!=(2&b)?(y=e+(a-e)*(s-t)/(i-t),d=s,null!==u&&(g=0)):0!=(1&b)&&(y=e+(a-e)*(n-t)/(i-t),d=n,null!==u&&(g=Math.PI)),b===p?(p=v._computeOutCode(t=d,e=y,n,r,s,o),null!==u&&(u.x=g)):(c=v._computeOutCode(i=d,a=y,n,r,s,o),null!==u&&(u.y=g))}return m&&(_?(m=2,null!==l&&(l.x=i,l.y=a),null!==h&&(h.x=i,h.y=i),null!==u&&(u.x=u.y+Math.PI)):f?(m=1,null!==l&&(l.x=t,l.y=e),null!==h&&(h.x=t,h.y=e),null!==u&&(u.y=u.x+Math.PI)):(m=3,null!==l&&(l.x=t,l.y=e),null!==h&&(h.x=i,h.y=a))),m},v.prototype._onClear=function(){t.prototype._onClear.call(this),this.type=0},v.prototype.containsPoint=function(t,e){var i=.5*this.width;if(-i<=t&&t<=i){var a=.5*this.height;if(-a<=e&&e<=a)return!0}return!1},v.prototype.intersectsSegment=function(t,e,i,a,n,r,s){void 0===n&&(n=null),void 0===r&&(r=null),void 0===s&&(s=null);var o=.5*this.width,l=.5*this.height;return v.rectangleIntersectsSegment(t,e,i,a,-o,-l,o,l,n,r,s)},v}(t.BoundingBoxData=e);t.RectangleBoundingBoxData=h;var i=function(t){function o(){return null!==t&&t.apply(this,arguments)||this}return __extends(o,t),o.toString=function(){return"[class dragonBones.EllipseData]"},o.ellipseIntersectsSegment=function(t,e,i,a,n,r,s,o,l,h,u){void 0===l&&(l=null),void 0===h&&(h=null),void 0===u&&(u=null);var _=s/o,f=_*_,m=i-t,p=(a*=_)-(e*=_),c=Math.sqrt(m*m+p*p),d=m/c,y=p/c,g=(n-t)*d+(r-e)*y,b=s*s,v=b-(t*t+e*e)+g*g,T=0;if(0<=v){var D=Math.sqrt(v),A=g-D,O=g+D,S=A<0?-1:A<=c?0:1,x=O<0?-1:O<=c?0:1,B=S*x;if(B<0)return-1;0===B&&(-1===S?(T=2,i=t+O*d,a=(e+O*y)/_,null!==l&&(l.x=i,l.y=a),null!==h&&(h.x=i,h.y=a),null!==u&&(u.x=Math.atan2(a/b*f,i/b),u.y=u.x+Math.PI)):1===x?(T=1,t+=A*d,e=(e+A*y)/_,null!==l&&(l.x=t,l.y=e),null!==h&&(h.x=t,h.y=e),null!==u&&(u.x=Math.atan2(e/b*f,t/b),u.y=u.x+Math.PI)):(T=3,null!==l&&(l.x=t+A*d,l.y=(e+A*y)/_,null!==u&&(u.x=Math.atan2(l.y/b*f,l.x/b))),null!==h&&(h.x=t+O*d,h.y=(e+O*y)/_,null!==u&&(u.y=Math.atan2(h.y/b*f,h.x/b)))))}return T},o.prototype._onClear=function(){t.prototype._onClear.call(this),this.type=1},o.prototype.containsPoint=function(t,e){var i=.5*this.width;if(-i<=t&&t<=i){var a=.5*this.height;if(-a<=e&&e<=a)return e*=i/a,Math.sqrt(t*t+e*e)<=i}return!1},o.prototype.intersectsSegment=function(t,e,i,a,n,r,s){return void 0===n&&(n=null),void 0===r&&(r=null),void 0===s&&(s=null),o.ellipseIntersectsSegment(t,e,i,a,0,0,.5*this.width,.5*this.height,n,r,s)},o}(e);t.EllipseBoundingBoxData=i;var a=function(e){function l(){var t=null!==e&&e.apply(this,arguments)||this;return t.vertices=[],t.weight=null,t}return __extends(l,e),l.toString=function(){return"[class dragonBones.PolygonBoundingBoxData]"},l.polygonIntersectsSegment=function(t,e,i,a,n,r,s,o){void 0===r&&(r=null),void 0===s&&(s=null),void 0===o&&(o=null),t===i&&(t=i+1e-6),e===a&&(e=a+1e-6);for(var l=n.length,h=t-i,u=e-a,_=t*a-e*i,f=0,m=n[l-2],p=n[l-1],c=0,d=0,y=0,g=0,b=0,v=0,T=0;T<l;T+=2){var D=n[T],A=n[T+1];m===D&&(m=D+1e-4),p===A&&(p=A+1e-4);var O=m-D,S=p-A,x=m*A-p*D,B=h*S-u*O,P=(_*O-h*x)/B;if((m<=P&&P<=D||D<=P&&P<=m)&&(0===h||t<=P&&P<=i||i<=P&&P<=t)){var E=(_*S-u*x)/B;if((p<=E&&E<=A||A<=E&&E<=p)&&(0===u||e<=E&&E<=a||a<=E&&E<=e)){if(null===s){b=y=P,v=g=E,f++,null!==o&&(o.x=Math.atan2(A-p,D-m)-.5*Math.PI,o.y=o.x);break}var I=P-t;I<0&&(I=-I),0===f?(d=c=I,b=y=P,v=g=E,null!==o&&(o.x=Math.atan2(A-p,D-m)-.5*Math.PI,o.y=o.x)):(I<c&&(c=I,y=P,g=E,null!==o&&(o.x=Math.atan2(A-p,D-m)-.5*Math.PI)),d<I&&(d=I,b=P,v=E,null!==o&&(o.y=Math.atan2(A-p,D-m)-.5*Math.PI))),f++}}m=D,p=A}return 1===f?(null!==r&&(r.x=y,r.y=g),null!==s&&(s.x=y,s.y=g),null!==o&&(o.y=o.x+Math.PI)):1<f&&(f++,null!==r&&(r.x=y,r.y=g),null!==s&&(s.x=b,s.y=v)),f},l.prototype._onClear=function(){e.prototype._onClear.call(this),null!==this.weight&&this.weight.returnToPool(),this.type=2,this.x=0,this.y=0,this.vertices.length=0,this.weight=null},l.prototype.containsPoint=function(t,e){var i=!1;if(t>=this.x&&t<=this.width&&e>=this.y&&e<=this.height)for(var a=0,n=this.vertices.length,r=n-2;a<n;a+=2){var s=this.vertices[r+1],o=this.vertices[a+1];if(o<e&&e<=s||s<e&&e<=o){var l=this.vertices[r],h=this.vertices[a];(e-o)*(l-h)/(s-o)+h<t&&(i=!i)}r=a}return i},l.prototype.intersectsSegment=function(t,e,i,a,n,r,s){void 0===n&&(n=null),void 0===r&&(r=null),void 0===s&&(s=null);var o=0;return 0!==h.rectangleIntersectsSegment(t,e,i,a,this.x,this.y,this.width,this.height,null,null,null)&&(o=l.polygonIntersectsSegment(t,e,i,a,this.vertices,n,r,s)),o},l}(e);t.PolygonBoundingBoxData=a}(dragonBones||(dragonBones={})),function(t){var e=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.cachedFrames=[],t.boneTimelines={},t.slotTimelines={},t.constraintTimelines={},t.boneCachedFrameIndices={},t.slotCachedFrameIndices={},t.actionTimeline=null,t.zOrderTimeline=null,t}return __extends(t,e),t.toString=function(){return"[class dragonBones.AnimationData]"},t.prototype._onClear=function(){for(var t in this.boneTimelines){for(var e=0,i=this.boneTimelines[t];e<i.length;e++){i[e].returnToPool()}delete this.boneTimelines[t]}for(var t in this.slotTimelines){for(var a=0,n=this.slotTimelines[t];a<n.length;a++){n[a].returnToPool()}delete this.slotTimelines[t]}for(var t in this.constraintTimelines){for(var r=0,s=this.constraintTimelines[t];r<s.length;r++){s[r].returnToPool()}delete this.constraintTimelines[t]}for(var t in this.boneCachedFrameIndices)delete this.boneCachedFrameIndices[t];for(var t in this.slotCachedFrameIndices)delete this.slotCachedFrameIndices[t];null!==this.actionTimeline&&this.actionTimeline.returnToPool(),null!==this.zOrderTimeline&&this.zOrderTimeline.returnToPool(),this.frameIntOffset=0,this.frameFloatOffset=0,this.frameOffset=0,this.frameCount=0,this.playTimes=0,this.duration=0,this.scale=1,this.fadeInTime=0,this.cacheFrameRate=0,this.name="",this.cachedFrames.length=0,this.actionTimeline=null,this.zOrderTimeline=null,this.parent=null},t.prototype.cacheFrames=function(t){if(!(0<this.cacheFrameRate)){this.cacheFrameRate=Math.max(Math.ceil(t*this.scale),1);var e=Math.ceil(this.cacheFrameRate*this.duration)+1;this.cachedFrames.length=e;for(var i=0,a=this.cacheFrames.length;i<a;++i)this.cachedFrames[i]=!1;for(var n=0,r=this.parent.sortedBones;n<r.length;n++){var s=r[n];for(i=0,a=(h=new Array(e)).length;i<a;++i)h[i]=-1;this.boneCachedFrameIndices[s.name]=h}for(var o=0,l=this.parent.sortedSlots;o<l.length;o++){var h,u=l[o];for(i=0,a=(h=new Array(e)).length;i<a;++i)h[i]=-1;this.slotCachedFrameIndices[u.name]=h}}},t.prototype.addBoneTimeline=function(t,e){var i=t.name in this.boneTimelines?this.boneTimelines[t.name]:this.boneTimelines[t.name]=[];i.indexOf(e)<0&&i.push(e)},t.prototype.addSlotTimeline=function(t,e){var i=t.name in this.slotTimelines?this.slotTimelines[t.name]:this.slotTimelines[t.name]=[];i.indexOf(e)<0&&i.push(e)},t.prototype.addConstraintTimeline=function(t,e){var i=t.name in this.constraintTimelines?this.constraintTimelines[t.name]:this.constraintTimelines[t.name]=[];i.indexOf(e)<0&&i.push(e)},t.prototype.getBoneTimelines=function(t){return t in this.boneTimelines?this.boneTimelines[t]:null},t.prototype.getSlotTimelines=function(t){return t in this.slotTimelines?this.slotTimelines[t]:null},t.prototype.getConstraintTimelines=function(t){return t in this.constraintTimelines?this.constraintTimelines[t]:null},t.prototype.getBoneCachedFrameIndices=function(t){return t in this.boneCachedFrameIndices?this.boneCachedFrameIndices[t]:null},t.prototype.getSlotCachedFrameIndices=function(t){return t in this.slotCachedFrameIndices?this.slotCachedFrameIndices[t]:null},t}(t.BaseObject);t.AnimationData=e;var i=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.toString=function(){return"[class dragonBones.TimelineData]"},e.prototype._onClear=function(){this.type=10,this.offset=0,this.frameIndicesOffset=-1},e}(t.BaseObject);t.TimelineData=i}(dragonBones||(dragonBones={})),function(t){var e=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.boneMask=[],t}return __extends(t,e),t.toString=function(){return"[class dragonBones.AnimationConfig]"},t.prototype._onClear=function(){this.pauseFadeOut=!0,this.fadeOutMode=4,this.fadeOutTweenType=1,this.fadeOutTime=-1,this.actionEnabled=!0,this.additiveBlending=!1,this.displayControl=!0,this.pauseFadeIn=!0,this.resetToPose=!0,this.fadeInTweenType=1,this.playTimes=-1,this.layer=0,this.position=0,this.duration=-1,this.timeScale=-100,this.weight=1,this.fadeInTime=-1,this.autoFadeOutTime=-1,this.name="",this.animation="",this.group="",this.boneMask.length=0},t.prototype.clear=function(){this._onClear()},t.prototype.copyFrom=function(t){this.pauseFadeOut=t.pauseFadeOut,this.fadeOutMode=t.fadeOutMode,this.autoFadeOutTime=t.autoFadeOutTime,this.fadeOutTweenType=t.fadeOutTweenType,this.actionEnabled=t.actionEnabled,this.additiveBlending=t.additiveBlending,this.displayControl=t.displayControl,this.pauseFadeIn=t.pauseFadeIn,this.resetToPose=t.resetToPose,this.playTimes=t.playTimes,this.layer=t.layer,this.position=t.position,this.duration=t.duration,this.timeScale=t.timeScale,this.fadeInTime=t.fadeInTime,this.fadeOutTime=t.fadeOutTime,this.fadeInTweenType=t.fadeInTweenType,this.weight=t.weight,this.name=t.name,this.animation=t.animation,this.group=t.group,this.boneMask.length=t.boneMask.length;for(var e=0,i=this.boneMask.length;e<i;++e)this.boneMask[e]=t.boneMask[e]},t.prototype.containsBoneMask=function(t){return 0===this.boneMask.length||0<=this.boneMask.indexOf(t)},t.prototype.addBoneMask=function(t,e,i){void 0===i&&(i=!0);var a=t.getBone(e);if(null!==a&&(this.boneMask.indexOf(e)<0&&this.boneMask.push(e),i))for(var n=0,r=t.getBones();n<r.length;n++){var s=r[n];this.boneMask.indexOf(s.name)<0&&a.contains(s)&&this.boneMask.push(s.name)}},t.prototype.removeBoneMask=function(t,e,i){void 0===i&&(i=!0);var a=this.boneMask.indexOf(e);if(0<=a&&this.boneMask.splice(a,1),i){var n=t.getBone(e);if(null!==n)if(0<this.boneMask.length)for(var r=0,s=t.getBones();r<s.length;r++){var o=s[r],l=this.boneMask.indexOf(o.name);0<=l&&n.contains(o)&&this.boneMask.splice(l,1)}else for(var h=0,u=t.getBones();h<u.length;h++){(o=u[h])!==n&&(n.contains(o)||this.boneMask.push(o.name))}}},t}(t.BaseObject);t.AnimationConfig=e}(dragonBones||(dragonBones={})),function(a){var t=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.textures={},t}return __extends(t,e),t.prototype._onClear=function(){for(var t in this.textures)this.textures[t].returnToPool(),delete this.textures[t];this.autoSearch=!1,this.width=0,this.height=0,this.scale=1,this.name="",this.imagePath=""},t.prototype.copyFrom=function(t){for(var e in this.autoSearch=t.autoSearch,this.scale=t.scale,this.width=t.width,this.height=t.height,this.name=t.name,this.imagePath=t.imagePath,this.textures)this.textures[e].returnToPool(),delete this.textures[e];for(var e in t.textures){var i=this.createTexture();i.copyFrom(t.textures[e]),this.textures[e]=i}},t.prototype.addTexture=function(t){t.name in this.textures?console.warn("Same texture: "+t.name):(t.parent=this).textures[t.name]=t},t.prototype.getTexture=function(t){return t in this.textures?this.textures[t]:null},t}(a.BaseObject);a.TextureAtlasData=t;var e=function(e){function i(){var t=null!==e&&e.apply(this,arguments)||this;return t.region=new a.Rectangle,t.frame=null,t}return __extends(i,e),i.createRectangle=function(){return new a.Rectangle},i.prototype._onClear=function(){this.rotated=!1,this.name="",this.region.clear(),this.parent=null,this.frame=null},i.prototype.copyFrom=function(t){this.rotated=t.rotated,this.name=t.name,this.region.copyFrom(t.region),this.parent=t.parent,null===this.frame&&null!==t.frame?this.frame=i.createRectangle():null!==this.frame&&null===t.frame&&(this.frame=null),null!==this.frame&&null!==t.frame&&this.frame.copyFrom(t.frame)},i}(a.BaseObject);a.TextureData=e}(dragonBones||(dragonBones={})),function(n){var t=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._bones=[],t._slots=[],t._constraints=[],t._actions=[],t._animation=null,t._proxy=null,t._replaceTextureAtlasData=null,t._clock=null,t}return __extends(t,e),t.toString=function(){return"[class dragonBones.Armature]"},t._onSortSlots=function(t,e){return t._zOrder>e._zOrder?1:-1},t.prototype._onClear=function(){null!==this._clock&&this._clock.remove(this);for(var t=0,e=this._bones;t<e.length;t++){e[t].returnToPool()}for(var i=0,a=this._slots;i<a.length;i++){a[i].returnToPool()}for(var n=0,r=this._constraints;n<r.length;n++){r[n].returnToPool()}null!==this._animation&&this._animation.returnToPool(),null!==this._proxy&&this._proxy.dbClear(),null!==this._replaceTextureAtlasData&&this._replaceTextureAtlasData.returnToPool(),this.inheritAnimation=!0,this.userData=null,this._lockUpdate=!1,this._bonesDirty=!1,this._slotsDirty=!1,this._zOrderDirty=!1,this._flipX=!1,this._flipY=!1,this._cacheFrameIndex=-1,this._bones.length=0,this._slots.length=0,this._constraints.length=0,this._actions.length=0,this._armatureData=null,this._animation=null,this._proxy=null,this._display=null,this._replaceTextureAtlasData=null,this._replacedTexture=null,this._dragonBones=null,this._clock=null,this._parent=null},t.prototype._sortBones=function(){var t=this._bones.length;if(!(t<=0)){var e=this._bones.concat(),i=0,a=0;for(this._bones.length=0;a<t;){var n=e[i++];if(t<=i&&(i=0),!(0<=this._bones.indexOf(n))){if(n._hasConstraint){for(var r=!1,s=0,o=this._constraints;s<o.length;s++){var l=o[s];if(l._bone===n&&this._bones.indexOf(l._target)<0){r=!0;break}}if(r)continue}null!==n.parent&&this._bones.indexOf(n.parent)<0||(this._bones.push(n),a++)}}}},t.prototype._sortSlots=function(){this._slots.sort(t._onSortSlots)},t.prototype._sortZOrder=function(t,e){var i=this._armatureData.sortedSlots,a=null===t;if(this._zOrderDirty||!a){for(var n=0,r=i.length;n<r;++n){var s=a?n:t[e+n];if(!(s<0||r<=s)){var o=i[s],l=this.getSlot(o.name);null!==l&&l._setZorder(n)}}this._slotsDirty=!0,this._zOrderDirty=!a}},t.prototype._addBoneToBoneList=function(t){this._bones.indexOf(t)<0&&(this._bonesDirty=!0,this._bones.push(t))},t.prototype._removeBoneFromBoneList=function(t){var e=this._bones.indexOf(t);0<=e&&this._bones.splice(e,1)},t.prototype._addSlotToSlotList=function(t){this._slots.indexOf(t)<0&&(this._slotsDirty=!0,this._slots.push(t))},t.prototype._removeSlotFromSlotList=function(t){var e=this._slots.indexOf(t);0<=e&&this._slots.splice(e,1)},t.prototype._bufferAction=function(t,e){this._actions.indexOf(t)<0&&(e?this._actions.push(t):this._actions.unshift(t))},t.prototype.dispose=function(){null!==this._armatureData&&(this._lockUpdate=!0,this._dragonBones.bufferObject(this))},t.prototype.init=function(t,e,i,a){null===this._armatureData&&(this._armatureData=t,this._animation=n.BaseObject.borrowObject(n.Animation),this._proxy=e,this._display=i,this._dragonBones=a,this._proxy.dbInit(this),this._animation.init(this),this._animation.animations=this._armatureData.animations)},t.prototype.advanceTime=function(t){if(!this._lockUpdate)if(null!==this._armatureData)if(null!==this._armatureData.parent){var e=this._cacheFrameIndex;if(this._animation.advanceTime(t),this._bonesDirty&&(this._bonesDirty=!1,this._sortBones()),this._slotsDirty&&(this._slotsDirty=!1,this._sortSlots()),this._cacheFrameIndex<0||this._cacheFrameIndex!==e){var i=0,a=0;for(i=0,a=this._bones.length;i<a;++i)this._bones[i].update(this._cacheFrameIndex);for(i=0,a=this._slots.length;i<a;++i)this._slots[i].update(this._cacheFrameIndex)}if(0<this._actions.length){this._lockUpdate=!0;for(var n=0,r=this._actions;n<r.length;n++){var s=r[n];0===s.type&&this._animation.fadeIn(s.name)}this._actions.length=0,this._lockUpdate=!1}this._proxy.dbUpdate()}else console.warn("The armature data has been disposed.\nPlease make sure dispose armature before call factory.clear().");else console.warn("The armature has been disposed.")},t.prototype.invalidUpdate=function(t,e){if(void 0===t&&(t=null),void 0===e&&(e=!1),null!==t&&0<t.length){if(null!==(s=this.getBone(t))&&(s.invalidUpdate(),e))for(var i=0,a=this._slots;i<a.length;i++){(h=a[i]).parent===s&&h.invalidUpdate()}}else{for(var n=0,r=this._bones;n<r.length;n++){var s;(s=r[n]).invalidUpdate()}if(e)for(var o=0,l=this._slots;o<l.length;o++){var h;(h=l[o]).invalidUpdate()}}},t.prototype.containsPoint=function(t,e){for(var i=0,a=this._slots;i<a.length;i++){var n=a[i];if(n.containsPoint(t,e))return n}return null},t.prototype.intersectsSegment=function(t,e,i,a,n,r,s){void 0===n&&(n=null),void 0===r&&(r=null),void 0===s&&(s=null);for(var o=t===i,l=0,h=0,u=0,_=0,f=0,m=0,p=0,c=0,d=null,y=null,g=0,b=this._slots;g<b.length;g++){var v=b[g];if(0<v.intersectsSegment(t,e,i,a,n,r,s)){if(null===n&&null===r){d=v;break}var T;null!==n&&((T=o?n.y-e:n.x-t)<0&&(T=-T),(null===d||T<l)&&(l=T,u=n.x,_=n.y,d=v,s&&(p=s.x))),null!==r&&((T=r.x-t)<0&&(T=-T),(null===y||h<T)&&(h=T,f=r.x,m=r.y,y=v,null!==s&&(c=s.y)))}}return null!==d&&null!==n&&(n.x=u,n.y=_,null!==s&&(s.x=p)),null!==y&&null!==r&&(r.x=f,r.y=m,null!==s&&(s.y=c)),d},t.prototype.getBone=function(t){for(var e=0,i=this._bones;e<i.length;e++){var a=i[e];if(a.name===t)return a}return null},t.prototype.getBoneByDisplay=function(t){var e=this.getSlotByDisplay(t);return null!==e?e.parent:null},t.prototype.getSlot=function(t){for(var e=0,i=this._slots;e<i.length;e++){var a=i[e];if(a.name===t)return a}return null},t.prototype.getSlotByDisplay=function(t){if(null!==t)for(var e=0,i=this._slots;e<i.length;e++){var a=i[e];if(a.display===t)return a}return null},t.prototype.addBone=function(t,e){console.assert(null!==t),t._setArmature(this),t._setParent(0<e.length?this.getBone(e):null)},t.prototype.addSlot=function(t,e){var i=this.getBone(e);console.assert(null!==t&&null!==i),t._setArmature(this),t._setParent(i)},t.prototype.addConstraint=function(t){this._constraints.indexOf(t)<0&&this._constraints.push(t)},t.prototype.removeBone=function(t){console.assert(null!==t&&t.armature===this),t._setParent(null),t._setArmature(null)},t.prototype.removeSlot=function(t){console.assert(null!==t&&t.armature===this),t._setParent(null),t._setArmature(null)},t.prototype.getBones=function(){return this._bones},t.prototype.getSlots=function(){return this._slots},Object.defineProperty(t.prototype,"flipX",{get:function(){return this._flipX},set:function(t){this._flipX!==t&&(this._flipX=t,this.invalidUpdate())},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"flipY",{get:function(){return this._flipY},set:function(t){this._flipY!==t&&(this._flipY=t,this.invalidUpdate())},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"cacheFrameRate",{get:function(){return this._armatureData.cacheFrameRate},set:function(t){if(this._armatureData.cacheFrameRate!==t){this._armatureData.cacheFrames(t);for(var e=0,i=this._slots;e<i.length;e++){var a=i[e].childArmature;null!==a&&(a.cacheFrameRate=t)}}},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"name",{get:function(){return this._armatureData.name},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"armatureData",{get:function(){return this._armatureData},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"animation",{get:function(){return this._animation},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"proxy",{get:function(){return this._proxy},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"eventDispatcher",{get:function(){return this._proxy},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"display",{get:function(){return this._display},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"replacedTexture",{get:function(){return this._replacedTexture},set:function(t){if(this._replacedTexture!==t){null!==this._replaceTextureAtlasData&&(this._replaceTextureAtlasData.returnToPool(),this._replaceTextureAtlasData=null),this._replacedTexture=t;for(var e=0,i=this._slots;e<i.length;e++){var a=i[e];a.invalidUpdate(),a.update(-1)}}},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"clock",{get:function(){return this._clock},set:function(t){if(this._clock!==t){null!==this._clock&&this._clock.remove(this),this._clock=t,this._clock&&this._clock.add(this);for(var e=0,i=this._slots;e<i.length;e++){var a=i[e].childArmature;null!==a&&(a.clock=this._clock)}}},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"parent",{get:function(){return this._parent},enumerable:!0,configurable:!0}),t.prototype.replaceTexture=function(t){this.replacedTexture=t},t.prototype.hasEventListener=function(t){return this._proxy.hasDBEventListener(t)},t.prototype.addEventListener=function(t,e,i){this._proxy.addDBEventListener(t,e,i)},t.prototype.removeEventListener=function(t,e,i){this._proxy.removeDBEventListener(t,e,i)},t.prototype.enableAnimationCache=function(t){this.cacheFrameRate=t},t.prototype.getDisplay=function(){return this._display},t}(n.BaseObject);n.Armature=t}(dragonBones||(dragonBones={})),function(i){var t=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.globalTransformMatrix=new i.Matrix,t.global=new i.Transform,t.offset=new i.Transform,t}return __extends(t,e),t.prototype._onClear=function(){this.globalTransformMatrix.identity(),this.global.identity(),this.offset.identity(),this.origin=null,this.userData=null,this._globalDirty=!1,this._armature=null,this._parent=null},t.prototype._setArmature=function(t){this._armature=t},t.prototype._setParent=function(t){this._parent=t},t.prototype.updateGlobalTransform=function(){this._globalDirty&&(this._globalDirty=!1,this.global.fromMatrix(this.globalTransformMatrix))},Object.defineProperty(t.prototype,"armature",{get:function(){return this._armature},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"parent",{get:function(){return this._parent},enumerable:!0,configurable:!0}),t._helpMatrix=new i.Matrix,t._helpTransform=new i.Transform,t._helpPoint=new i.Point,t}(i.BaseObject);i.TransformObject=t}(dragonBones||(dragonBones={})),function(u){var t=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.animationPose=new u.Transform,t}return __extends(t,e),t.toString=function(){return"[class dragonBones.Bone]"},t.prototype._onClear=function(){e.prototype._onClear.call(this),this.offsetMode=1,this.animationPose.identity(),this._transformDirty=!1,this._childrenTransformDirty=!1,this._blendDirty=!1,this._localDirty=!0,this._hasConstraint=!1,this._visible=!0,this._cachedFrameIndex=-1,this._blendLayer=0,this._blendLeftWeight=1,this._blendLayerWeight=0,this._boneData=null,this._cachedFrameIndices=null},t.prototype._updateGlobalTransformMatrix=function(t){var e=this._armature.flipX,i=this._armature.flipY===u.DragonBones.yDown,a=null!==this._parent,n=0,r=this.global,s=this.globalTransformMatrix;if(1===this.offsetMode?(r.x=this.origin.x+this.offset.x+this.animationPose.x,r.y=this.origin.y+this.offset.y+this.animationPose.y,r.skew=this.origin.skew+this.offset.skew+this.animationPose.skew,r.rotation=this.origin.rotation+this.offset.rotation+this.animationPose.rotation,r.scaleX=this.origin.scaleX*this.offset.scaleX*this.animationPose.scaleX,r.scaleY=this.origin.scaleY*this.offset.scaleY*this.animationPose.scaleY):0===this.offsetMode?r.copyFrom(this.origin).add(this.animationPose):(a=!1,r.copyFrom(this.offset)),a){var o=this._parent.globalTransformMatrix;if(this._boneData.inheritScale)this._boneData.inheritRotation||(this._parent.updateGlobalTransform(),n=e&&i?r.rotation-(this._parent.global.rotation+Math.PI):e?r.rotation+this._parent.global.rotation+Math.PI:i?r.rotation+this._parent.global.rotation:r.rotation-this._parent.global.rotation,r.rotation=n),r.toMatrix(s),s.concat(o),this._boneData.inheritTranslation?(r.x=s.tx,r.y=s.ty):(s.tx=r.x,s.ty=r.y),t?r.fromMatrix(s):this._globalDirty=!0;else{if(this._boneData.inheritTranslation){var l=r.x,h=r.y;r.x=o.a*l+o.c*h+o.tx,r.y=o.d*h+o.b*l+o.ty}else e&&(r.x=-r.x),i&&(r.y=-r.y);this._boneData.inheritRotation?(this._parent.updateGlobalTransform(),n=this._parent.global.scaleX<0?r.rotation+this._parent.global.rotation+Math.PI:r.rotation+this._parent.global.rotation,o.a*o.d-o.b*o.c<0&&(n-=2*r.rotation,(e!==i||this._boneData.inheritReflection)&&(r.skew+=Math.PI)),r.rotation=n):(e||i)&&(e&&i?n=r.rotation+Math.PI:(n=e?Math.PI-r.rotation:-r.rotation,r.skew+=Math.PI),r.rotation=n),r.toMatrix(s)}}else(e||i)&&(e&&(r.x=-r.x),i&&(r.y=-r.y),e&&i?n=r.rotation+Math.PI:(n=e?Math.PI-r.rotation:-r.rotation,r.skew+=Math.PI),r.rotation=n),r.toMatrix(s)},t.prototype._setArmature=function(t){if(this._armature!==t){var e=null,i=null;if(null!==this._armature&&(e=this.getSlots(),i=this.getBones(),this._armature._removeBoneFromBoneList(this)),this._armature=t,null!==this._armature&&this._armature._addBoneToBoneList(this),null!==e)for(var a=0,n=e;a<n.length;a++){var r=n[a];r.parent===this&&r._setArmature(this._armature)}if(null!==i)for(var s=0,o=i;s<o.length;s++){var l=o[s];l.parent===this&&l._setArmature(this._armature)}}},t.prototype.init=function(t){null===this._boneData&&(this._boneData=t,this.origin=this._boneData.transform)},t.prototype.update=function(t){if(this._blendDirty=!1,0<=t&&null!==this._cachedFrameIndices){var e=this._cachedFrameIndices[t];if(0<=e&&this._cachedFrameIndex===e)this._transformDirty=!1;else if(0<=e)this._transformDirty=!0,this._cachedFrameIndex=e;else{if(this._hasConstraint)for(var i=0,a=this._armature._constraints;i<a.length;i++){(s=a[i])._bone===this&&s.update()}this._transformDirty||null!==this._parent&&this._parent._childrenTransformDirty?(this._transformDirty=!0,this._cachedFrameIndex=-1):0<=this._cachedFrameIndex?(this._transformDirty=!1,this._cachedFrameIndices[t]=this._cachedFrameIndex):(this._transformDirty=!0,this._cachedFrameIndex=-1)}}else{if(this._hasConstraint)for(var n=0,r=this._armature._constraints;n<r.length;n++){var s;(s=r[n])._bone===this&&s.update()}(this._transformDirty||null!==this._parent&&this._parent._childrenTransformDirty)&&(t=-1,this._transformDirty=!0,this._cachedFrameIndex=-1)}if(this._transformDirty)if(this._transformDirty=!1,this._childrenTransformDirty=!0,this._cachedFrameIndex<0){var o=0<=t;this._localDirty&&this._updateGlobalTransformMatrix(o),o&&null!==this._cachedFrameIndices&&(this._cachedFrameIndex=this._cachedFrameIndices[t]=this._armature._armatureData.setCacheFrame(this.globalTransformMatrix,this.global))}else this._armature._armatureData.getCacheFrame(this.globalTransformMatrix,this.global,this._cachedFrameIndex);else this._childrenTransformDirty&&(this._childrenTransformDirty=!1);this._localDirty=!0},t.prototype.updateByConstraint=function(){this._localDirty&&(this._localDirty=!1,(this._transformDirty||null!==this._parent&&this._parent._childrenTransformDirty)&&this._updateGlobalTransformMatrix(!0),this._transformDirty=!0)},t.prototype.invalidUpdate=function(){this._transformDirty=!0},t.prototype.contains=function(t){if(t===this)return!1;for(var e=t;e!==this&&null!==e;)e=e.parent;return e===this},Object.defineProperty(t.prototype,"boneData",{get:function(){return this._boneData},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"visible",{get:function(){return this._visible},set:function(t){if(this._visible!==t){this._visible=t;for(var e=0,i=this._armature.getSlots();e<i.length;e++){var a=i[e];a._parent===this&&a._updateVisible()}}},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"name",{get:function(){return this._boneData.name},enumerable:!0,configurable:!0}),t.prototype.getBones=function(){for(var t=new Array,e=0,i=this._armature.getBones();e<i.length;e++){var a=i[e];a.parent===this&&t.push(a)}return t},t.prototype.getSlots=function(){for(var t=new Array,e=0,i=this._armature.getSlots();e<i.length;e++){var a=i[e];a.parent===this&&t.push(a)}return t},Object.defineProperty(t.prototype,"slot",{get:function(){for(var t=0,e=this._armature.getSlots();t<e.length;t++){var i=e[t];if(i.parent===this)return i}return null},enumerable:!0,configurable:!0}),t}(u.TransformObject);u.Bone=t}(dragonBones||(dragonBones={})),function(h){var t=function(s){function m(){var t=null!==s&&s.apply(this,arguments)||this;return t._localMatrix=new h.Matrix,t._colorTransform=new h.ColorTransform,t._ffdVertices=[],t._displayDatas=[],t._displayList=[],t._meshBones=[],t._rawDisplay=null,t._meshDisplay=null,t}return __extends(m,s),m.prototype._onClear=function(){s.prototype._onClear.call(this);for(var t=[],e=0,i=this._displayList;e<i.length;e++){null!==(r=i[e])&&r!==this._rawDisplay&&r!==this._meshDisplay&&t.indexOf(r)<0&&t.push(r)}for(var a=0,n=t;a<n.length;a++){var r;(r=n[a])instanceof h.Armature?r.dispose():this._disposeDisplay(r)}null!==this._meshDisplay&&this._meshDisplay!==this._rawDisplay&&this._disposeDisplay(this._meshDisplay),null!==this._rawDisplay&&this._disposeDisplay(this._rawDisplay),this.displayController=null,this._displayDirty=!1,this._zOrderDirty=!1,this._blendModeDirty=!1,this._colorDirty=!1,this._meshDirty=!1,this._transformDirty=!1,this._visible=!0,this._blendMode=0,this._displayIndex=-1,this._animationDisplayIndex=-1,this._zOrder=0,this._cachedFrameIndex=-1,this._pivotX=0,this._pivotY=0,this._localMatrix.identity(),this._colorTransform.identity(),this._ffdVertices.length=0,this._displayList.length=0,this._displayDatas.length=0,this._meshBones.length=0,this._slotData=null,this._rawDisplayDatas=null,this._displayData=null,this._textureData=null,this._meshData=null,this._boundingBoxData=null,this._rawDisplay=null,this._meshDisplay=null,this._display=null,this._childArmature=null,this._cachedFrameIndices=null},m.prototype._updateDisplayData=function(){var t=this._displayData,e=this._textureData,i=this._meshData,a=0<=this._displayIndex&&null!==this._rawDisplayDatas&&this._displayIndex<this._rawDisplayDatas.length?this._rawDisplayDatas[this._displayIndex]:null;if(0<=this._displayIndex&&this._displayIndex<this._displayDatas.length?this._displayData=this._displayDatas[this._displayIndex]:this._displayData=null,null!==this._displayData&&(0===this._displayData.type||2===this._displayData.type)?(this._textureData=this._displayData.texture,2===this._displayData.type?this._meshData=this._displayData:null!==a&&2===a.type?this._meshData=a:this._meshData=null):(this._textureData=null,this._meshData=null),null!==this._displayData&&3===this._displayData.type?this._boundingBoxData=this._displayData.boundingBox:null!==a&&3===a.type?this._boundingBoxData=a.boundingBox:this._boundingBoxData=null,this._displayData!==t||this._textureData!==e||this._meshData!==i){if(null!==this._meshData)this._pivotX=0,this._pivotY=0;else if(null!==this._textureData){var n=this._displayData,r=this._textureData.parent.scale*this._armature._armatureData.scale,s=this._textureData.frame;this._pivotX=n.pivot.x,this._pivotY=n.pivot.y;var o=null!==s?s:this._textureData.region,l=o.width,h=o.height;this._textureData.rotated&&null===s&&(l=o.height,h=o.width),this._pivotX*=l*r,this._pivotY*=h*r,null!==s&&(this._pivotX+=s.x*r,this._pivotY+=s.y*r)}else this._pivotX=0,this._pivotY=0;if(this._meshData!==i)if(null!==this._meshData){if(null!==this._meshData.weight){this._ffdVertices.length=2*this._meshData.weight.count,this._meshBones.length=this._meshData.weight.bones.length;for(var u=0,_=this._meshBones.length;u<_;++u)this._meshBones[u]=this._armature.getBone(this._meshData.weight.bones[u].name)}else{var f=this._meshData.parent.parent.parent.intArray[this._meshData.offset+0];this._ffdVertices.length=2*f,this._meshBones.length=0}for(u=0,_=this._ffdVertices.length;u<_;++u)this._ffdVertices[u]=0;this._meshDirty=!0}else this._ffdVertices.length=0,this._meshBones.length=0;else null!==this._meshData&&this._textureData!==e&&(this._meshDirty=!0);null!==this._displayData&&null!==a&&this._displayData!==a&&null===this._meshData&&(a.transform.toMatrix(m._helpMatrix),m._helpMatrix.invert(),m._helpMatrix.transformPoint(0,0,m._helpPoint),this._pivotX-=m._helpPoint.x,this._pivotY-=m._helpPoint.y,this._displayData.transform.toMatrix(m._helpMatrix),m._helpMatrix.invert(),m._helpMatrix.transformPoint(0,0,m._helpPoint),this._pivotX+=m._helpPoint.x,this._pivotY+=m._helpPoint.y),null!==a?this.origin=a.transform:null!==this._displayData&&(this.origin=this._displayData.transform),this._displayDirty=!0,this._transformDirty=!0}},m.prototype._updateDisplay=function(){var t=null!==this._display?this._display:this._rawDisplay,e=this._childArmature;0<=this._displayIndex&&this._displayIndex<this._displayList.length?(this._display=this._displayList[this._displayIndex],null!==this._display&&this._display instanceof h.Armature?(this._childArmature=this._display,this._display=this._childArmature.display):this._childArmature=null):(this._display=null,this._childArmature=null);var i=null!==this._display?this._display:this._rawDisplay;if(i!==t&&(this._onUpdateDisplay(),this._replaceDisplay(t),this._visibleDirty=!0,this._blendModeDirty=!0,this._colorDirty=!0),i!==this._rawDisplay&&i!==this._meshDisplay||this._updateFrame(),this._childArmature!==e&&(null!==e&&(e._parent=null,e.clock=null,e.inheritAnimation&&e.animation.reset()),null!==this._childArmature&&((this._childArmature._parent=this)._childArmature.clock=this._armature.clock,this._childArmature.inheritAnimation))){if(0===this._childArmature.cacheFrameRate){var a=this._armature.cacheFrameRate;0!==a&&(this._childArmature.cacheFrameRate=a)}var n=null;if(null!==this._displayData&&1===this._displayData.type)n=this._displayData.actions;else{var r=0<=this._displayIndex&&null!==this._rawDisplayDatas&&this._displayIndex<this._rawDisplayDatas.length?this._rawDisplayDatas[this._displayIndex]:null;null!==r&&1===r.type&&(n=r.actions)}if(null!==n&&0<n.length)for(var s=0,o=n;s<o.length;s++){var l=o[s];this._childArmature._bufferAction(l,!1)}else this._childArmature.animation.play()}},m.prototype._updateGlobalTransformMatrix=function(t){this.globalTransformMatrix.copyFrom(this._localMatrix),this.globalTransformMatrix.concat(this._parent.globalTransformMatrix),t?this.global.fromMatrix(this.globalTransformMatrix):this._globalDirty=!0},m.prototype._isMeshBonesUpdate=function(){for(var t=0,e=this._meshBones;t<e.length;t++){var i=e[t];if(null!==i&&i._childrenTransformDirty)return!0}return!1},m.prototype._setArmature=function(t){this._armature!==t&&(null!==this._armature&&this._armature._removeSlotFromSlotList(this),this._armature=t,this._onUpdateDisplay(),null!==this._armature?(this._armature._addSlotToSlotList(this),this._addDisplay()):this._removeDisplay())},m.prototype._setDisplayIndex=function(t,e){if(void 0===e&&(e=!1),e){if(this._animationDisplayIndex===t)return!1;this._animationDisplayIndex=t}return this._displayIndex!==t&&(this._displayIndex=t,this._displayDirty=!0,this._updateDisplayData(),this._displayDirty)},m.prototype._setZorder=function(t){return this._zOrder,this._zOrder=t,this._zOrderDirty=!0,this._zOrderDirty},m.prototype._setColor=function(t){return this._colorTransform.copyFrom(t),this._colorDirty=!0,this._colorDirty},m.prototype._setDisplayList=function(t){if(null!==t&&0<t.length){this._displayList.length!==t.length&&(this._displayList.length=t.length);for(var e=0,i=t.length;e<i;++e){var a=t[e];null!==a&&a!==this._rawDisplay&&a!==this._meshDisplay&&!(a instanceof h.Armature)&&this._displayList.indexOf(a)<0&&this._initDisplay(a),this._displayList[e]=a}}else 0<this._displayList.length&&(this._displayList.length=0);return 0<=this._displayIndex&&this._displayIndex<this._displayList.length?this._displayDirty=this._display!==this._displayList[this._displayIndex]:this._displayDirty=null!==this._display,this._updateDisplayData(),this._displayDirty},m.prototype.init=function(t,e,i,a){null===this._slotData&&(this._slotData=t,this._visibleDirty=!0,this._blendModeDirty=!0,this._colorDirty=!0,this._blendMode=this._slotData.blendMode,this._zOrder=this._slotData.zOrder,this._colorTransform.copyFrom(this._slotData.color),this._rawDisplay=i,this._meshDisplay=a,this.rawDisplayDatas=e)},m.prototype.update=function(t){if(this._displayDirty&&(this._displayDirty=!1,this._updateDisplay(),this._transformDirty&&(null!==this.origin?this.global.copyFrom(this.origin).add(this.offset).toMatrix(this._localMatrix):this.global.copyFrom(this.offset).toMatrix(this._localMatrix))),this._zOrderDirty&&(this._zOrderDirty=!1,this._updateZOrder()),0<=t&&null!==this._cachedFrameIndices){var e=this._cachedFrameIndices[t];0<=e&&this._cachedFrameIndex===e?this._transformDirty=!1:0<=e?(this._transformDirty=!0,this._cachedFrameIndex=e):this._transformDirty||this._parent._childrenTransformDirty?(this._transformDirty=!0,this._cachedFrameIndex=-1):0<=this._cachedFrameIndex?(this._transformDirty=!1,this._cachedFrameIndices[t]=this._cachedFrameIndex):(this._transformDirty=!0,this._cachedFrameIndex=-1)}else(this._transformDirty||this._parent._childrenTransformDirty)&&(t=-1,this._transformDirty=!0,this._cachedFrameIndex=-1);if(null!==this._display){if(this._visibleDirty&&(this._visibleDirty=!1,this._updateVisible()),this._blendModeDirty&&(this._blendModeDirty=!1,this._updateBlendMode()),this._colorDirty&&(this._colorDirty=!1,this._updateColor()),null!==this._meshData&&this._display===this._meshDisplay){var i=null!==this._meshData.weight;if((this._meshDirty||i&&this._isMeshBonesUpdate())&&(this._meshDirty=!1,this._updateMesh()),i)return void(this._transformDirty&&(this._transformDirty=!1,this._updateTransform(!0)))}if(this._transformDirty){if(this._transformDirty=!1,this._cachedFrameIndex<0){var a=0<=t;this._updateGlobalTransformMatrix(a),a&&null!==this._cachedFrameIndices&&(this._cachedFrameIndex=this._cachedFrameIndices[t]=this._armature._armatureData.setCacheFrame(this.globalTransformMatrix,this.global))}else this._armature._armatureData.getCacheFrame(this.globalTransformMatrix,this.global,this._cachedFrameIndex);this._updateTransform(!1)}}},m.prototype.updateTransformAndMatrix=function(){this._transformDirty&&(this._transformDirty=!1,this._updateGlobalTransformMatrix(!1))},m.prototype.replaceDisplayData=function(t,e){if(void 0===e&&(e=-1),e<0&&(e=this._displayIndex<0?0:this._displayIndex),this._displayDatas.length<=e){this._displayDatas.length=e+1;for(var i=0,a=this._displayDatas.length;i<a;++i)this._displayDatas[i]||(this._displayDatas[i]=null)}this._displayDatas[e]=t},m.prototype.containsPoint=function(t,e){return null!==this._boundingBoxData&&(this.updateTransformAndMatrix(),m._helpMatrix.copyFrom(this.globalTransformMatrix),m._helpMatrix.invert(),m._helpMatrix.transformPoint(t,e,m._helpPoint),this._boundingBoxData.containsPoint(m._helpPoint.x,m._helpPoint.y))},m.prototype.intersectsSegment=function(t,e,i,a,n,r,s){if(void 0===n&&(n=null),void 0===r&&(r=null),void 0===s&&(s=null),null===this._boundingBoxData)return 0;this.updateTransformAndMatrix(),m._helpMatrix.copyFrom(this.globalTransformMatrix),m._helpMatrix.invert(),m._helpMatrix.transformPoint(t,e,m._helpPoint),t=m._helpPoint.x,e=m._helpPoint.y,m._helpMatrix.transformPoint(i,a,m._helpPoint),i=m._helpPoint.x,a=m._helpPoint.y;var o=this._boundingBoxData.intersectsSegment(t,e,i,a,n,r,s);return 0<o&&(1===o||2===o?null!==n?(this.globalTransformMatrix.transformPoint(n.x,n.y,n),null!==r&&(r.x=n.x,r.y=n.y)):null!==r&&this.globalTransformMatrix.transformPoint(r.x,r.y,r):(null!==n&&this.globalTransformMatrix.transformPoint(n.x,n.y,n),null!==r&&this.globalTransformMatrix.transformPoint(r.x,r.y,r)),null!==s&&(this.globalTransformMatrix.transformPoint(Math.cos(s.x),Math.sin(s.x),m._helpPoint,!0),s.x=Math.atan2(m._helpPoint.y,m._helpPoint.x),this.globalTransformMatrix.transformPoint(Math.cos(s.y),Math.sin(s.y),m._helpPoint,!0),s.y=Math.atan2(m._helpPoint.y,m._helpPoint.x))),o},m.prototype.invalidUpdate=function(){this._displayDirty=!0,this._transformDirty=!0},Object.defineProperty(m.prototype,"visible",{get:function(){return this._visible},set:function(t){this._visible!==t&&(this._visible=t,this._updateVisible())},enumerable:!0,configurable:!0}),Object.defineProperty(m.prototype,"displayIndex",{get:function(){return this._displayIndex},set:function(t){this._setDisplayIndex(t)&&this.update(-1)},enumerable:!0,configurable:!0}),Object.defineProperty(m.prototype,"name",{get:function(){return this._slotData.name},enumerable:!0,configurable:!0}),Object.defineProperty(m.prototype,"displayList",{get:function(){return this._displayList.concat()},set:function(t){var e=this._displayList.concat(),i=new Array;this._setDisplayList(t)&&this.update(-1);for(var a=0,n=e;a<n.length;a++){null!==(o=n[a])&&o!==this._rawDisplay&&o!==this._meshDisplay&&this._displayList.indexOf(o)<0&&i.indexOf(o)<0&&i.push(o)}for(var r=0,s=i;r<s.length;r++){var o;(o=s[r])instanceof h.Armature?o.dispose():this._disposeDisplay(o)}},enumerable:!0,configurable:!0}),Object.defineProperty(m.prototype,"slotData",{get:function(){return this._slotData},enumerable:!0,configurable:!0}),Object.defineProperty(m.prototype,"rawDisplayDatas",{get:function(){return this._rawDisplayDatas},set:function(t){if(this._rawDisplayDatas!==t)if(this._displayDirty=!0,this._rawDisplayDatas=t,this._rawDisplayDatas){this._displayDatas.length=this._rawDisplayDatas.length;for(var e=0,i=this._displayDatas.length;e<i;++e)this._displayDatas[e]=this._rawDisplayDatas[e]}else this._displayDatas.length=0},enumerable:!0,configurable:!0}),Object.defineProperty(m.prototype,"boundingBoxData",{get:function(){return this._boundingBoxData},enumerable:!0,configurable:!0}),Object.defineProperty(m.prototype,"rawDisplay",{get:function(){return this._rawDisplay},enumerable:!0,configurable:!0}),Object.defineProperty(m.prototype,"meshDisplay",{get:function(){return this._meshDisplay},enumerable:!0,configurable:!0}),Object.defineProperty(m.prototype,"display",{get:function(){return this._display},set:function(t){if(this._display!==t){var e=this._displayList.length;if(this._displayIndex<0&&0===e&&(this._displayIndex=0),!(this._displayIndex<0)){var i=this.displayList;e<=this._displayIndex&&(i.length=this._displayIndex+1),i[this._displayIndex]=t,this.displayList=i}}},enumerable:!0,configurable:!0}),Object.defineProperty(m.prototype,"childArmature",{get:function(){return this._childArmature},set:function(t){this._childArmature!==t&&(this.display=t)},enumerable:!0,configurable:!0}),m.prototype.getDisplay=function(){return this.display},m.prototype.setDisplay=function(t){this.display=t},m}(h.TransformObject);h.Slot=t}(dragonBones||(dragonBones={})),function(M){var t=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype._onClear=function(){this._armature=null,this._target=null,this._bone=null,this._root=null},Object.defineProperty(e.prototype,"name",{get:function(){return this._constraintData.name},enumerable:!0,configurable:!0}),e._helpMatrix=new M.Matrix,e._helpTransform=new M.Transform,e._helpPoint=new M.Point,e}(M.BaseObject),e=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.toString=function(){return"[class dragonBones.IKConstraint]"},e.prototype._onClear=function(){t.prototype._onClear.call(this),this._scaleEnabled=!1,this._bendPositive=!1,this._weight=1,this._constraintData=null},e.prototype._computeA=function(){var t=this._target.global,e=this._bone.global,i=this._bone.globalTransformMatrix,a=Math.atan2(t.y-e.y,t.x-e.x);e.scaleX<0&&(a+=Math.PI),e.rotation+=(a-e.rotation)*this._weight,e.toMatrix(i)},e.prototype._computeB=function(){var t=this._bone._boneData.length,e=this._root,i=this._target.global,a=e.global,n=this._bone.global,r=this._bone.globalTransformMatrix,s=r.a*t,o=r.b*t,l=s*s+o*o,h=Math.sqrt(l),u=n.x-a.x,_=n.y-a.y,f=u*u+_*_,m=Math.sqrt(f),p=n.rotation,c=a.rotation,d=Math.atan2(_,u),y=(u=i.x-a.x)*u+(_=i.y-a.y)*_,g=Math.sqrt(y),b=0;if(h+m<=g||g+h<=m||g+m<=h)b=Math.atan2(i.y-a.y,i.x-a.x),h+m<=g||m<h&&(b+=Math.PI);else{var v=(f-l+y)/(2*y),T=Math.sqrt(f-v*v*y)/g,D=a.x+u*v,A=a.y+_*v,O=-_*T,S=u*T,x=!1;if(null!==e._parent){var B=e._parent.globalTransformMatrix;x=B.a*B.d-B.b*B.c<0}x!==this._bendPositive?(n.x=D-O,n.y=A-S):(n.x=D+O,n.y=A+S),b=Math.atan2(n.y-a.y,n.x-a.x)}var P=M.Transform.normalizeRadian(b-d);a.rotation=c+P*this._weight,a.toMatrix(e.globalTransformMatrix);var E=d+P*this._weight;n.x=a.x+Math.cos(E)*m,n.y=a.y+Math.sin(E)*m;var I=Math.atan2(i.y-n.y,i.x-n.x);n.scaleX<0&&(I+=Math.PI),n.rotation=a.rotation+p-c+M.Transform.normalizeRadian(I-P-p)*this._weight,n.toMatrix(r)},e.prototype.init=function(t,e){if(null===this._constraintData){this._constraintData=t,this._armature=e,this._target=this._armature.getBone(this._constraintData.target.name),this._bone=this._armature.getBone(this._constraintData.bone.name),this._root=null!==this._constraintData.root?this._armature.getBone(this._constraintData.root.name):null;var i=this._constraintData;this._scaleEnabled=i.scaleEnabled,this._bendPositive=i.bendPositive,this._weight=i.weight,this._bone._hasConstraint=!0}},e.prototype.update=function(){null===this._root?(this._bone.updateByConstraint(),this._computeA()):(this._root.updateByConstraint(),this._bone.updateByConstraint(),this._computeB())},e.prototype.invalidUpdate=function(){null===this._root||this._root.invalidUpdate(),this._bone.invalidUpdate()},e}(M.Constraint=t);M.IKConstraint=e}(dragonBones||(dragonBones={})),function(t){var e=function(){function t(t){void 0===t&&(t=-1),this.time=0,this.timeScale=1,this._animatebles=[],this._clock=null,this.time=t<0?.001*(new Date).getTime():t}return t.prototype.advanceTime=function(t){if(t!=t&&(t=0),t<0&&(t=.001*(new Date).getTime()-this.time),1!==this.timeScale&&(t*=this.timeScale),t<0?this.time-=t:this.time+=t,0!==t){for(var e=0,i=0,a=this._animatebles.length;e<a;++e){var n=this._animatebles[e];null!==n?(0<i&&(this._animatebles[e-i]=n,this._animatebles[e]=null),n.advanceTime(t)):i++}if(0<i){for(a=this._animatebles.length;e<a;++e){var r=this._animatebles[e];null!==r?this._animatebles[e-i]=r:i++}this._animatebles.length-=i}}},t.prototype.contains=function(t){if(t===this)return!1;for(var e=t;e!==this&&null!==e;)e=e.clock;return e===this},t.prototype.add=function(t){this._animatebles.indexOf(t)<0&&(this._animatebles.push(t),t.clock=this)},t.prototype.remove=function(t){var e=this._animatebles.indexOf(t);0<=e&&(this._animatebles[e]=null,t.clock=null)},t.prototype.clear=function(){for(var t=0,e=this._animatebles;t<e.length;t++){var i=e[t];null!==i&&(i.clock=null)}},Object.defineProperty(t.prototype,"clock",{get:function(){return this._clock},set:function(t){this._clock!==t&&(null!==this._clock&&this._clock.remove(this),this._clock=t,null!==this._clock&&this._clock.add(this))},enumerable:!0,configurable:!0}),t.clock=new t,t}();t.WorldClock=e}(dragonBones||(dragonBones={})),function(m){var t=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._animationNames=[],t._animationStates=[],t._animations={},t._animationConfig=null,t}return __extends(t,e),t.toString=function(){return"[class dragonBones.Animation]"},t.prototype._onClear=function(){for(var t=0,e=this._animationStates;t<e.length;t++){e[t].returnToPool()}for(var i in this._animations)delete this._animations[i];null!==this._animationConfig&&this._animationConfig.returnToPool(),this.timeScale=1,this._animationDirty=!1,this._inheritTimeScale=1,this._animationNames.length=0,this._animationStates.length=0,this._armature=null,this._animationConfig=null,this._lastAnimationState=null},t.prototype._fadeOut=function(t){switch(t.fadeOutMode){case 1:for(var e=0,i=this._animationStates;e<i.length;e++){(h=i[e]).layer===t.layer&&h.fadeOut(t.fadeOutTime,t.pauseFadeOut)}break;case 2:for(var a=0,n=this._animationStates;a<n.length;a++){(h=n[a]).group===t.group&&h.fadeOut(t.fadeOutTime,t.pauseFadeOut)}break;case 3:for(var r=0,s=this._animationStates;r<s.length;r++){(h=s[r]).layer===t.layer&&h.group===t.group&&h.fadeOut(t.fadeOutTime,t.pauseFadeOut)}break;case 4:for(var o=0,l=this._animationStates;o<l.length;o++){var h;(h=l[o]).fadeOut(t.fadeOutTime,t.pauseFadeOut)}}},t.prototype.init=function(t){null===this._armature&&(this._armature=t,this._animationConfig=m.BaseObject.borrowObject(m.AnimationConfig))},t.prototype.advanceTime=function(t){t<0&&(t=-t),this._armature.inheritAnimation&&null!==this._armature._parent?this._inheritTimeScale=this._armature._parent._armature.animation._inheritTimeScale*this.timeScale:this._inheritTimeScale=this.timeScale,1!==this._inheritTimeScale&&(t*=this._inheritTimeScale);var e=this._animationStates.length;if(1===e)if(0<(f=this._animationStates[0])._fadeState&&0<f._subFadeState)this._armature._dragonBones.bufferObject(f),this._animationStates.length=0,this._lastAnimationState=null;else{var i=f._animationData,a=i.cacheFrameRate;if(this._animationDirty&&0<a){this._animationDirty=!1;for(var n=0,r=this._armature.getBones();n<r.length;n++){var s=r[n];s._cachedFrameIndices=i.getBoneCachedFrameIndices(s.name)}for(var o=0,l=this._armature.getSlots();o<l.length;o++){var h=l[o];h._cachedFrameIndices=i.getSlotCachedFrameIndices(h.name)}}f.advanceTime(t,a)}else if(1<e){for(var u=0,_=0;u<e;++u){var f;0<(f=this._animationStates[u])._fadeState&&0<f._subFadeState?(_++,this._armature._dragonBones.bufferObject(f),this._animationDirty=!0,this._lastAnimationState===f&&(this._lastAnimationState=null)):(0<_&&(this._animationStates[u-_]=f),f.advanceTime(t,0)),u===e-1&&0<_&&(this._animationStates.length-=_,null===this._lastAnimationState&&0<this._animationStates.length&&(this._lastAnimationState=this._animationStates[this._animationStates.length-1]))}this._armature._cacheFrameIndex=-1}else this._armature._cacheFrameIndex=-1},t.prototype.reset=function(){for(var t=0,e=this._animationStates;t<e.length;t++){e[t].returnToPool()}this._animationDirty=!1,this._animationConfig.clear(),this._animationStates.length=0,this._lastAnimationState=null},t.prototype.stop=function(t){if(void 0===t&&(t=null),null!==t)null!==(a=this.getState(t))&&a.stop();else for(var e=0,i=this._animationStates;e<i.length;e++){var a;(a=i[e]).stop()}},t.prototype.playConfig=function(t){var e=t.animation;if(!(e in this._animations))return console.warn("Non-existent animation.\n","DragonBones name: "+this._armature.armatureData.parent.name,"Armature name: "+this._armature.name,"Animation name: "+e),null;var i=this._animations[e];if(5===t.fadeOutMode)for(var a=0,n=this._animationStates;a<n.length;a++){var r=n[a];if(r._animationData===i)return r}0===this._animationStates.length?t.fadeInTime=0:t.fadeInTime<0&&(t.fadeInTime=i.fadeInTime),t.fadeOutTime<0&&(t.fadeOutTime=t.fadeInTime),t.timeScale<=-100&&(t.timeScale=1/i.scale),1<i.frameCount?(t.position<0?(t.position%=i.duration,t.position=i.duration-t.position):t.position===i.duration?t.position-=1e-6:t.position>i.duration&&(t.position%=i.duration),0<t.duration&&t.position+t.duration>i.duration&&(t.duration=i.duration-t.position),t.playTimes<0&&(t.playTimes=i.playTimes)):(t.playTimes=1,(t.position=0)<t.duration&&(t.duration=0)),0===t.duration&&(t.duration=-1),this._fadeOut(t);var s=m.BaseObject.borrowObject(m.AnimationState);if(s.init(this._armature,i,t),this._animationDirty=!0,this._armature._cacheFrameIndex=-1,0<this._animationStates.length){for(var o=!1,l=0,h=this._animationStates.length;l<h;++l)if(!(s.layer>=this._animationStates[l].layer)){o=!0,this._animationStates.splice(l+1,0,s);break}o||this._animationStates.push(s)}else this._animationStates.push(s);for(var u=0,_=this._armature.getSlots();u<_.length;u++){var f=_[u].childArmature;null!==f&&f.inheritAnimation&&f.animation.hasAnimation(e)&&null===f.animation.getState(e)&&f.animation.fadeIn(e)}return t.fadeInTime<=0&&this._armature.advanceTime(0),this._lastAnimationState=s},t.prototype.play=function(t,e){if(void 0===t&&(t=null),void 0===e&&(e=-1),this._animationConfig.clear(),this._animationConfig.resetToPose=!0,this._animationConfig.playTimes=e,this._animationConfig.fadeInTime=0,this._animationConfig.animation=null!==t?t:"",null!==t&&0<t.length)this.playConfig(this._animationConfig);else if(null===this._lastAnimationState){var i=this._armature.armatureData.defaultAnimation;null!==i&&(this._animationConfig.animation=i.name,this.playConfig(this._animationConfig))}else this._lastAnimationState.isPlaying||this._lastAnimationState.isCompleted?(this._animationConfig.animation=this._lastAnimationState.name,this.playConfig(this._animationConfig)):this._lastAnimationState.play();return this._lastAnimationState},t.prototype.fadeIn=function(t,e,i,a,n,r){return void 0===e&&(e=-1),void 0===i&&(i=-1),void 0===a&&(a=0),void 0===n&&(n=null),void 0===r&&(r=3),this._animationConfig.clear(),this._animationConfig.fadeOutMode=r,this._animationConfig.playTimes=i,this._animationConfig.layer=a,this._animationConfig.fadeInTime=e,this._animationConfig.animation=t,this._animationConfig.group=null!==n?n:"",this.playConfig(this._animationConfig)},t.prototype.gotoAndPlayByTime=function(t,e,i){return void 0===e&&(e=0),void 0===i&&(i=-1),this._animationConfig.clear(),this._animationConfig.resetToPose=!0,this._animationConfig.playTimes=i,this._animationConfig.position=e,this._animationConfig.fadeInTime=0,this._animationConfig.animation=t,this.playConfig(this._animationConfig)},t.prototype.gotoAndPlayByFrame=function(t,e,i){void 0===e&&(e=0),void 0===i&&(i=-1),this._animationConfig.clear(),this._animationConfig.resetToPose=!0,this._animationConfig.playTimes=i,this._animationConfig.fadeInTime=0;var a=(this._animationConfig.animation=t)in this._animations?this._animations[t]:null;return null!==a&&(this._animationConfig.position=a.duration*e/a.frameCount),this.playConfig(this._animationConfig)},t.prototype.gotoAndPlayByProgress=function(t,e,i){void 0===e&&(e=0),void 0===i&&(i=-1),this._animationConfig.clear(),this._animationConfig.resetToPose=!0,this._animationConfig.playTimes=i,this._animationConfig.fadeInTime=0;var a=(this._animationConfig.animation=t)in this._animations?this._animations[t]:null;return null!==a&&(this._animationConfig.position=a.duration*(0<e?e:0)),this.playConfig(this._animationConfig)},t.prototype.gotoAndStopByTime=function(t,e){void 0===e&&(e=0);var i=this.gotoAndPlayByTime(t,e,1);return null!==i&&i.stop(),i},t.prototype.gotoAndStopByFrame=function(t,e){void 0===e&&(e=0);var i=this.gotoAndPlayByFrame(t,e,1);return null!==i&&i.stop(),i},t.prototype.gotoAndStopByProgress=function(t,e){void 0===e&&(e=0);var i=this.gotoAndPlayByProgress(t,e,1);return null!==i&&i.stop(),i},t.prototype.getState=function(t){for(var e=this._animationStates.length;e--;){var i=this._animationStates[e];if(i.name===t)return i}return null},t.prototype.hasAnimation=function(t){return t in this._animations},t.prototype.getStates=function(){return this._animationStates},Object.defineProperty(t.prototype,"isPlaying",{get:function(){for(var t=0,e=this._animationStates;t<e.length;t++){if(e[t].isPlaying)return!0}return!1},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isCompleted",{get:function(){for(var t=0,e=this._animationStates;t<e.length;t++){if(!e[t].isCompleted)return!1}return 0<this._animationStates.length},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"lastAnimationName",{get:function(){return null!==this._lastAnimationState?this._lastAnimationState.name:""},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"animationNames",{get:function(){return this._animationNames},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"animations",{get:function(){return this._animations},set:function(t){if(this._animations!==t){for(var e in this._animationNames.length=0,this._animations)delete this._animations[e];for(var e in t)this._animationNames.push(e),this._animations[e]=t[e]}},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"animationConfig",{get:function(){return this._animationConfig.clear(),this._animationConfig},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"lastAnimationState",{get:function(){return this._lastAnimationState},enumerable:!0,configurable:!0}),t.prototype.gotoAndPlay=function(t,e,i,a,n,r,s,o,l){void 0===e&&(e=-1),void 0===i&&(i=-1),void 0===a&&(a=-1),void 0===n&&(n=0),void 0===r&&(r=null),void 0===s&&(s=3),void 0===o&&(o=!0),void 0===l&&(l=!0),this._animationConfig.clear(),this._animationConfig.resetToPose=!0,this._animationConfig.fadeOutMode=s,this._animationConfig.playTimes=a,this._animationConfig.layer=n,this._animationConfig.fadeInTime=e,this._animationConfig.animation=t,this._animationConfig.group=null!==r?r:"";var h=this._animations[t];return h&&0<i&&(this._animationConfig.timeScale=h.duration/i),this.playConfig(this._animationConfig)},t.prototype.gotoAndStop=function(t,e){return void 0===e&&(e=0),this.gotoAndStopByTime(t,e)},Object.defineProperty(t.prototype,"animationList",{get:function(){return this._animationNames},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"animationDataList",{get:function(){for(var t=[],e=0,i=this._animationNames.length;e<i;++e)t.push(this._animations[this._animationNames[e]]);return t},enumerable:!0,configurable:!0}),t}(m.BaseObject);m.Animation=t}(dragonBones||(dragonBones={})),function(H){var t=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._boneMask=[],t._boneTimelines=[],t._slotTimelines=[],t._constraintTimelines=[],t._poseTimelines=[],t._bonePoses={},t._actionTimeline=null,t._zOrderTimeline=null,t}return __extends(t,e),t.toString=function(){return"[class dragonBones.AnimationState]"},t.prototype._onClear=function(){for(var t=0,e=this._boneTimelines;t<e.length;t++){e[t].returnToPool()}for(var i=0,a=this._slotTimelines;i<a.length;i++){a[i].returnToPool()}for(var n=0,r=this._constraintTimelines;n<r.length;n++){r[n].returnToPool()}for(var s in this._bonePoses)this._bonePoses[s].returnToPool(),delete this._bonePoses[s];null!==this._actionTimeline&&this._actionTimeline.returnToPool(),null!==this._zOrderTimeline&&this._zOrderTimeline.returnToPool(),this.actionEnabled=!1,this.additiveBlending=!1,this.displayControl=!1,this.resetToPose=!1,this.playTimes=1,this.layer=0,this.timeScale=1,this.weight=1,this.autoFadeOutTime=0,this.fadeTotalTime=0,this.name="",this.group="",this._timelineDirty=!0,this._playheadState=0,this._fadeState=-1,this._subFadeState=-1,this._position=0,this._duration=0,this._fadeTime=0,this._time=0,this._fadeProgress=0,this._weightResult=0,this._boneMask.length=0,this._boneTimelines.length=0,this._slotTimelines.length=0,this._constraintTimelines.length=0,this._poseTimelines.length=0,this._animationData=null,this._armature=null,this._actionTimeline=null,this._zOrderTimeline=null},t.prototype._updateTimelines=function(){for(var t={},e=0,i=this._boneTimelines;e<i.length;e++){(s=(p=i[e]).bone.name)in t||(t[s]=[]),t[s].push(p)}for(var a=0,n=this._armature.getBones();a<n.length;a++){var r=n[a],s=r.name;if(this.containsBoneMask(s)){var o=this._animationData.getBoneTimelines(s);if(s in t)delete t[s];else{var l=s in this._bonePoses?this._bonePoses[s]:this._bonePoses[s]=H.BaseObject.borrowObject(G);if(null!==o)for(var h=0,u=o;h<u.length;h++){switch((U=u[h]).type){case 10:(p=H.BaseObject.borrowObject(H.BoneAllTimelineState)).bone=r,p.bonePose=l,p.init(this._armature,this,U),this._boneTimelines.push(p);break;case 11:(p=H.BaseObject.borrowObject(H.BoneTranslateTimelineState)).bone=r,p.bonePose=l,p.init(this._armature,this,U),this._boneTimelines.push(p);break;case 12:(p=H.BaseObject.borrowObject(H.BoneRotateTimelineState)).bone=r,p.bonePose=l,p.init(this._armature,this,U),this._boneTimelines.push(p);break;case 13:(p=H.BaseObject.borrowObject(H.BoneScaleTimelineState)).bone=r,p.bonePose=l,p.init(this._armature,this,U),this._boneTimelines.push(p)}}else if(this.resetToPose){(p=H.BaseObject.borrowObject(H.BoneAllTimelineState)).bone=r,p.bonePose=l,p.init(this._armature,this,null),this._boneTimelines.push(p),this._poseTimelines.push(p)}}}}for(var _ in t)for(var f=0,m=t[_];f<m.length;f++){var p=m[f];this._boneTimelines.splice(this._boneTimelines.indexOf(p),1),p.returnToPool()}for(var c={},d=[],y=0,g=this._slotTimelines;y<g.length;y++){(s=(p=g[y]).slot.name)in c||(c[s]=[]),c[s].push(p)}for(var b=0,v=this._armature.getSlots();b<v.length;b++){var T=v[b],D=T.parent.name;if(this.containsBoneMask(D)){s=T.name,o=this._animationData.getSlotTimelines(s);if(s in c)delete c[s];else{var A=!1,O=!1;if(d.length=0,null!==o)for(var S=0,x=o;S<x.length;S++){switch((U=x[S]).type){case 20:(p=H.BaseObject.borrowObject(H.SlotDislayTimelineState)).slot=T,p.init(this._armature,this,U),this._slotTimelines.push(p),A=!0;break;case 21:(p=H.BaseObject.borrowObject(H.SlotColorTimelineState)).slot=T,p.init(this._armature,this,U),this._slotTimelines.push(p),O=!0;break;case 22:(p=H.BaseObject.borrowObject(H.SlotFFDTimelineState)).slot=T,p.init(this._armature,this,U),this._slotTimelines.push(p),d.push(p.meshOffset)}}if(this.resetToPose){if(!A)(p=H.BaseObject.borrowObject(H.SlotDislayTimelineState)).slot=T,p.init(this._armature,this,null),this._slotTimelines.push(p),this._poseTimelines.push(p);if(!O)(p=H.BaseObject.borrowObject(H.SlotColorTimelineState)).slot=T,p.init(this._armature,this,null),this._slotTimelines.push(p),this._poseTimelines.push(p);if(null!==T.rawDisplayDatas)for(var B=0,P=T.rawDisplayDatas;B<P.length;B++){var E=P[B];if(null!==E&&2===E.type){var I=E.offset;if(d.indexOf(I)<0)(p=H.BaseObject.borrowObject(H.SlotFFDTimelineState)).meshOffset=I,p.slot=T,p.init(this._armature,this,null),this._slotTimelines.push(p),this._poseTimelines.push(p)}}}}}}for(var _ in c)for(var M=0,w=c[_];M<w.length;M++){p=w[M];this._slotTimelines.splice(this._slotTimelines.indexOf(p),1),p.returnToPool()}for(var F={},C=0,R=this._constraintTimelines;C<R.length;C++){(s=(p=R[C]).constraint.name)in F||(F[s]=[]),F[s].push(p)}for(var N=0,k=this._armature._constraints;N<k.length;N++){var j=k[N];s=j.name,o=this._animationData.getConstraintTimelines(s);if(s in F)delete F[s];else if(null!==o)for(var L=0,Y=o;L<Y.length;L++){var U;switch((U=Y[L]).type){case 30:(p=H.BaseObject.borrowObject(H.IKConstraintTimelineState)).constraint=j,p.init(this._armature,this,U),this._constraintTimelines.push(p)}}else if(this.resetToPose){(p=H.BaseObject.borrowObject(H.IKConstraintTimelineState)).constraint=j,p.init(this._armature,this,null),this._constraintTimelines.push(p),this._poseTimelines.push(p)}}for(var _ in F)for(var X=0,V=F[_];X<V.length;X++){p=V[X];this._constraintTimelines.splice(this._constraintTimelines.indexOf(p),1),p.returnToPool()}},t.prototype._advanceFadeTime=function(t){var e=0<this._fadeState;if(this._subFadeState<0){this._subFadeState=0;var i=e?H.EventObject.FADE_OUT:H.EventObject.FADE_IN;if(this._armature.eventDispatcher.hasDBEventListener(i))(a=H.BaseObject.borrowObject(H.EventObject)).type=i,a.armature=this._armature,(a.animationState=this)._armature._dragonBones.bufferEvent(a)}if(t<0&&(t=-t),this._fadeTime+=t,this._fadeTime>=this.fadeTotalTime?(this._subFadeState=1,this._fadeProgress=e?0:1):0<this._fadeTime?this._fadeProgress=e?1-this._fadeTime/this.fadeTotalTime:this._fadeTime/this.fadeTotalTime:this._fadeProgress=e?1:0,0<this._subFadeState){e||(this._playheadState|=1,this._fadeState=0);var a;i=e?H.EventObject.FADE_OUT_COMPLETE:H.EventObject.FADE_IN_COMPLETE;if(this._armature.eventDispatcher.hasDBEventListener(i))(a=H.BaseObject.borrowObject(H.EventObject)).type=i,a.armature=this._armature,(a.animationState=this)._armature._dragonBones.bufferEvent(a)}},t.prototype._blendBoneTimline=function(t){var e=0<this._weightResult?this._weightResult:-this._weightResult,i=t.bone,a=t.bonePose.result,n=i.animationPose;i._blendDirty?(e*=i._blendLeftWeight,i._blendLayerWeight+=e,n.x+=a.x*e,n.y+=a.y*e,n.rotation+=a.rotation*e,n.skew+=a.skew*e,n.scaleX+=(a.scaleX-1)*e,n.scaleY+=(a.scaleY-1)*e):(i._blendDirty=!0,i._blendLayer=this.layer,i._blendLayerWeight=e,i._blendLeftWeight=1,n.x=a.x*e,n.y=a.y*e,n.rotation=a.rotation*e,n.skew=a.skew*e,n.scaleX=(a.scaleX-1)*e+1,n.scaleY=(a.scaleY-1)*e+1),0===this._fadeState&&0===this._subFadeState||(i._transformDirty=!0)},t.prototype.init=function(t,e,i){if(null===this._armature){if(this._armature=t,this._animationData=e,this.resetToPose=i.resetToPose,this.additiveBlending=i.additiveBlending,this.displayControl=i.displayControl,this.actionEnabled=i.actionEnabled,this.layer=i.layer,this.playTimes=i.playTimes,this.timeScale=i.timeScale,this.fadeTotalTime=i.fadeInTime,this.autoFadeOutTime=i.autoFadeOutTime,this.weight=i.weight,this.name=0<i.name.length?i.name:i.animation,this.group=i.group,i.pauseFadeIn?this._playheadState=2:this._playheadState=3,i.duration<0?(this._position=0,this._duration=this._animationData.duration,0!==i.position?0<=this.timeScale?this._time=i.position:this._time=i.position-this._duration:this._time=0):(this._position=i.position,this._duration=i.duration,this._time=0),this.timeScale<0&&0===this._time&&(this._time=-1e-6),this.fadeTotalTime<=0&&(this._fadeProgress=.999999),0<i.boneMask.length){this._boneMask.length=i.boneMask.length;for(var a=0,n=this._boneMask.length;a<n;++a)this._boneMask[a]=i.boneMask[a]}this._actionTimeline=H.BaseObject.borrowObject(H.ActionTimelineState),this._actionTimeline.init(this._armature,this,this._animationData.actionTimeline),this._actionTimeline.currentTime=this._time,this._actionTimeline.currentTime<0&&(this._actionTimeline.currentTime=this._duration-this._actionTimeline.currentTime),null!==this._animationData.zOrderTimeline&&(this._zOrderTimeline=H.BaseObject.borrowObject(H.ZOrderTimelineState),this._zOrderTimeline.init(this._armature,this,this._animationData.zOrderTimeline))}},t.prototype.advanceTime=function(t,e){if(0===this._fadeState&&0===this._subFadeState||this._advanceFadeTime(t),3===this._playheadState&&(1!==this.timeScale&&(t*=this.timeScale),this._time+=t),this._timelineDirty&&(this._timelineDirty=!1,this._updateTimelines()),0!==this.weight){var i=0===this._fadeState&&0<e,a=!0,n=!0,r=this._time;if(this._weightResult=this.weight*this._fadeProgress,this._actionTimeline.playState<=0&&this._actionTimeline.update(r),i){var s=2*e;this._actionTimeline.currentTime=Math.floor(this._actionTimeline.currentTime*s)/s}if(null!==this._zOrderTimeline&&this._zOrderTimeline.playState<=0&&this._zOrderTimeline.update(r),i){var o=Math.floor(this._actionTimeline.currentTime*e);this._armature._cacheFrameIndex===o?n=a=!1:(this._armature._cacheFrameIndex=o,this._animationData.cachedFrames[o]?n=!1:this._animationData.cachedFrames[o]=!0)}if(a){if(n)for(var l=null,h=null,u=0,_=this._boneTimelines.length;u<_;++u){l!==(c=this._boneTimelines[u]).bone&&(null!==l&&(this._blendBoneTimline(h),l._blendDirty&&(0<l._blendLeftWeight?l._blendLayer!==this.layer&&(l._blendLayerWeight>=l._blendLeftWeight?(l._blendLeftWeight=0,l=null):(l._blendLayer=this.layer,l._blendLeftWeight-=l._blendLayerWeight,l._blendLayerWeight=0)):l=null)),l=c.bone),null!==l&&(c.playState<=0&&c.update(r),u===_-1?this._blendBoneTimline(c):h=c)}if(this.displayControl)for(u=0,_=this._slotTimelines.length;u<_;++u){var f=(c=this._slotTimelines[u]).slot.displayController;null!==f&&f!==this.name&&f!==this.group||c.playState<=0&&c.update(r)}for(u=0,_=this._constraintTimelines.length;u<_;++u){(c=this._constraintTimelines[u]).playState<=0&&c.update(r)}}if(0===this._fadeState){if(0<this._subFadeState&&(this._subFadeState=0)<this._poseTimelines.length){for(var m=0,p=this._poseTimelines;m<p.length;m++){var c;if((c=p[m])instanceof H.BoneTimelineState){var d=this._boneTimelines.indexOf(c);this._boneTimelines.splice(d,1)}else if(c instanceof H.SlotTimelineState){d=this._slotTimelines.indexOf(c);this._slotTimelines.splice(d,1)}else if(c instanceof H.ConstraintTimelineState){d=this._constraintTimelines.indexOf(c);this._constraintTimelines.splice(d,1)}c.returnToPool()}this._poseTimelines.length=0}0<this._actionTimeline.playState&&0<=this.autoFadeOutTime&&this.fadeOut(this.autoFadeOutTime)}}},t.prototype.play=function(){this._playheadState=3},t.prototype.stop=function(){this._playheadState&=1},t.prototype.fadeOut=function(t,e){if(void 0===e&&(e=!0),t<0&&(t=0),e&&(this._playheadState&=2),0<this._fadeState){if(t>this.fadeTotalTime-this._fadeTime)return}else{this._fadeState=1,this._subFadeState=-1,(t<=0||this._fadeProgress<=0)&&(this._fadeProgress=1e-6);for(var i=0,a=this._boneTimelines;i<a.length;i++){a[i].fadeOut()}for(var n=0,r=this._slotTimelines;n<r.length;n++){r[n].fadeOut()}}this.displayControl=!1,this.fadeTotalTime=1e-6<this._fadeProgress?t/this._fadeProgress:0,this._fadeTime=this.fadeTotalTime*(1-this._fadeProgress)},t.prototype.containsBoneMask=function(t){return 0===this._boneMask.length||0<=this._boneMask.indexOf(t)},t.prototype.addBoneMask=function(t,e){void 0===e&&(e=!0);var i=this._armature.getBone(t);if(null!==i){if(this._boneMask.indexOf(t)<0&&this._boneMask.push(t),e)for(var a=0,n=this._armature.getBones();a<n.length;a++){var r=n[a];this._boneMask.indexOf(r.name)<0&&i.contains(r)&&this._boneMask.push(r.name)}this._timelineDirty=!0}},t.prototype.removeBoneMask=function(t,e){void 0===e&&(e=!0);var i=this._boneMask.indexOf(t);if(0<=i&&this._boneMask.splice(i,1),e){var a=this._armature.getBone(t);if(null!==a){var n=this._armature.getBones();if(0<this._boneMask.length)for(var r=0,s=n;r<s.length;r++){var o=s[r],l=this._boneMask.indexOf(o.name);0<=l&&a.contains(o)&&this._boneMask.splice(l,1)}else for(var h=0,u=n;h<u.length;h++){(o=u[h])!==a&&(a.contains(o)||this._boneMask.push(o.name))}}}this._timelineDirty=!0},t.prototype.removeAllBoneMask=function(){this._boneMask.length=0,this._timelineDirty=!0},Object.defineProperty(t.prototype,"isFadeIn",{get:function(){return this._fadeState<0},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isFadeOut",{get:function(){return 0<this._fadeState},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isFadeComplete",{get:function(){return 0===this._fadeState},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isPlaying",{get:function(){return 0!=(2&this._playheadState)&&this._actionTimeline.playState<=0},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isCompleted",{get:function(){return 0<this._actionTimeline.playState},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"currentPlayTimes",{get:function(){return this._actionTimeline.currentPlayTimes},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"totalTime",{get:function(){return this._duration},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"currentTime",{get:function(){return this._actionTimeline.currentTime},set:function(t){var e=this._actionTimeline.currentPlayTimes-(0<this._actionTimeline.playState?1:0);if((t<0||this._duration<t)&&(t=t%this._duration+e*this._duration)<0&&(t+=this._duration),0<this.playTimes&&e===this.playTimes-1&&t===this._duration&&(t=this._duration-1e-6),this._time!==t){this._time=t,this._actionTimeline.setCurrentTime(this._time),null!==this._zOrderTimeline&&(this._zOrderTimeline.playState=-1);for(var i=0,a=this._boneTimelines;i<a.length;i++){a[i].playState=-1}for(var n=0,r=this._slotTimelines;n<r.length;n++){r[n].playState=-1}}},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"animationData",{get:function(){return this._animationData},enumerable:!0,configurable:!0}),t}(H.BaseObject);H.AnimationState=t;var G=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.current=new H.Transform,t.delta=new H.Transform,t.result=new H.Transform,t}return __extends(t,e),t.toString=function(){return"[class dragonBones.BonePose]"},t.prototype._onClear=function(){this.current.identity(),this.delta.identity(),this.result.identity()},t}(H.BaseObject);H.BonePose=G}(dragonBones||(dragonBones={})),function(t){var e=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype._onClear=function(){this.playState=-1,this.currentPlayTimes=-1,this.currentTime=-1,this._tweenState=0,this._frameRate=0,this._frameValueOffset=0,this._frameCount=0,this._frameOffset=0,this._frameIndex=-1,this._frameRateR=0,this._position=0,this._duration=0,this._timeScale=1,this._timeOffset=0,this._dragonBonesData=null,this._animationData=null,this._timelineData=null,this._armature=null,this._animationState=null,this._actionTimeline=null,this._frameArray=null,this._frameIntArray=null,this._frameFloatArray=null,this._timelineArray=null,this._frameIndices=null},e.prototype._setCurrentTime=function(t){var e=this.playState,i=this.currentPlayTimes,a=this.currentTime;if(null!==this._actionTimeline&&this._frameCount<=1)this.playState=0<=this._actionTimeline.playState?1:-1,this.currentPlayTimes=1,this.currentTime=this._actionTimeline.currentTime;else if(null===this._actionTimeline||1!==this._timeScale||0!==this._timeOffset){var n=this._animationState.playTimes,r=n*this._duration;t*=this._timeScale,0!==this._timeOffset&&(t+=this._timeOffset*this._animationData.duration),0<n&&(r<=t||t<=-r)?(this.playState<=0&&3===this._animationState._playheadState&&(this.playState=1),this.currentPlayTimes=n,this.currentTime=t<0?0:this._duration):(0!==this.playState&&3===this._animationState._playheadState&&(this.playState=0),t<0?(t=-t,this.currentPlayTimes=Math.floor(t/this._duration),this.currentTime=this._duration-t%this._duration):(this.currentPlayTimes=Math.floor(t/this._duration),this.currentTime=t%this._duration)),this.currentTime+=this._position}else this.playState=this._actionTimeline.playState,this.currentPlayTimes=this._actionTimeline.currentPlayTimes,this.currentTime=this._actionTimeline.currentTime;return(this.currentPlayTimes!==i||this.currentTime!==a)&&((e<0&&this.playState!==e||this.playState<=0&&this.currentPlayTimes!==i)&&(this._frameIndex=-1),!0)},e.prototype.init=function(t,e,i){this._armature=t,this._animationState=e,this._timelineData=i,this._actionTimeline=this._animationState._actionTimeline,this===this._actionTimeline&&(this._actionTimeline=null),this._animationData=this._animationState._animationData,this._frameRate=this._animationData.parent.frameRate,this._frameRateR=1/this._frameRate,this._position=this._animationState._position,this._duration=this._animationState._duration,this._dragonBonesData=this._animationData.parent.parent,null!==this._timelineData&&(this._frameIntArray=this._dragonBonesData.frameIntArray,this._frameFloatArray=this._dragonBonesData.frameFloatArray,this._frameArray=this._dragonBonesData.frameArray,this._timelineArray=this._dragonBonesData.timelineArray,this._frameIndices=this._dragonBonesData.frameIndices,this._frameCount=this._timelineArray[this._timelineData.offset+2],this._frameValueOffset=this._timelineArray[this._timelineData.offset+4],this._timeScale=100/this._timelineArray[this._timelineData.offset+0],this._timeOffset=.01*this._timelineArray[this._timelineData.offset+1])},e.prototype.fadeOut=function(){},e.prototype.update=function(t){if(this._setCurrentTime(t)){if(1<this._frameCount){var e=Math.floor(this.currentTime*this._frameRate),i=this._frameIndices[this._timelineData.frameIndicesOffset+e];this._frameIndex!==i&&(this._frameIndex=i,this._frameOffset=this._animationData.frameOffset+this._timelineArray[this._timelineData.offset+5+this._frameIndex],this._onArriveAtFrame())}else this._frameIndex<0&&(this._frameIndex=0,null!==this._timelineData&&(this._frameOffset=this._animationData.frameOffset+this._timelineArray[this._timelineData.offset+5]),this._onArriveAtFrame());0!==this._tweenState&&this._onUpdateFrame()}},e}(t.BaseObject),i=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e._getEasingValue=function(t,e,i){var a=e;switch(t){case 3:a=Math.pow(e,2);break;case 4:a=1-Math.pow(1-e,2);break;case 5:a=.5*(1-Math.cos(e*Math.PI))}return(a-e)*i+e},e._getEasingCurveValue=function(t,e,i,a){if(t<=0)return 0;if(1<=t)return 1;var n=i+1,r=Math.floor(t*n),s=0===r?0:e[a+r-1];return 1e-4*(s+((r===n-1?1e4:e[a+r])-s)*(t*n-r))},e.prototype._onClear=function(){t.prototype._onClear.call(this),this._tweenType=0,this._curveCount=0,this._framePosition=0,this._frameDurationR=0,this._tweenProgress=0,this._tweenEasing=0},e.prototype._onArriveAtFrame=function(){if(1<this._frameCount&&(this._frameIndex!==this._frameCount-1||0===this._animationState.playTimes||this._animationState.currentPlayTimes<this._animationState.playTimes-1))if(this._tweenType=this._frameArray[this._frameOffset+1],this._tweenState=0===this._tweenType?1:2,2===this._tweenType?this._curveCount=this._frameArray[this._frameOffset+2]:0!==this._tweenType&&1!==this._tweenType&&(this._tweenEasing=.01*this._frameArray[this._frameOffset+2]),this._framePosition=this._frameArray[this._frameOffset]*this._frameRateR,this._frameIndex===this._frameCount-1)this._frameDurationR=1/(this._animationData.duration-this._framePosition);else{var t=this._animationData.frameOffset+this._timelineArray[this._timelineData.offset+5+this._frameIndex+1],e=this._frameArray[t]*this._frameRateR-this._framePosition;this._frameDurationR=0<e?1/e:0}else this._tweenState=1},e.prototype._onUpdateFrame=function(){2===this._tweenState?(this._tweenProgress=(this.currentTime-this._framePosition)*this._frameDurationR,2===this._tweenType?this._tweenProgress=e._getEasingCurveValue(this._tweenProgress,this._frameArray,this._curveCount,this._frameOffset+3):1!==this._tweenType&&(this._tweenProgress=e._getEasingValue(this._tweenType,this._tweenProgress,this._tweenEasing))):this._tweenProgress=0},e}(t.TimelineState=e),a=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype._onClear=function(){t.prototype._onClear.call(this),this.bone=null,this.bonePose=null},e}(t.TweenTimelineState=i);t.BoneTimelineState=a;var n=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype._onClear=function(){t.prototype._onClear.call(this),this.slot=null},e}(i);t.SlotTimelineState=n;var r=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype._onClear=function(){t.prototype._onClear.call(this),this.constraint=null},e}(i);t.ConstraintTimelineState=r}(dragonBones||(dragonBones={})),function(d){var t=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.toString=function(){return"[class dragonBones.ActionTimelineState]"},e.prototype._onCrossFrame=function(t){var e=this._armature.eventDispatcher;if(this._animationState.actionEnabled)for(var i=this._animationData.frameOffset+this._timelineArray[this._timelineData.offset+5+t],a=this._frameArray[i+1],n=this._animationData.parent.actions,r=0;r<a;++r){var s=n[this._frameArray[i+2+r]];if(0===s.type){if(null!==s.slot){if(null!==(h=this._armature.getSlot(s.slot.name)))null!==(u=h.childArmature)&&u._bufferAction(s,!0)}else if(null!==s.bone)for(var o=0,l=this._armature.getSlots();o<l.length;o++){var h,u;null!==(u=(h=l[o]).childArmature)&&h.parent._boneData===s.bone&&u._bufferAction(s,!0)}else this._armature._bufferAction(s,!0)}else{var _=10===s.type?d.EventObject.FRAME_EVENT:d.EventObject.SOUND_EVENT;if(11===s.type||e.hasDBEventListener(_)){var f=d.BaseObject.borrowObject(d.EventObject);f.time=this._frameArray[i]/this._frameRate,f.type=_,f.name=s.name,f.data=s.data,f.armature=this._armature,f.animationState=this._animationState,null!==s.bone&&(f.bone=this._armature.getBone(s.bone.name)),null!==s.slot&&(f.slot=this._armature.getSlot(s.slot.name)),this._armature._dragonBones.bufferEvent(f)}}}},e.prototype._onArriveAtFrame=function(){},e.prototype._onUpdateFrame=function(){},e.prototype.update=function(t){var e=this.playState,i=this.currentPlayTimes,a=this.currentTime;if(this._setCurrentTime(t)){var n=this._armature.eventDispatcher;if(e<0){if(this.playState===e)return;if(this._animationState.displayControl&&this._animationState.resetToPose&&this._armature._sortZOrder(null,0),i=this.currentPlayTimes,n.hasDBEventListener(d.EventObject.START)){var r=d.BaseObject.borrowObject(d.EventObject);r.type=d.EventObject.START,r.armature=this._armature,r.animationState=this._animationState,this._armature._dragonBones.bufferEvent(r)}}var s=this._animationState.timeScale<0,o=null,l=null;if(this.currentPlayTimes!==i&&(n.hasDBEventListener(d.EventObject.LOOP_COMPLETE)&&((o=d.BaseObject.borrowObject(d.EventObject)).type=d.EventObject.LOOP_COMPLETE,o.armature=this._armature,o.animationState=this._animationState),0<this.playState&&n.hasDBEventListener(d.EventObject.COMPLETE)&&((l=d.BaseObject.borrowObject(d.EventObject)).type=d.EventObject.COMPLETE,l.armature=this._armature,l.animationState=this._animationState)),1<this._frameCount){var h=this._timelineData,u=Math.floor(this.currentTime*this._frameRate),_=this._frameIndices[h.frameIndicesOffset+u];if(this._frameIndex!==_){var f=this._frameIndex;if(this._frameIndex=_,null!==this._timelineArray)if(this._frameOffset=this._animationData.frameOffset+this._timelineArray[h.offset+5+this._frameIndex],s){if(f<0){var m=Math.floor(a*this._frameRate);f=this._frameIndices[h.frameIndicesOffset+m],this.currentPlayTimes===i&&f===_&&(f=-1)}for(;0<=f;){var p=this._animationData.frameOffset+this._timelineArray[h.offset+5+f],c=this._frameArray[p]/this._frameRate;if(this._position<=c&&c<=this._position+this._duration&&this._onCrossFrame(f),null!==o&&0===f&&(this._armature._dragonBones.bufferEvent(o),o=null),0<f?f--:f=this._frameCount-1,f===_)break}}else{if(f<0){m=Math.floor(a*this._frameRate);f=this._frameIndices[h.frameIndicesOffset+m];p=this._animationData.frameOffset+this._timelineArray[h.offset+5+f],c=this._frameArray[p]/this._frameRate;this.currentPlayTimes===i&&(a<=c?0<f?f--:f=this._frameCount-1:f===_&&(f=-1))}for(;0<=f;){f<this._frameCount-1?f++:f=0;p=this._animationData.frameOffset+this._timelineArray[h.offset+5+f],c=this._frameArray[p]/this._frameRate;if(this._position<=c&&c<=this._position+this._duration&&this._onCrossFrame(f),null!==o&&0===f&&(this._armature._dragonBones.bufferEvent(o),o=null),f===_)break}}}}else if(this._frameIndex<0&&(this._frameIndex=0,null!==this._timelineData)){this._frameOffset=this._animationData.frameOffset+this._timelineArray[this._timelineData.offset+5];c=this._frameArray[this._frameOffset]/this._frameRate;this.currentPlayTimes===i?a<=c&&this._onCrossFrame(this._frameIndex):this._position<=c&&(s||null===o||(this._armature._dragonBones.bufferEvent(o),o=null),this._onCrossFrame(this._frameIndex))}null!==o&&this._armature._dragonBones.bufferEvent(o),null!==l&&this._armature._dragonBones.bufferEvent(l)}},e.prototype.setCurrentTime=function(t){this._setCurrentTime(t),this._frameIndex=-1},e}(d.TimelineState);d.ActionTimelineState=t;var e=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.toString=function(){return"[class dragonBones.ZOrderTimelineState]"},e.prototype._onArriveAtFrame=function(){0<=this.playState&&(0<this._frameArray[this._frameOffset+1]?this._armature._sortZOrder(this._frameArray,this._frameOffset+2):this._armature._sortZOrder(null,0))},e.prototype._onUpdateFrame=function(){},e}(d.TimelineState);d.ZOrderTimelineState=e;var i=function(r){function t(){return null!==r&&r.apply(this,arguments)||this}return __extends(t,r),t.toString=function(){return"[class dragonBones.BoneAllTimelineState]"},t.prototype._onArriveAtFrame=function(){if(r.prototype._onArriveAtFrame.call(this),null!==this._timelineData){var t=this._animationData.frameFloatOffset+this._frameValueOffset+6*this._frameIndex,e=this._armature._armatureData.scale,i=this._frameFloatArray,a=this.bonePose.current,n=this.bonePose.delta;a.x=i[t++]*e,a.y=i[t++]*e,a.rotation=i[t++],a.skew=i[t++],a.scaleX=i[t++],a.scaleY=i[t++],2===this._tweenState?(this._frameIndex===this._frameCount-1&&(t=this._animationData.frameFloatOffset+this._frameValueOffset),n.x=i[t++]*e-a.x,n.y=i[t++]*e-a.y,n.rotation=i[t++]-a.rotation,n.skew=i[t++]-a.skew,n.scaleX=i[t++]-a.scaleX,n.scaleY=i[t++]-a.scaleY):(n.x=0,n.y=0,n.rotation=0,n.skew=0,n.scaleX=0,n.scaleY=0)}else{a=this.bonePose.current,n=this.bonePose.delta;a.x=0,a.y=0,a.rotation=0,a.skew=0,a.scaleX=1,a.scaleY=1,n.x=0,n.y=0,n.rotation=0,n.skew=0,n.scaleX=0,n.scaleY=0}},t.prototype._onUpdateFrame=function(){r.prototype._onUpdateFrame.call(this);var t=this.bonePose.current,e=this.bonePose.delta,i=this.bonePose.result;this.bone._transformDirty=!0,2!==this._tweenState&&(this._tweenState=0),i.x=t.x+e.x*this._tweenProgress,i.y=t.y+e.y*this._tweenProgress,i.rotation=t.rotation+e.rotation*this._tweenProgress,i.skew=t.skew+e.skew*this._tweenProgress,i.scaleX=t.scaleX+e.scaleX*this._tweenProgress,i.scaleY=t.scaleY+e.scaleY*this._tweenProgress},t.prototype.fadeOut=function(){var t=this.bonePose.result;t.rotation=d.Transform.normalizeRadian(t.rotation),t.skew=d.Transform.normalizeRadian(t.skew)},t}(d.BoneTimelineState);d.BoneAllTimelineState=i;var a=function(r){function t(){return null!==r&&r.apply(this,arguments)||this}return __extends(t,r),t.toString=function(){return"[class dragonBones.BoneTranslateTimelineState]"},t.prototype._onArriveAtFrame=function(){if(r.prototype._onArriveAtFrame.call(this),null!==this._timelineData){var t=this._animationData.frameFloatOffset+this._frameValueOffset+2*this._frameIndex,e=this._armature._armatureData.scale,i=this._frameFloatArray,a=this.bonePose.current,n=this.bonePose.delta;a.x=i[t++]*e,a.y=i[t++]*e,2===this._tweenState?(this._frameIndex===this._frameCount-1&&(t=this._animationData.frameFloatOffset+this._frameValueOffset),n.x=i[t++]*e-a.x,n.y=i[t++]*e-a.y):(n.x=0,n.y=0)}else{a=this.bonePose.current,n=this.bonePose.delta;a.x=0,a.y=0,n.x=0,n.y=0}},t.prototype._onUpdateFrame=function(){r.prototype._onUpdateFrame.call(this);var t=this.bonePose.current,e=this.bonePose.delta,i=this.bonePose.result;this.bone._transformDirty=!0,2!==this._tweenState&&(this._tweenState=0),i.x=t.x+e.x*this._tweenProgress,i.y=t.y+e.y*this._tweenProgress},t}(d.BoneTimelineState);d.BoneTranslateTimelineState=a;var n=function(n){function t(){return null!==n&&n.apply(this,arguments)||this}return __extends(t,n),t.toString=function(){return"[class dragonBones.BoneRotateTimelineState]"},t.prototype._onArriveAtFrame=function(){if(n.prototype._onArriveAtFrame.call(this),null!==this._timelineData){var t=this._animationData.frameFloatOffset+this._frameValueOffset+2*this._frameIndex,e=this._frameFloatArray,i=this.bonePose.current,a=this.bonePose.delta;i.rotation=e[t++],i.skew=e[t++],2===this._tweenState?(this._frameIndex===this._frameCount-1&&(t=this._animationData.frameFloatOffset+this._frameValueOffset),a.rotation=e[t++]-i.rotation,a.skew=e[t++]-i.skew):(a.rotation=0,a.skew=0)}else{i=this.bonePose.current,a=this.bonePose.delta;i.rotation=0,i.skew=0,a.rotation=0,a.skew=0}},t.prototype._onUpdateFrame=function(){n.prototype._onUpdateFrame.call(this);var t=this.bonePose.current,e=this.bonePose.delta,i=this.bonePose.result;this.bone._transformDirty=!0,2!==this._tweenState&&(this._tweenState=0),i.rotation=t.rotation+e.rotation*this._tweenProgress,i.skew=t.skew+e.skew*this._tweenProgress},t.prototype.fadeOut=function(){var t=this.bonePose.result;t.rotation=d.Transform.normalizeRadian(t.rotation),t.skew=d.Transform.normalizeRadian(t.skew)},t}(d.BoneTimelineState);d.BoneRotateTimelineState=n;var r=function(n){function t(){return null!==n&&n.apply(this,arguments)||this}return __extends(t,n),t.toString=function(){return"[class dragonBones.BoneScaleTimelineState]"},t.prototype._onArriveAtFrame=function(){if(n.prototype._onArriveAtFrame.call(this),null!==this._timelineData){var t=this._animationData.frameFloatOffset+this._frameValueOffset+2*this._frameIndex,e=this._frameFloatArray,i=this.bonePose.current,a=this.bonePose.delta;i.scaleX=e[t++],i.scaleY=e[t++],2===this._tweenState?(this._frameIndex===this._frameCount-1&&(t=this._animationData.frameFloatOffset+this._frameValueOffset),a.scaleX=e[t++]-i.scaleX,a.scaleY=e[t++]-i.scaleY):(a.scaleX=0,a.scaleY=0)}else{i=this.bonePose.current,a=this.bonePose.delta;i.scaleX=1,i.scaleY=1,a.scaleX=0,a.scaleY=0}},t.prototype._onUpdateFrame=function(){n.prototype._onUpdateFrame.call(this);var t=this.bonePose.current,e=this.bonePose.delta,i=this.bonePose.result;this.bone._transformDirty=!0,2!==this._tweenState&&(this._tweenState=0),i.scaleX=t.scaleX+e.scaleX*this._tweenProgress,i.scaleY=t.scaleY+e.scaleY*this._tweenProgress},t}(d.BoneTimelineState);d.BoneScaleTimelineState=r;var s=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.toString=function(){return"[class dragonBones.SlotDislayTimelineState]"},e.prototype._onArriveAtFrame=function(){if(0<=this.playState){var t=null!==this._timelineData?this._frameArray[this._frameOffset+1]:this.slot._slotData.displayIndex;this.slot.displayIndex!==t&&this.slot._setDisplayIndex(t,!0)}},e}(d.SlotTimelineState);d.SlotDislayTimelineState=s;var o=function(r){function t(){var t=null!==r&&r.apply(this,arguments)||this;return t._current=[0,0,0,0,0,0,0,0],t._delta=[0,0,0,0,0,0,0,0],t._result=[0,0,0,0,0,0,0,0],t}return __extends(t,r),t.toString=function(){return"[class dragonBones.SlotColorTimelineState]"},t.prototype._onClear=function(){r.prototype._onClear.call(this),this._dirty=!1},t.prototype._onArriveAtFrame=function(){if(r.prototype._onArriveAtFrame.call(this),null!==this._timelineData){var t=this._dragonBonesData.intArray,e=this._frameIntArray,i=this._animationData.frameIntOffset+this._frameValueOffset+1*this._frameIndex,a=e[i];a<0&&(a+=32767),this._current[0]=t[a++],this._current[1]=t[a++],this._current[2]=t[a++],this._current[3]=t[a++],this._current[4]=t[a++],this._current[5]=t[a++],this._current[6]=t[a++],this._current[7]=t[a++],2===this._tweenState&&((a=this._frameIndex===this._frameCount-1?e[this._animationData.frameIntOffset+this._frameValueOffset]:e[i+1])<0&&(a+=32767),this._delta[0]=t[a++]-this._current[0],this._delta[1]=t[a++]-this._current[1],this._delta[2]=t[a++]-this._current[2],this._delta[3]=t[a++]-this._current[3],this._delta[4]=t[a++]-this._current[4],this._delta[5]=t[a++]-this._current[5],this._delta[6]=t[a++]-this._current[6],this._delta[7]=t[a++]-this._current[7])}else{var n=this.slot._slotData.color;this._current[0]=100*n.alphaMultiplier,this._current[1]=100*n.redMultiplier,this._current[2]=100*n.greenMultiplier,this._current[3]=100*n.blueMultiplier,this._current[4]=n.alphaOffset,this._current[5]=n.redOffset,this._current[6]=n.greenOffset,this._current[7]=n.blueOffset}},t.prototype._onUpdateFrame=function(){r.prototype._onUpdateFrame.call(this),this._dirty=!0,2!==this._tweenState&&(this._tweenState=0),this._result[0]=.01*(this._current[0]+this._delta[0]*this._tweenProgress),this._result[1]=.01*(this._current[1]+this._delta[1]*this._tweenProgress),this._result[2]=.01*(this._current[2]+this._delta[2]*this._tweenProgress),this._result[3]=.01*(this._current[3]+this._delta[3]*this._tweenProgress),this._result[4]=this._current[4]+this._delta[4]*this._tweenProgress,this._result[5]=this._current[5]+this._delta[5]*this._tweenProgress,this._result[6]=this._current[6]+this._delta[6]*this._tweenProgress,this._result[7]=this._current[7]+this._delta[7]*this._tweenProgress},t.prototype.fadeOut=function(){this._tweenState=0,this._dirty=!1},t.prototype.update=function(t){if(r.prototype.update.call(this,t),0!==this._tweenState||this._dirty){var e=this.slot._colorTransform;if(0!==this._animationState._fadeState||0!==this._animationState._subFadeState){if(e.alphaMultiplier!==this._result[0]||e.redMultiplier!==this._result[1]||e.greenMultiplier!==this._result[2]||e.blueMultiplier!==this._result[3]||e.alphaOffset!==this._result[4]||e.redOffset!==this._result[5]||e.greenOffset!==this._result[6]||e.blueOffset!==this._result[7]){var i=Math.pow(this._animationState._fadeProgress,4);e.alphaMultiplier+=(this._result[0]-e.alphaMultiplier)*i,e.redMultiplier+=(this._result[1]-e.redMultiplier)*i,e.greenMultiplier+=(this._result[2]-e.greenMultiplier)*i,e.blueMultiplier+=(this._result[3]-e.blueMultiplier)*i,e.alphaOffset+=(this._result[4]-e.alphaOffset)*i,e.redOffset+=(this._result[5]-e.redOffset)*i,e.greenOffset+=(this._result[6]-e.greenOffset)*i,e.blueOffset+=(this._result[7]-e.blueOffset)*i,this.slot._colorDirty=!0}}else this._dirty&&(this._dirty=!1,e.alphaMultiplier===this._result[0]&&e.redMultiplier===this._result[1]&&e.greenMultiplier===this._result[2]&&e.blueMultiplier===this._result[3]&&e.alphaOffset===this._result[4]&&e.redOffset===this._result[5]&&e.greenOffset===this._result[6]&&e.blueOffset===this._result[7]||(e.alphaMultiplier=this._result[0],e.redMultiplier=this._result[1],e.greenMultiplier=this._result[2],e.blueMultiplier=this._result[3],e.alphaOffset=this._result[4],e.redOffset=this._result[5],e.greenOffset=this._result[6],e.blueOffset=this._result[7],this.slot._colorDirty=!0))}},t}(d.SlotTimelineState);d.SlotColorTimelineState=o;var l=function(r){function t(){var t=null!==r&&r.apply(this,arguments)||this;return t._current=[],t._delta=[],t._result=[],t}return __extends(t,r),t.toString=function(){return"[class dragonBones.SlotFFDTimelineState]"},t.prototype._onClear=function(){r.prototype._onClear.call(this),this.meshOffset=0,this._dirty=!1,this._frameFloatOffset=0,this._valueCount=0,this._ffdCount=0,this._valueOffset=0,this._current.length=0,this._delta.length=0,this._result.length=0},t.prototype._onArriveAtFrame=function(){if(r.prototype._onArriveAtFrame.call(this),null!==this._timelineData){var t=this._animationData.frameFloatOffset+this._frameValueOffset+this._frameIndex*this._valueCount,e=this._armature._armatureData.scale,i=this._frameFloatArray;if(2===this._tweenState){var a=t+this._valueCount;this._frameIndex===this._frameCount-1&&(a=this._animationData.frameFloatOffset+this._frameValueOffset);for(var n=0;n<this._valueCount;++n)this._delta[n]=i[a+n]*e-(this._current[n]=i[t+n]*e)}else for(n=0;n<this._valueCount;++n)this._current[n]=i[t+n]*e}else for(n=0;n<this._valueCount;++n)this._current[n]=0},t.prototype._onUpdateFrame=function(){r.prototype._onUpdateFrame.call(this),this._dirty=!0,2!==this._tweenState&&(this._tweenState=0);for(var t=0;t<this._valueCount;++t)this._result[t]=this._current[t]+this._delta[t]*this._tweenProgress},t.prototype.init=function(t,e,i){if(r.prototype.init.call(this,t,e,i),null!==this._timelineData){var a=this._animationData.frameIntOffset+this._timelineArray[this._timelineData.offset+3];this.meshOffset=this._frameIntArray[a+0],this._ffdCount=this._frameIntArray[a+1],this._valueCount=this._frameIntArray[a+2],this._valueOffset=this._frameIntArray[a+3],this._frameFloatOffset=this._frameIntArray[a+4]+this._animationData.frameFloatOffset}else this._valueCount=0;this._current.length=this._valueCount,this._delta.length=this._valueCount,this._result.length=this._valueCount;for(var n=0;n<this._valueCount;++n)this._delta[n]=0},t.prototype.fadeOut=function(){this._tweenState=0,this._dirty=!1},t.prototype.update=function(t){if(null!==this.slot._meshData&&this.slot._meshData.offset===this.meshOffset&&(r.prototype.update.call(this,t),0!==this._tweenState||this._dirty)){var e=this.slot._ffdVertices;if(null!==this._timelineData){if(0!==this._animationState._fadeState||0!==this._animationState._subFadeState){for(var i=Math.pow(this._animationState._fadeProgress,2),a=0;a<this._ffdCount;++a)a<this._valueOffset?e[a]+=(this._frameFloatArray[this._frameFloatOffset+a]-e[a])*i:a<this._valueOffset+this._valueCount?e[a]+=(this._result[a-this._valueOffset]-e[a])*i:e[a]+=(this._frameFloatArray[this._frameFloatOffset+a-this._valueCount]-e[a])*i;this.slot._meshDirty=!0}else if(this._dirty){this._dirty=!1;for(a=0;a<this._ffdCount;++a)a<this._valueOffset?e[a]=this._frameFloatArray[this._frameFloatOffset+a]:a<this._valueOffset+this._valueCount?e[a]=this._result[a-this._valueOffset]:e[a]=this._frameFloatArray[this._frameFloatOffset+a-this._valueCount];this.slot._meshDirty=!0}}else if(this._ffdCount=e.length,0!==this._animationState._fadeState||0!==this._animationState._subFadeState){for(i=Math.pow(this._animationState._fadeProgress,2),a=0;a<this._ffdCount;++a)e[a]+=(0-e[a])*i;this.slot._meshDirty=!0}else if(this._dirty){this._dirty=!1;for(a=0;a<this._ffdCount;++a)e[a]=0;this.slot._meshDirty=!0}}},t}(d.SlotTimelineState);d.SlotFFDTimelineState=l;var h=function(r){function t(){return null!==r&&r.apply(this,arguments)||this}return __extends(t,r),t.toString=function(){return"[class dragonBones.IKConstraintTimelineState]"},t.prototype._onClear=function(){r.prototype._onClear.call(this),this._current=0,this._delta=0},t.prototype._onArriveAtFrame=function(){r.prototype._onArriveAtFrame.call(this);var t=this.constraint;if(null!==this._timelineData){var e=this._animationData.frameIntOffset+this._frameValueOffset+2*this._frameIndex,i=this._frameIntArray,a=0!==i[e++];this._current=.01*i[e++],2===this._tweenState?(this._frameIndex===this._frameCount-1&&(e=this._animationData.frameIntOffset+this._frameValueOffset),this._delta=.01*i[e+1]-this._current):this._delta=0,t._bendPositive=a}else{var n=t._constraintData;this._current=n.weight,this._delta=0,t._bendPositive=n.bendPositive}t.invalidUpdate()},t.prototype._onUpdateFrame=function(){r.prototype._onUpdateFrame.call(this),2!==this._tweenState&&(this._tweenState=0);var t=this.constraint;t._weight=this._current+this._delta*this._tweenProgress,t.invalidUpdate()},t}(d.ConstraintTimelineState);d.IKConstraintTimelineState=h}(dragonBones||(dragonBones={})),function(t){var e=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.toString=function(){return"[class dragonBones.EventObject]"},e.prototype._onClear=function(){this.time=0,this.type="",this.name="",this.armature=null,this.bone=null,this.slot=null,this.animationState=null,this.data=null},e.START="start",e.LOOP_COMPLETE="loopComplete",e.COMPLETE="complete",e.FADE_IN="fadeIn",e.FADE_IN_COMPLETE="fadeInComplete",e.FADE_OUT="fadeOut",e.FADE_OUT_COMPLETE="fadeOutComplete",e.FRAME_EVENT="frameEvent",e.SOUND_EVENT="soundEvent",e}(t.BaseObject);t.EventObject=e}(dragonBones||(dragonBones={})),function(_){var t=function(){function u(){}return u._getArmatureType=function(t){switch(t.toLowerCase()){case"stage":return 2;case"armature":return 0;case"movieclip":return 1;default:return 0}},u._getDisplayType=function(t){switch(t.toLowerCase()){case"image":return 0;case"mesh":return 2;case"armature":return 1;case"boundingbox":return 3;default:return 0}},u._getBoundingBoxType=function(t){switch(t.toLowerCase()){case"rectangle":return 0;case"ellipse":return 1;case"polygon":return 2;default:return 0}},u._getActionType=function(t){switch(t.toLowerCase()){case"play":return 0;case"frame":return 10;case"sound":return 11;default:return 0}},u._getBlendMode=function(t){switch(t.toLowerCase()){case"normal":return 0;case"add":return 1;case"alpha":return 2;case"darken":return 3;case"difference":return 4;case"erase":return 5;case"hardlight":return 6;case"invert":return 7;case"layer":return 8;case"lighten":return 9;case"multiply":return 10;case"overlay":return 11;case"screen":return 12;case"subtract":return 13;default:return 0}},u.parseDragonBonesData=function(t){return t instanceof ArrayBuffer?_.BinaryDataParser.getInstance().parseDragonBonesData(t):_.ObjectDataParser.getInstance().parseDragonBonesData(t)},u.parseTextureAtlasData=function(t,e){void 0===e&&(e=1),console.warn("已废弃");for(var i={},a=t[u.SUB_TEXTURE],n=0,r=a.length;n<r;n++){var s=a[n],o=s[u.NAME],l=new _.Rectangle,h=null;l.x=s[u.X]/e,l.y=s[u.Y]/e,l.width=s[u.WIDTH]/e,l.height=s[u.HEIGHT]/e,u.FRAME_WIDTH in s&&((h=new _.Rectangle).x=s[u.FRAME_X]/e,h.y=s[u.FRAME_Y]/e,h.width=s[u.FRAME_WIDTH]/e,h.height=s[u.FRAME_HEIGHT]/e),i[o]={region:l,frame:h,rotated:!1}}return i},u.DATA_VERSION_2_3="2.3",u.DATA_VERSION_3_0="3.0",u.DATA_VERSION_4_0="4.0",u.DATA_VERSION_4_5="4.5",u.DATA_VERSION_5_0="5.0",u.DATA_VERSION=u.DATA_VERSION_5_5="5.5",u.DATA_VERSIONS=[u.DATA_VERSION_4_0,u.DATA_VERSION_4_5,u.DATA_VERSION_5_0,u.DATA_VERSION_5_5],u.TEXTURE_ATLAS="textureAtlas",u.SUB_TEXTURE="SubTexture",u.FORMAT="format",u.IMAGE_PATH="imagePath",u.WIDTH="width",u.HEIGHT="height",u.ROTATED="rotated",u.FRAME_X="frameX",u.FRAME_Y="frameY",u.FRAME_WIDTH="frameWidth",u.FRAME_HEIGHT="frameHeight",u.DRADON_BONES="dragonBones",u.USER_DATA="userData",u.ARMATURE="armature",u.BONE="bone",u.SLOT="slot",u.CONSTRAINT="constraint",u.IK="ik",u.SKIN="skin",u.DISPLAY="display",u.ANIMATION="animation",u.Z_ORDER="zOrder",u.FFD="ffd",u.FRAME="frame",u.TRANSLATE_FRAME="translateFrame",u.ROTATE_FRAME="rotateFrame",u.SCALE_FRAME="scaleFrame",u.DISPLAY_FRAME="displayFrame",u.COLOR_FRAME="colorFrame",u.DEFAULT_ACTIONS="defaultActions",u.ACTIONS="actions",u.EVENTS="events",u.INTS="ints",u.FLOATS="floats",u.STRINGS="strings",u.CANVAS="canvas",u.TRANSFORM="transform",u.PIVOT="pivot",u.AABB="aabb",u.COLOR="color",u.VERSION="version",u.COMPATIBLE_VERSION="compatibleVersion",u.FRAME_RATE="frameRate",u.TYPE="type",u.SUB_TYPE="subType",u.NAME="name",u.PARENT="parent",u.TARGET="target",u.STAGE="stage",u.SHARE="share",u.PATH="path",u.LENGTH="length",u.DISPLAY_INDEX="displayIndex",u.BLEND_MODE="blendMode",u.INHERIT_TRANSLATION="inheritTranslation",u.INHERIT_ROTATION="inheritRotation",u.INHERIT_SCALE="inheritScale",u.INHERIT_REFLECTION="inheritReflection",u.INHERIT_ANIMATION="inheritAnimation",u.INHERIT_FFD="inheritFFD",u.BEND_POSITIVE="bendPositive",u.CHAIN="chain",u.WEIGHT="weight",u.FADE_IN_TIME="fadeInTime",u.PLAY_TIMES="playTimes",u.SCALE="scale",u.OFFSET="offset",u.POSITION="position",u.DURATION="duration",u.TWEEN_EASING="tweenEasing",u.TWEEN_ROTATE="tweenRotate",u.TWEEN_SCALE="tweenScale",u.CLOCK_WISE="clockwise",u.CURVE="curve",u.SOUND="sound",u.EVENT="event",u.ACTION="action",u.X="x",u.Y="y",u.SKEW_X="skX",u.SKEW_Y="skY",u.SCALE_X="scX",u.SCALE_Y="scY",u.VALUE="value",u.ROTATE="rotate",u.SKEW="skew",u.ALPHA_OFFSET="aO",u.RED_OFFSET="rO",u.GREEN_OFFSET="gO",u.BLUE_OFFSET="bO",u.ALPHA_MULTIPLIER="aM",u.RED_MULTIPLIER="rM",u.GREEN_MULTIPLIER="gM",u.BLUE_MULTIPLIER="bM",u.UVS="uvs",u.VERTICES="vertices",u.TRIANGLES="triangles",u.WEIGHTS="weights",u.SLOT_POSE="slotPose",u.BONE_POSE="bonePose",u.GOTO_AND_PLAY="gotoAndPlay",u.DEFAULT_NAME="default",u}();_.DataParser=t}(dragonBones||(dragonBones={})),function(z){var t=function(e){function G(){var t=null!==e&&e.apply(this,arguments)||this;return t._rawTextureAtlasIndex=0,t._rawBones=[],t._data=null,t._armature=null,t._bone=null,t._slot=null,t._skin=null,t._mesh=null,t._animation=null,t._timeline=null,t._rawTextureAtlases=null,t._defaultColorOffset=-1,t._prevClockwise=0,t._prevRotation=0,t._helpMatrixA=new z.Matrix,t._helpMatrixB=new z.Matrix,t._helpTransform=new z.Transform,t._helpColorTransform=new z.ColorTransform,t._helpPoint=new z.Point,t._helpArray=[],t._intArray=[],t._floatArray=[],t._frameIntArray=[],t._frameFloatArray=[],t._frameArray=[],t._timelineArray=[],t._actionFrames=[],t._weightSlotPose={},t._weightBonePoses={},t._cacheBones={},t._cacheMeshs={},t._slotChildActions={},t}return __extends(G,e),G._getBoolean=function(t,e,i){if(e in t){var a=t[e],n=typeof a;if("boolean"===n)return a;if("string"!==n)return!!a;switch(a){case"0":case"NaN":case"":case"false":case"null":case"undefined":return!1;default:return!0}}return i},G._getNumber=function(t,e,i){if(e in t){var a=t[e];return null===a||"NaN"===a?i:+a||0}return i},G._getString=function(t,e,i){if(e in t){var a=t[e];if("string"===typeof a){if(z.DragonBones.webAssembly)for(var n=0,r=a.length;n<r;++n)if(255<a.charCodeAt(n))return encodeURI(a);return a}return String(a)}return i},G.prototype._getCurvePoint=function(t,e,i,a,n,r,s,o,l,h){var u=1-l,_=u*u,f=l*l,m=u*_,p=3*l*_,c=3*u*f,d=l*f;h.x=m*t+p*i+c*n+d*s,h.y=m*e+p*a+c*r+d*o},G.prototype._samplingEasingCurve=function(t,e){for(var i=t.length,a=-2,n=0,r=e.length;n<r;++n){for(var s=(n+1)/(r+1);(a+6<i?t[a+6]:1)<s;)a+=6;for(var o=0<=a&&a+6<i,l=o?t[a]:0,h=o?t[a+1]:0,u=t[a+2],_=t[a+3],f=t[a+4],m=t[a+5],p=o?t[a+6]:1,c=o?t[a+7]:1,d=0,y=1;1e-4<y-d;){var g=.5*(y+d);this._getCurvePoint(l,h,u,_,f,m,p,c,g,this._helpPoint),0<s-this._helpPoint.x?d=g:y=g}e[n]=this._helpPoint.y}},G.prototype._parseActionDataInFrame=function(t,e,i,a){G.EVENT in t&&this._mergeActionFrame(t[G.EVENT],e,10,i,a),G.SOUND in t&&this._mergeActionFrame(t[G.SOUND],e,11,i,a),G.ACTION in t&&this._mergeActionFrame(t[G.ACTION],e,0,i,a),G.EVENTS in t&&this._mergeActionFrame(t[G.EVENTS],e,10,i,a),G.ACTIONS in t&&this._mergeActionFrame(t[G.ACTIONS],e,0,i,a)},G.prototype._mergeActionFrame=function(t,e,i,a,n){for(var r=z.DragonBones.webAssembly?this._armature.actions.size():this._armature.actions.length,s=this._parseActionData(t,i,a,n),o=0,l=null,h=0,u=s;h<u.length;h++){var _=u[h];this._armature.addAction(_,!1)}0===this._actionFrames.length&&((l=new T).frameStart=0,this._actionFrames.push(l),l=null);for(var f=0,m=this._actionFrames;f<m.length;f++){var p=m[f];if(p.frameStart===e){l=p;break}if(p.frameStart>e)break;o++}null===l&&((l=new T).frameStart=e,this._actionFrames.splice(o+1,0,l));for(var c=0;c<s.length;++c)l.actions.push(r+c)},G.prototype._parseArmature=function(t,e){var i=z.BaseObject.borrowObject(z.ArmatureData);if(i.name=G._getString(t,G.NAME,""),i.frameRate=G._getNumber(t,G.FRAME_RATE,this._data.frameRate),i.scale=e,G.TYPE in t&&"string"==typeof t[G.TYPE]?i.type=G._getArmatureType(t[G.TYPE]):i.type=G._getNumber(t,G.TYPE,0),0===i.frameRate&&(i.frameRate=24),this._armature=i,G.CANVAS in t){var a=t[G.CANVAS],n=z.BaseObject.borrowObject(z.CanvasData);n.hasBackground=G.COLOR in a,n.color=G._getNumber(a,G.COLOR,0),n.x=G._getNumber(a,G.X,0)*i.scale,n.y=G._getNumber(a,G.Y,0)*i.scale,n.width=G._getNumber(a,G.WIDTH,0)*i.scale,n.height=G._getNumber(a,G.HEIGHT,0)*i.scale,i.canvas=n}if(G.AABB in t){var r=t[G.AABB];i.aabb.x=G._getNumber(r,G.X,0)*i.scale,i.aabb.y=G._getNumber(r,G.Y,0)*i.scale,i.aabb.width=G._getNumber(r,G.WIDTH,0)*i.scale,i.aabb.height=G._getNumber(r,G.HEIGHT,0)*i.scale}if(G.BONE in t)for(var s=0,o=t[G.BONE];s<o.length;s++){var l=o[s],h=G._getString(l,G.PARENT,""),u=this._parseBone(l);if(0<h.length){var _=i.getBone(h);null!==_?u.parent=_:(h in this._cacheBones||(this._cacheBones[h]=[]),this._cacheBones[h].push(u))}if(u.name in this._cacheBones){for(var f=0,m=this._cacheBones[u.name];f<m.length;f++){m[f].parent=u}delete this._cacheBones[u.name]}i.addBone(u),this._rawBones.push(u)}if(G.IK in t)for(var p=0,c=t[G.IK];p<c.length;p++){var d=c[p],y=this._parseIKConstraint(d);y&&i.addConstraint(y)}if(i.sortBones(),G.SLOT in t)for(var g=0,b=0,v=t[G.SLOT];b<v.length;b++){var T=v[b];i.addSlot(this._parseSlot(T,g++))}if(G.SKIN in t)for(var D=0,A=t[G.SKIN];D<A.length;D++){var O=A[D];i.addSkin(this._parseSkin(O))}for(var S in this._cacheMeshs){var x=i.getSkin(S);if(null!==x){var B=this._cacheMeshs[S];for(var P in B){var E=B[P];for(var I in E){var M=x.getDisplay(P,I);if(null!==M)for(var w=0,F=E[I];w<F.length;w++){var C=F[w];C.offset=M.offset,C.weight=M.weight}}}}}if(G.ANIMATION in t)for(var R=0,N=t[G.ANIMATION];R<N.length;R++){var k=N[R],j=this._parseAnimation(k);i.addAnimation(j)}if(G.DEFAULT_ACTIONS in t)for(var L=0,Y=this._parseActionData(t[G.DEFAULT_ACTIONS],0,null,null);L<Y.length;L++){var U=Y[L];if(i.addAction(U,!0),0===U.type)null!==(j=i.getAnimation(U.name))&&(i.defaultAnimation=j)}if(G.ACTIONS in t)for(var X=0,V=this._parseActionData(t[G.ACTIONS],0,null,null);X<V.length;X++){U=V[X];i.addAction(U,!1)}for(var H in this._rawBones.length=0,this._armature=null,this._weightSlotPose)delete this._weightSlotPose[H];for(var H in this._weightBonePoses)delete this._weightBonePoses[H];for(var H in this._cacheMeshs)delete this._cacheMeshs[H];for(var H in this._cacheBones)delete this._cacheBones[H];for(var H in this._slotChildActions)delete this._slotChildActions[H];return i},G.prototype._parseBone=function(t){var e=z.BaseObject.borrowObject(z.BoneData);return e.inheritTranslation=G._getBoolean(t,G.INHERIT_TRANSLATION,!0),e.inheritRotation=G._getBoolean(t,G.INHERIT_ROTATION,!0),e.inheritScale=G._getBoolean(t,G.INHERIT_SCALE,!0),e.inheritReflection=G._getBoolean(t,G.INHERIT_REFLECTION,!0),e.length=G._getNumber(t,G.LENGTH,0)*this._armature.scale,e.name=G._getString(t,G.NAME,""),G.TRANSFORM in t&&this._parseTransform(t[G.TRANSFORM],e.transform,this._armature.scale),e},G.prototype._parseIKConstraint=function(t){var e=this._armature.getBone(G._getString(t,G.BONE,""));if(null===e)return null;var i=this._armature.getBone(G._getString(t,G.TARGET,""));if(null===i)return null;var a=z.BaseObject.borrowObject(z.IKConstraintData);return a.scaleEnabled=G._getBoolean(t,G.SCALE,!1),a.bendPositive=G._getBoolean(t,G.BEND_POSITIVE,!0),a.weight=G._getNumber(t,G.WEIGHT,1),a.name=G._getString(t,G.NAME,""),a.bone=e,a.target=i,0<G._getNumber(t,G.CHAIN,0)&&(a.root=e.parent),a},G.prototype._parseSlot=function(t,e){var i=z.BaseObject.borrowObject(z.SlotData);return i.displayIndex=G._getNumber(t,G.DISPLAY_INDEX,0),i.zOrder=e,i.name=G._getString(t,G.NAME,""),i.parent=this._armature.getBone(G._getString(t,G.PARENT,"")),G.BLEND_MODE in t&&"string"==typeof t[G.BLEND_MODE]?i.blendMode=G._getBlendMode(t[G.BLEND_MODE]):i.blendMode=G._getNumber(t,G.BLEND_MODE,0),G.COLOR in t?(i.color=z.SlotData.createColor(),this._parseColorTransform(t[G.COLOR],i.color)):i.color=z.SlotData.DEFAULT_COLOR,G.ACTIONS in t&&(this._slotChildActions[i.name]=this._parseActionData(t[G.ACTIONS],0,null,null)),i},G.prototype._parseSkin=function(t){var e=z.BaseObject.borrowObject(z.SkinData);if(e.name=G._getString(t,G.NAME,G.DEFAULT_NAME),0===e.name.length&&(e.name=G.DEFAULT_NAME),G.SLOT in t){var i=t[G.SLOT];this._skin=e;for(var a=0,n=i;a<n.length;a++){var r=n[a],s=G._getString(r,G.NAME,""),o=this._armature.getSlot(s);if(null!==o){if(this._slot=o,G.DISPLAY in r)for(var l=0,h=r[G.DISPLAY];l<h.length;l++){var u=h[l];e.addDisplay(s,this._parseDisplay(u))}this._slot=null}}this._skin=null}return e},G.prototype._parseDisplay=function(t){var e=G._getString(t,G.NAME,""),i=G._getString(t,G.PATH,""),a=0,n=null;switch(a=G.TYPE in t&&"string"==typeof t[G.TYPE]?G._getDisplayType(t[G.TYPE]):G._getNumber(t,G.TYPE,a)){case 0:var r=n=z.BaseObject.borrowObject(z.ImageDisplayData);r.name=e,r.path=0<i.length?i:e,this._parsePivot(t,r);break;case 1:var s=n=z.BaseObject.borrowObject(z.ArmatureDisplayData);if(s.name=e,s.path=0<i.length?i:e,s.inheritAnimation=!0,G.ACTIONS in t)for(var o=0,l=this._parseActionData(t[G.ACTIONS],0,null,null);o<l.length;o++){var h=l[o];s.addAction(h)}else if(this._slot.name in this._slotChildActions){var u=this._skin.getDisplays(this._slot.name);if(null===u?0===this._slot.displayIndex:this._slot.displayIndex===u.length){for(var _=0,f=this._slotChildActions[this._slot.name];_<f.length;_++){h=f[_];s.addAction(h)}delete this._slotChildActions[this._slot.name]}}break;case 2:var m=G._getString(t,G.SHARE,""),p=n=z.BaseObject.borrowObject(z.MeshDisplayData);if(p.name=e,p.path=0<i.length?i:e,p.inheritAnimation=G._getBoolean(t,G.INHERIT_FFD,!0),this._parsePivot(t,p),0<m.length){var c=G._getString(t,G.SKIN,""),d=this._slot.name;0===c.length&&(c=G.DEFAULT_NAME),c in this._cacheMeshs||(this._cacheMeshs[c]={});var y=this._cacheMeshs[c];d in y||(y[d]={});var g=y[d];m in g||(g[m]=[]),g[m].push(p)}else this._parseMesh(t,p);break;case 3:var b=this._parseBoundingBox(t);if(null!==b){var v=n=z.BaseObject.borrowObject(z.BoundingBoxDisplayData);v.name=e,v.path=0<i.length?i:e,v.boundingBox=b}}return null!==n&&G.TRANSFORM in t&&this._parseTransform(t[G.TRANSFORM],n.transform,this._armature.scale),n},G.prototype._parsePivot=function(t,e){if(G.PIVOT in t){var i=t[G.PIVOT];e.pivot.x=G._getNumber(i,G.X,0),e.pivot.y=G._getNumber(i,G.Y,0)}else e.pivot.x=.5,e.pivot.y=.5},G.prototype._parseMesh=function(t,e){var i=t[G.VERTICES],a=t[G.UVS],n=t[G.TRIANGLES],r=Math.floor(i.length/2),s=Math.floor(n.length/3),o=this._floatArray.length,l=o+2*r,h=this._intArray.length;e.offset=h,this._intArray.length+=4+3*s,this._intArray[h+0]=r,this._intArray[h+1]=s,this._intArray[h+2]=o;for(var u=0,_=3*s;u<_;++u)this._intArray[h+4+u]=n[u];this._floatArray.length+=2*r+2*r;for(u=0,_=2*r;u<_;++u)this._floatArray[o+u]=i[u],this._floatArray[l+u]=a[u];if(G.WEIGHTS in t){var f=t[G.WEIGHTS],m=t[G.SLOT_POSE],p=t[G.BONE_POSE],c=this._armature.sortedBones,d=new Array,y=Math.floor(p.length/7),g=this._floatArray.length,b=Math.floor(f.length-r)/2,v=this._intArray.length,T=z.BaseObject.borrowObject(z.WeightData);T.count=b,T.offset=v,d.length=y,this._intArray.length+=2+y+r+b,this._intArray[v+1]=g;for(u=0;u<y;++u){var D=p[7*u],A=this._rawBones[D];T.addBone(A),d[u]=D,this._intArray[v+2+u]=c.indexOf(A)}this._floatArray.length+=3*b,this._helpMatrixA.copyFromArray(m,0);u=0;for(var O=0,S=v+2+y,x=g;u<r;++u){var B=2*u,P=this._intArray[S++]=f[O++],E=this._floatArray[o+B],I=this._floatArray[o+B+1];this._helpMatrixA.transformPoint(E,I,this._helpPoint),E=this._helpPoint.x,I=this._helpPoint.y;for(var M=0;M<P;++M){D=f[O++];var w=d.indexOf(D);this._helpMatrixB.copyFromArray(p,7*w+1),this._helpMatrixB.invert(),this._helpMatrixB.transformPoint(E,I,this._helpPoint),this._intArray[S++]=w,this._floatArray[x++]=f[O++],this._floatArray[x++]=this._helpPoint.x,this._floatArray[x++]=this._helpPoint.y}}e.weight=T;var F=this._skin.name+"_"+this._slot.name+"_"+e.name;this._weightSlotPose[F]=m,this._weightBonePoses[F]=p}},G.prototype._parseBoundingBox=function(t){var e=null,i=0;switch(i=G.SUB_TYPE in t&&"string"==typeof t[G.SUB_TYPE]?G._getBoundingBoxType(t[G.SUB_TYPE]):G._getNumber(t,G.SUB_TYPE,i)){case 0:e=z.BaseObject.borrowObject(z.RectangleBoundingBoxData);break;case 1:e=z.BaseObject.borrowObject(z.EllipseBoundingBoxData);break;case 2:e=this._parsePolygonBoundingBox(t)}return null!==e&&(e.color=G._getNumber(t,G.COLOR,0),0!==e.type&&1!==e.type||(e.width=G._getNumber(t,G.WIDTH,0),e.height=G._getNumber(t,G.HEIGHT,0))),e},G.prototype._parsePolygonBoundingBox=function(t){var e=z.BaseObject.borrowObject(z.PolygonBoundingBoxData);if(G.VERTICES in t){var i=t[G.VERTICES],a=e.vertices;z.DragonBones.webAssembly?a.resize(i.length,0):a.length=i.length;for(var n=0,r=i.length;n<r;n+=2){var s=i[n],o=i[n+1];z.DragonBones.webAssembly?(a.set(n,s),a.set(n+1,o)):(a[n]=s,a[n+1]=o),0===n?(e.x=s,e.y=o,e.width=s,e.height=o):(s<e.x?e.x=s:s>e.width&&(e.width=s),o<e.y?e.y=o:o>e.height&&(e.height=o))}}else console.warn("Data error.\n Please reexport DragonBones Data to fixed the bug.");return e},G.prototype._parseAnimation=function(t){var e=z.BaseObject.borrowObject(z.AnimationData);if(e.frameCount=Math.max(G._getNumber(t,G.DURATION,1),1),e.playTimes=G._getNumber(t,G.PLAY_TIMES,1),e.duration=e.frameCount/this._armature.frameRate,e.fadeInTime=G._getNumber(t,G.FADE_IN_TIME,0),e.scale=G._getNumber(t,G.SCALE,1),e.name=G._getString(t,G.NAME,G.DEFAULT_NAME),0===e.name.length&&(e.name=G.DEFAULT_NAME),e.frameIntOffset=this._frameIntArray.length,e.frameFloatOffset=this._frameFloatArray.length,e.frameOffset=this._frameArray.length,this._animation=e,G.FRAME in t){var i=t[G.FRAME],a=i.length;if(0<a)for(var n=0,r=0;n<a;++n){var s=i[n];this._parseActionDataInFrame(s,r,null,null),r+=G._getNumber(s,G.DURATION,1)}}if(G.Z_ORDER in t&&(this._animation.zOrderTimeline=this._parseTimeline(t[G.Z_ORDER],null,G.FRAME,1,!1,!1,0,this._parseZOrderFrame)),G.BONE in t)for(var o=0,l=t[G.BONE];o<l.length;o++){var h=l[o];this._parseBoneTimeline(h)}if(G.SLOT in t)for(var u=0,_=t[G.SLOT];u<_.length;u++){h=_[u];this._parseSlotTimeline(h)}if(G.FFD in t)for(var f=0,m=t[G.FFD];f<m.length;f++){h=m[f];var p=G._getString(h,G.SKIN,""),c=G._getString(h,G.SLOT,""),d=G._getString(h,G.NAME,"");if(0===p.length&&(p=G.DEFAULT_NAME),this._skin=this._armature.getSkin(p),null!==this._skin&&(this._slot=this._armature.getSlot(c),this._mesh=this._skin.getDisplay(c,d),null!==this._skin&&null!==this._slot&&null!==this._mesh)){var y=this._parseTimeline(h,null,G.FRAME,22,!1,!0,0,this._parseSlotFFDFrame);null!==y&&this._animation.addSlotTimeline(this._slot,y),this._skin=null,this._slot=null,this._mesh=null}}if(G.IK in t)for(var g=0,b=t[G.IK];g<b.length;g++){h=b[g];var v=G._getString(h,G.NAME,""),T=this._armature.getConstraint(v);if(null!==T){var D=this._parseTimeline(h,null,G.FRAME,30,!0,!1,2,this._parseIKConstraintFrame);null!==D&&this._animation.addConstraintTimeline(T,D)}}return 0<this._actionFrames.length&&(this._animation.actionTimeline=this._parseTimeline(null,this._actionFrames,"",0,!1,!1,0,this._parseActionFrame),this._actionFrames.length=0),this._animation=null,e},G.prototype._parseTimeline=function(t,e,i,a,n,r,s,o){if(null!==t&&0<i.length&&i in t&&(e=t[i]),null===e)return null;var l=e.length;if(0===l)return null;var h=this._frameIntArray.length,u=this._frameFloatArray.length,_=z.BaseObject.borrowObject(z.TimelineData),f=this._timelineArray.length;if(this._timelineArray.length+=5+l,null!==t?(this._timelineArray[f+0]=Math.round(100*G._getNumber(t,G.SCALE,1)),this._timelineArray[f+1]=Math.round(100*G._getNumber(t,G.OFFSET,0))):(this._timelineArray[f+0]=100,this._timelineArray[f+1]=0),this._timelineArray[f+2]=l,this._timelineArray[f+3]=s,this._timelineArray[f+4]=n?h-this._animation.frameIntOffset:r?u-this._animation.frameFloatOffset:0,(this._timeline=_).type=a,_.offset=f,1===l)_.frameIndicesOffset=-1,this._timelineArray[f+5+0]=o.call(this,e[0],0,0)-this._animation.frameOffset;else{var m=this._animation.frameCount+1,p=this._data.frameIndices,c=0;z.DragonBones.webAssembly?(c=p.size(),p.resize(c+m,0)):(c=p.length,p.length+=m),_.frameIndicesOffset=c;for(var d=0,y=0,g=0,b=0;d<m;++d){if(g+b<=d&&y<l){var v=e[y];g=d,b=y===l-1?this._animation.frameCount-g:v instanceof T?this._actionFrames[y+1].frameStart-g:G._getNumber(v,G.DURATION,1),this._timelineArray[f+5+y]=o.call(this,v,g,b)-this._animation.frameOffset,y++}z.DragonBones.webAssembly?p.set(c+d,y-1):p[c+d]=y-1}}return this._timeline=null,_},G.prototype._parseBoneTimeline=function(t){var e=this._armature.getBone(G._getString(t,G.NAME,""));if(null!==e){var i;if(this._bone=e,this._slot=this._armature.getSlot(this._bone.name),G.TRANSLATE_FRAME in t)null!==(i=this._parseTimeline(t,null,G.TRANSLATE_FRAME,11,!1,!0,2,this._parseBoneTranslateFrame))&&this._animation.addBoneTimeline(e,i);if(G.ROTATE_FRAME in t)null!==(i=this._parseTimeline(t,null,G.ROTATE_FRAME,12,!1,!0,2,this._parseBoneRotateFrame))&&this._animation.addBoneTimeline(e,i);if(G.SCALE_FRAME in t)null!==(i=this._parseTimeline(t,null,G.SCALE_FRAME,13,!1,!0,2,this._parseBoneScaleFrame))&&this._animation.addBoneTimeline(e,i);if(G.FRAME in t)null!==(i=this._parseTimeline(t,null,G.FRAME,10,!1,!0,6,this._parseBoneAllFrame))&&this._animation.addBoneTimeline(e,i);this._bone=null,this._slot=null}},G.prototype._parseSlotTimeline=function(t){var e=this._armature.getSlot(G._getString(t,G.NAME,""));if(null!==e){this._slot=e;var i=null;null!==(i=G.DISPLAY_FRAME in t?this._parseTimeline(t,null,G.DISPLAY_FRAME,20,!1,!1,0,this._parseSlotDisplayFrame):this._parseTimeline(t,null,G.FRAME,20,!1,!1,0,this._parseSlotDisplayFrame))&&this._animation.addSlotTimeline(e,i);var a=null;null!==(a=G.COLOR_FRAME in t?this._parseTimeline(t,null,G.COLOR_FRAME,21,!0,!1,1,this._parseSlotColorFrame):this._parseTimeline(t,null,G.FRAME,21,!0,!1,1,this._parseSlotColorFrame))&&this._animation.addSlotTimeline(e,a),this._slot=null}},G.prototype._parseFrame=function(t,e,i){var a=this._frameArray.length;return this._frameArray.length+=1,this._frameArray[a+0]=e,a},G.prototype._parseTweenFrame=function(t,e,i){var a=this._parseFrame(t,e,i);if(0<i)if(G.CURVE in t){var n=i+1;this._helpArray.length=n,this._samplingEasingCurve(t[G.CURVE],this._helpArray),this._frameArray.length+=2+this._helpArray.length,this._frameArray[a+1]=2,this._frameArray[a+2]=n;for(var r=0;r<n;++r)this._frameArray[a+3+r]=Math.round(1e4*this._helpArray[r])}else{var s=-2;G.TWEEN_EASING in t&&(s=G._getNumber(t,G.TWEEN_EASING,-2)),-2===s?(this._frameArray.length+=1,this._frameArray[a+1]=0):0===s?(this._frameArray.length+=1,this._frameArray[a+1]=1):s<0?(this._frameArray.length+=2,this._frameArray[a+1]=3,this._frameArray[a+2]=Math.round(100*-s)):s<=1?(this._frameArray.length+=2,this._frameArray[a+1]=4,this._frameArray[a+2]=Math.round(100*s)):(this._frameArray.length+=2,this._frameArray[a+1]=5,this._frameArray[a+2]=Math.round(100*s-100))}else this._frameArray.length+=1,this._frameArray[a+1]=0;return a},G.prototype._parseActionFrame=function(t,e,i){var a=this._frameArray.length,n=t.actions.length;this._frameArray.length+=2+n,this._frameArray[a+0]=e,this._frameArray[a+0+1]=n;for(var r=0;r<n;++r)this._frameArray[a+0+2+r]=t.actions[r];return a},G.prototype._parseZOrderFrame=function(t,e,i){var a=this._parseFrame(t,e,i);if(G.Z_ORDER in t){var n=t[G.Z_ORDER];if(0<n.length){for(var r=this._armature.sortedSlots.length,s=new Array(r-n.length/2),o=new Array(r),l=0;l<s.length;++l)s[l]=0;for(var h=0;h<r;++h)o[h]=-1;for(var u=0,_=0,f=0,m=n.length;f<m;f+=2){for(var p=n[f],c=n[f+1];u!==p;)s[_++]=u++;o[u+c]=u++}for(;u<r;)s[_++]=u++;this._frameArray.length+=1+r;for(var d=this._frameArray[a+1]=r;d--;)-1===o[d]?this._frameArray[a+2+d]=s[--_]||0:this._frameArray[a+2+d]=o[d]||0;return a}}return this._frameArray.length+=1,this._frameArray[a+1]=0,a},G.prototype._parseBoneAllFrame=function(t,e,i){this._helpTransform.identity(),G.TRANSFORM in t&&this._parseTransform(t[G.TRANSFORM],this._helpTransform,1);var a=this._helpTransform.rotation;0!==e&&(0===this._prevClockwise?a=this._prevRotation+z.Transform.normalizeRadian(a-this._prevRotation):((0<this._prevClockwise?a>=this._prevRotation:a<=this._prevRotation)&&(this._prevClockwise=0<this._prevClockwise?this._prevClockwise-1:this._prevClockwise+1),a=this._prevRotation+a-this._prevRotation+z.Transform.PI_D*this._prevClockwise)),this._prevClockwise=G._getNumber(t,G.TWEEN_ROTATE,0),this._prevRotation=a;var n=this._parseTweenFrame(t,e,i),r=this._frameFloatArray.length;return this._frameFloatArray.length+=6,this._frameFloatArray[r++]=this._helpTransform.x,this._frameFloatArray[r++]=this._helpTransform.y,this._frameFloatArray[r++]=a,this._frameFloatArray[r++]=this._helpTransform.skew,this._frameFloatArray[r++]=this._helpTransform.scaleX,this._frameFloatArray[r++]=this._helpTransform.scaleY,this._parseActionDataInFrame(t,e,this._bone,this._slot),n},G.prototype._parseBoneTranslateFrame=function(t,e,i){var a=this._parseTweenFrame(t,e,i),n=this._frameFloatArray.length;return this._frameFloatArray.length+=2,this._frameFloatArray[n++]=G._getNumber(t,G.X,0),this._frameFloatArray[n++]=G._getNumber(t,G.Y,0),a},G.prototype._parseBoneRotateFrame=function(t,e,i){var a=G._getNumber(t,G.ROTATE,0)*z.Transform.DEG_RAD;0!==e&&(0===this._prevClockwise?a=this._prevRotation+z.Transform.normalizeRadian(a-this._prevRotation):((0<this._prevClockwise?a>=this._prevRotation:a<=this._prevRotation)&&(this._prevClockwise=0<this._prevClockwise?this._prevClockwise-1:this._prevClockwise+1),a=this._prevRotation+a-this._prevRotation+z.Transform.PI_D*this._prevClockwise)),this._prevClockwise=G._getNumber(t,G.CLOCK_WISE,0),this._prevRotation=a;var n=this._parseTweenFrame(t,e,i),r=this._frameFloatArray.length;return this._frameFloatArray.length+=2,this._frameFloatArray[r++]=a,this._frameFloatArray[r++]=G._getNumber(t,G.SKEW,0)*z.Transform.DEG_RAD,n},G.prototype._parseBoneScaleFrame=function(t,e,i){var a=this._parseTweenFrame(t,e,i),n=this._frameFloatArray.length;return this._frameFloatArray.length+=2,this._frameFloatArray[n++]=G._getNumber(t,G.X,1),this._frameFloatArray[n++]=G._getNumber(t,G.Y,1),a},G.prototype._parseSlotDisplayFrame=function(t,e,i){var a=this._parseFrame(t,e,i);return this._frameArray.length+=1,this._frameArray[a+1]=G._getNumber(t,G.VALUE in t?G.VALUE:G.DISPLAY_INDEX,0),this._parseActionDataInFrame(t,e,this._slot.parent,this._slot),a},G.prototype._parseSlotColorFrame=function(t,e,i){var a=this._parseTweenFrame(t,e,i),n=-1;if(G.VALUE in t||G.COLOR in t){var r=G.VALUE in t?t[G.VALUE]:t[G.COLOR];for(var s in r){this._parseColorTransform(r,this._helpColorTransform),n=this._intArray.length,this._intArray.length+=8,this._intArray[n++]=Math.round(100*this._helpColorTransform.alphaMultiplier),this._intArray[n++]=Math.round(100*this._helpColorTransform.redMultiplier),this._intArray[n++]=Math.round(100*this._helpColorTransform.greenMultiplier),this._intArray[n++]=Math.round(100*this._helpColorTransform.blueMultiplier),this._intArray[n++]=Math.round(this._helpColorTransform.alphaOffset),this._intArray[n++]=Math.round(this._helpColorTransform.redOffset),this._intArray[n++]=Math.round(this._helpColorTransform.greenOffset),this._intArray[n++]=Math.round(this._helpColorTransform.blueOffset),n-=8;break}}n<0&&(this._defaultColorOffset<0&&(this._defaultColorOffset=n=this._intArray.length,this._intArray.length+=8,this._intArray[n++]=100,this._intArray[n++]=100,this._intArray[n++]=100,this._intArray[n++]=100,this._intArray[n++]=0,this._intArray[n++]=0,this._intArray[n++]=0,this._intArray[n++]=0),n=this._defaultColorOffset);var o=this._frameIntArray.length;return this._frameIntArray.length+=1,this._frameIntArray[o]=n,a},G.prototype._parseSlotFFDFrame=function(t,e,i){var a=this._frameFloatArray.length,n=this._parseTweenFrame(t,e,i),r=G.VERTICES in t?t[G.VERTICES]:null,s=G._getNumber(t,G.OFFSET,0),o=this._intArray[this._mesh.offset+0],l=this._skin.name+"_"+this._slot.name+"_"+this._mesh.name,h=0,u=0,_=0,f=0;if(null!==this._mesh.weight){var m=this._weightSlotPose[l];this._helpMatrixA.copyFromArray(m,0),this._frameFloatArray.length+=2*this._mesh.weight.count,_=this._mesh.weight.offset+2+this._mesh.weight.bones.length}else this._frameFloatArray.length+=2*o;for(var p=0;p<2*o;p+=2)if(null===r?u=h=0:(h=p<s||p-s>=r.length?0:r[p-s],u=p+1<s||p+1-s>=r.length?0:r[p+1-s]),null!==this._mesh.weight){var c=this._weightBonePoses[l],d=this._intArray[_++];this._helpMatrixA.transformPoint(h,u,this._helpPoint,!0),h=this._helpPoint.x,u=this._helpPoint.y;for(var y=0;y<d;++y){var g=this._intArray[_++];this._helpMatrixB.copyFromArray(c,7*g+1),this._helpMatrixB.invert(),this._helpMatrixB.transformPoint(h,u,this._helpPoint,!0),this._frameFloatArray[a+f++]=this._helpPoint.x,this._frameFloatArray[a+f++]=this._helpPoint.y}}else this._frameFloatArray[a+p]=h,this._frameFloatArray[a+p+1]=u;if(0===e){var b=this._frameIntArray.length;this._frameIntArray.length+=5,this._frameIntArray[b+0]=this._mesh.offset,this._frameIntArray[b+1]=this._frameFloatArray.length-a,this._frameIntArray[b+2]=this._frameFloatArray.length-a,this._frameIntArray[b+3]=0,this._frameIntArray[b+4]=a,this._timelineArray[this._timeline.offset+3]=b-this._animation.frameIntOffset}return n},G.prototype._parseIKConstraintFrame=function(t,e,i){var a=this._parseTweenFrame(t,e,i),n=this._frameIntArray.length;return this._frameIntArray.length+=2,this._frameIntArray[n++]=G._getBoolean(t,G.BEND_POSITIVE,!0)?1:0,this._frameIntArray[n++]=Math.round(100*G._getNumber(t,G.WEIGHT,1)),a},G.prototype._parseActionData=function(t,e,i,a){var n=new Array;if("string"==typeof t)(l=z.BaseObject.borrowObject(z.ActionData)).type=e,l.name=t,l.bone=i,l.slot=a,n.push(l);else if(t instanceof Array)for(var r=0,s=t;r<s.length;r++){var o=s[r],l=z.BaseObject.borrowObject(z.ActionData);if(G.GOTO_AND_PLAY in o?(l.type=0,l.name=G._getString(o,G.GOTO_AND_PLAY,"")):(G.TYPE in o&&"string"==typeof o[G.TYPE]?l.type=G._getActionType(o[G.TYPE]):l.type=G._getNumber(o,G.TYPE,e),l.name=G._getString(o,G.NAME,"")),G.BONE in o){var h=G._getString(o,G.BONE,"");l.bone=this._armature.getBone(h)}else l.bone=i;if(G.SLOT in o){var u=G._getString(o,G.SLOT,"");l.slot=this._armature.getSlot(u)}else l.slot=a;var _=null;if(G.INTS in o){null===_&&(_=z.BaseObject.borrowObject(z.UserData));for(var f=0,m=o[G.INTS];f<m.length;f++){var p=m[f];_.addInt(p)}}if(G.FLOATS in o){null===_&&(_=z.BaseObject.borrowObject(z.UserData));for(var c=0,d=o[G.FLOATS];c<d.length;c++){p=d[c];_.addFloat(p)}}if(G.STRINGS in o){null===_&&(_=z.BaseObject.borrowObject(z.UserData));for(var y=0,g=o[G.STRINGS];y<g.length;y++){p=g[y];_.addString(p)}}l.data=_,n.push(l)}return n},G.prototype._parseTransform=function(t,e,i){e.x=G._getNumber(t,G.X,0)*i,e.y=G._getNumber(t,G.Y,0)*i,G.ROTATE in t||G.SKEW in t?(e.rotation=z.Transform.normalizeRadian(G._getNumber(t,G.ROTATE,0)*z.Transform.DEG_RAD),e.skew=z.Transform.normalizeRadian(G._getNumber(t,G.SKEW,0)*z.Transform.DEG_RAD)):(G.SKEW_X in t||G.SKEW_Y in t)&&(e.rotation=z.Transform.normalizeRadian(G._getNumber(t,G.SKEW_Y,0)*z.Transform.DEG_RAD),e.skew=z.Transform.normalizeRadian(G._getNumber(t,G.SKEW_X,0)*z.Transform.DEG_RAD)-e.rotation),e.scaleX=G._getNumber(t,G.SCALE_X,1),e.scaleY=G._getNumber(t,G.SCALE_Y,1)},G.prototype._parseColorTransform=function(t,e){e.alphaMultiplier=.01*G._getNumber(t,G.ALPHA_MULTIPLIER,100),e.redMultiplier=.01*G._getNumber(t,G.RED_MULTIPLIER,100),e.greenMultiplier=.01*G._getNumber(t,G.GREEN_MULTIPLIER,100),e.blueMultiplier=.01*G._getNumber(t,G.BLUE_MULTIPLIER,100),e.alphaOffset=G._getNumber(t,G.ALPHA_OFFSET,0),e.redOffset=G._getNumber(t,G.RED_OFFSET,0),e.greenOffset=G._getNumber(t,G.GREEN_OFFSET,0),e.blueOffset=G._getNumber(t,G.BLUE_OFFSET,0)},G.prototype._parseArray=function(t){this._intArray.length=0,this._floatArray.length=0,this._frameIntArray.length=0,this._frameFloatArray.length=0,this._frameArray.length=0,this._timelineArray.length=0},G.prototype._modifyArray=function(){this._intArray.length%Int16Array.BYTES_PER_ELEMENT!=0&&this._intArray.push(0),this._frameIntArray.length%Int16Array.BYTES_PER_ELEMENT!=0&&this._frameIntArray.push(0),this._frameArray.length%Int16Array.BYTES_PER_ELEMENT!=0&&this._frameArray.push(0),this._timelineArray.length%Uint16Array.BYTES_PER_ELEMENT!=0&&this._timelineArray.push(0);var t=this._intArray.length*Int16Array.BYTES_PER_ELEMENT,e=this._floatArray.length*Float32Array.BYTES_PER_ELEMENT,i=this._frameIntArray.length*Int16Array.BYTES_PER_ELEMENT,a=this._frameFloatArray.length*Float32Array.BYTES_PER_ELEMENT,n=this._frameArray.length*Int16Array.BYTES_PER_ELEMENT,r=this._timelineArray.length*Uint16Array.BYTES_PER_ELEMENT,s=t+e+i+a+n+r;if(z.DragonBones.webAssembly){for(var o=z.webAssemblyModule.HEAP16.buffer,l=z.webAssemblyModule._malloc(s),h=new Int16Array(o,l,this._intArray.length),u=new Float32Array(o,l+t,this._floatArray.length),_=new Int16Array(o,l+t+e,this._frameIntArray.length),f=new Float32Array(o,l+t+e+i,this._frameFloatArray.length),m=new Int16Array(o,l+t+e+i+a,this._frameArray.length),p=new Uint16Array(o,l+t+e+i+a+n,this._timelineArray.length),c=0,d=this._intArray.length;c<d;++c)h[c]=this._intArray[c];for(c=0,d=this._floatArray.length;c<d;++c)u[c]=this._floatArray[c];for(c=0,d=this._frameIntArray.length;c<d;++c)_[c]=this._frameIntArray[c];for(c=0,d=this._frameFloatArray.length;c<d;++c)f[c]=this._frameFloatArray[c];for(c=0,d=this._frameArray.length;c<d;++c)m[c]=this._frameArray[c];for(c=0,d=this._timelineArray.length;c<d;++c)p[c]=this._timelineArray[c];z.webAssemblyModule.setDataBinary(this._data,l,t,e,i,a,n,r)}else{var y=new ArrayBuffer(s);for(h=new Int16Array(y,0,this._intArray.length),u=new Float32Array(y,t,this._floatArray.length),_=new Int16Array(y,t+e,this._frameIntArray.length),f=new Float32Array(y,t+e+i,this._frameFloatArray.length),m=new Int16Array(y,t+e+i+a,this._frameArray.length),p=new Uint16Array(y,t+e+i+a+n,this._timelineArray.length),c=0,d=this._intArray.length;c<d;++c)h[c]=this._intArray[c];for(c=0,d=this._floatArray.length;c<d;++c)u[c]=this._floatArray[c];for(c=0,d=this._frameIntArray.length;c<d;++c)_[c]=this._frameIntArray[c];for(c=0,d=this._frameFloatArray.length;c<d;++c)f[c]=this._frameFloatArray[c];for(c=0,d=this._frameArray.length;c<d;++c)m[c]=this._frameArray[c];for(c=0,d=this._timelineArray.length;c<d;++c)p[c]=this._timelineArray[c];this._data.binary=y,this._data.intArray=h,this._data.floatArray=u,this._data.frameIntArray=_,this._data.frameFloatArray=f,this._data.frameArray=m,this._data.timelineArray=p}this._defaultColorOffset=-1},G.prototype.parseDragonBonesData=function(t,e){void 0===e&&(e=1),console.assert(null!=t,"Data error.");var i=G._getString(t,G.VERSION,""),a=G._getString(t,G.COMPATIBLE_VERSION,"");if(0<=G.DATA_VERSIONS.indexOf(i)||0<=G.DATA_VERSIONS.indexOf(a)){var n=z.BaseObject.borrowObject(z.DragonBonesData);if(n.version=i,n.name=G._getString(t,G.NAME,""),n.frameRate=G._getNumber(t,G.FRAME_RATE,24),0===n.frameRate&&(n.frameRate=24),G.ARMATURE in t){this._data=n,this._parseArray(t);for(var r=0,s=t[G.ARMATURE];r<s.length;r++){var o=s[r];n.addArmature(this._parseArmature(o,e))}this._data.binary||this._modifyArray(),G.STAGE in t?n.stage=n.getArmature(G._getString(t,G.STAGE,"")):0<n.armatureNames.length&&(n.stage=n.getArmature(n.armatureNames[0])),this._data=null}return G.TEXTURE_ATLAS in t&&(this._rawTextureAtlases=t[G.TEXTURE_ATLAS]),n}return console.assert(!1,"Nonsupport data version: "+i+"\nPlease convert DragonBones data to support version.\nRead more: https://github.com/DragonBones/Tools/"),null},G.prototype.parseTextureAtlasData=function(t,e,i){if(void 0===i&&(i=1),console.assert(void 0!==t),null===t){if(null===this._rawTextureAtlases||0===this._rawTextureAtlases.length)return!1;var a=this._rawTextureAtlases[this._rawTextureAtlasIndex++];return this.parseTextureAtlasData(a,e,i),this._rawTextureAtlasIndex>=this._rawTextureAtlases.length&&(this._rawTextureAtlasIndex=0,this._rawTextureAtlases=null),!0}if(e.width=G._getNumber(t,G.WIDTH,0),e.height=G._getNumber(t,G.HEIGHT,0),e.scale=1===i?1/G._getNumber(t,G.SCALE,1):i,e.name=G._getString(t,G.NAME,""),e.imagePath=G._getString(t,G.IMAGE_PATH,""),G.SUB_TEXTURE in t)for(var n=t[G.SUB_TEXTURE],r=0,s=n.length;r<s;++r){var o=n[r],l=e.createTexture();l.rotated=G._getBoolean(o,G.ROTATED,!1),l.name=G._getString(o,G.NAME,""),l.region.x=G._getNumber(o,G.X,0),l.region.y=G._getNumber(o,G.Y,0),l.region.width=G._getNumber(o,G.WIDTH,0),l.region.height=G._getNumber(o,G.HEIGHT,0);var h=G._getNumber(o,G.FRAME_WIDTH,-1),u=G._getNumber(o,G.FRAME_HEIGHT,-1);0<h&&0<u&&(l.frame=z.TextureData.createRectangle(),l.frame.x=G._getNumber(o,G.FRAME_X,0),l.frame.y=G._getNumber(o,G.FRAME_Y,0),l.frame.width=h,l.frame.height=u),e.addTexture(l)}return!0},G.getInstance=function(){return null===G._objectDataParserInstance&&(G._objectDataParserInstance=new G),G._objectDataParserInstance},G._objectDataParserInstance=null,G}(z.DataParser);z.ObjectDataParser=t;var T=function(){this.frameStart=0,this.actions=[]};z.ActionFrame=T}(dragonBones||(dragonBones={})),function(v){var t=function(o){function t(){return null!==o&&o.apply(this,arguments)||this}return __extends(t,o),t.prototype._inRange=function(t,e,i){return e<=t&&t<=i},t.prototype._decodeUTF8=function(t){for(var e,i=0,a="",n=0,r=0,s=0,o=0;t.length>i;){var l=t[i++];if(-1===l)e=0!==r?65533:-1;else if(0===r)this._inRange(l,0,127)?e=l:(this._inRange(l,194,223)?(r=1,o=128,n=l-192):this._inRange(l,224,239)?(r=2,o=2048,n=l-224):this._inRange(l,240,244)&&(r=3,o=65536,n=l-240),n*=Math.pow(64,r),e=null);else if(this._inRange(l,128,191))if(s+=1,n+=(l-128)*Math.pow(64,r-s),s!==r)e=null;else{var h=n,u=o;o=s=r=n=0,e=this._inRange(h,u,1114111)&&!this._inRange(h,55296,57343)?h:l}else o=s=r=n=0,i--,e=l;null!==e&&-1!==e&&(e<=65535?0<e&&(a+=String.fromCharCode(e)):(e-=65536,a+=String.fromCharCode(55296+(e>>10&1023)),a+=String.fromCharCode(56320+(1023&e))))}return a},t.prototype._getUTF16Key=function(t){for(var e=0,i=t.length;e<i;++e)if(255<t.charCodeAt(e))return encodeURI(t);return t},t.prototype._parseBinaryTimeline=function(t,e,i){void 0===i&&(i=null);var a=null!==i?i:v.BaseObject.borrowObject(v.TimelineData);a.type=t,a.offset=e,this._timeline=a;var n=this._timelineArrayBuffer[a.offset+2];if(1===n)a.frameIndicesOffset=-1;else{var r=0,s=this._animation.frameCount+1,o=this._data.frameIndices;v.DragonBones.webAssembly?(r=o.size(),o.resize(r+s,0)):(r=o.length,o.length+=s),a.frameIndicesOffset=r;for(var l=0,h=0,u=0,_=0;l<s;++l)u+_<=l&&h<n&&(u=this._frameArrayBuffer[this._animation.frameOffset+this._timelineArrayBuffer[a.offset+5+h]],_=h===n-1?this._animation.frameCount-u:this._frameArrayBuffer[this._animation.frameOffset+this._timelineArrayBuffer[a.offset+5+h+1]]-u,h++),v.DragonBones.webAssembly?o.set(r+l,h-1):o[r+l]=h-1}return this._timeline=null,a},t.prototype._parseMesh=function(t,e){e.offset=t[v.ObjectDataParser.OFFSET];var i=this._intArrayBuffer[e.offset+3];if(0<=i){var a=v.BaseObject.borrowObject(v.WeightData),n=this._intArrayBuffer[e.offset+0],r=this._intArrayBuffer[i+0];a.offset=i;for(var s=0;s<r;++s){var o=this._intArrayBuffer[i+2+s];a.addBone(this._rawBones[o])}for(var l=i+2+r,h=0,u=(s=0,n);s<u;++s){var _=this._intArrayBuffer[l++];h+=_,l+=_}a.count=h,e.weight=a}},t.prototype._parseAnimation=function(t){var e=v.BaseObject.borrowObject(v.AnimationData);e.frameCount=Math.max(v.ObjectDataParser._getNumber(t,v.ObjectDataParser.DURATION,1),1),e.playTimes=v.ObjectDataParser._getNumber(t,v.ObjectDataParser.PLAY_TIMES,1),e.duration=e.frameCount/this._armature.frameRate,e.fadeInTime=v.ObjectDataParser._getNumber(t,v.ObjectDataParser.FADE_IN_TIME,0),e.scale=v.ObjectDataParser._getNumber(t,v.ObjectDataParser.SCALE,1),e.name=v.ObjectDataParser._getString(t,v.ObjectDataParser.NAME,v.ObjectDataParser.DEFAULT_NAME),0===e.name.length&&(e.name=v.ObjectDataParser.DEFAULT_NAME);var i=t[v.ObjectDataParser.OFFSET];if(e.frameIntOffset=i[0],e.frameFloatOffset=i[1],e.frameOffset=i[2],this._animation=e,v.ObjectDataParser.ACTION in t&&(e.actionTimeline=this._parseBinaryTimeline(0,t[v.ObjectDataParser.ACTION])),v.ObjectDataParser.Z_ORDER in t&&(e.zOrderTimeline=this._parseBinaryTimeline(1,t[v.ObjectDataParser.Z_ORDER])),v.ObjectDataParser.BONE in t){var a=t[v.ObjectDataParser.BONE];for(var n in a){var r=a[n];v.DragonBones.webAssembly&&(n=this._getUTF16Key(n));var s=this._armature.getBone(n);if(null!==s)for(var o=0,l=r.length;o<l;o+=2){var h=r[o],u=r[o+1],_=this._parseBinaryTimeline(h,u);this._animation.addBoneTimeline(s,_)}}}if(v.ObjectDataParser.SLOT in t){a=t[v.ObjectDataParser.SLOT];for(var n in a){r=a[n];v.DragonBones.webAssembly&&(n=this._getUTF16Key(n));var f=this._armature.getSlot(n);if(null!==f)for(o=0,l=r.length;o<l;o+=2){h=r[o],u=r[o+1],_=this._parseBinaryTimeline(h,u);this._animation.addSlotTimeline(f,_)}}}if(v.ObjectDataParser.CONSTRAINT in t){a=t[v.ObjectDataParser.CONSTRAINT];for(var n in a){r=a[n];v.DragonBones.webAssembly&&(n=this._getUTF16Key(n));var m=this._armature.getConstraint(n);if(null!==m)for(o=0,l=r.length;o<l;o+=2){h=r[o],u=r[o+1],_=this._parseBinaryTimeline(h,u);this._animation.addConstraintTimeline(m,_)}}}return this._animation=null,e},t.prototype._parseArray=function(t){var e=t[v.ObjectDataParser.OFFSET],i=e[1],a=e[3],n=e[5],r=e[7],s=e[9],o=e[11],l=new Int16Array(this._binary,this._binaryOffset+e[0],i/Int16Array.BYTES_PER_ELEMENT),h=new Float32Array(this._binary,this._binaryOffset+e[2],a/Float32Array.BYTES_PER_ELEMENT),u=new Int16Array(this._binary,this._binaryOffset+e[4],n/Int16Array.BYTES_PER_ELEMENT),_=new Float32Array(this._binary,this._binaryOffset+e[6],r/Float32Array.BYTES_PER_ELEMENT),f=new Int16Array(this._binary,this._binaryOffset+e[8],s/Int16Array.BYTES_PER_ELEMENT),m=new Uint16Array(this._binary,this._binaryOffset+e[10],o/Uint16Array.BYTES_PER_ELEMENT);if(v.DragonBones.webAssembly){for(var p=i+a+n+r+s+o,c=v.webAssemblyModule._malloc(p),d=new Uint8Array(this._binary,this._binaryOffset,p/Uint8Array.BYTES_PER_ELEMENT),y=new Uint8Array(v.webAssemblyModule.HEAP16.buffer,c,d.length),g=0,b=d.length;g<b;++g)y[g]=d[g];v.webAssemblyModule.setDataBinary(this._data,c,i,a,n,r,s,o),this._intArrayBuffer=l,this._floatArrayBuffer=h,this._frameIntArrayBuffer=u,this._frameFloatArrayBuffer=_,this._frameArrayBuffer=f,this._timelineArrayBuffer=m}else this._data.binary=this._binary,this._data.intArray=this._intArrayBuffer=l,this._data.floatArray=this._floatArrayBuffer=h,this._data.frameIntArray=this._frameIntArrayBuffer=u,this._data.frameFloatArray=this._frameFloatArrayBuffer=_,this._data.frameArray=this._frameArrayBuffer=f,this._data.timelineArray=this._timelineArrayBuffer=m},t.prototype.parseDragonBonesData=function(t,e){void 0===e&&(e=1),console.assert(null!=t&&t instanceof ArrayBuffer,"Data error.");var i=new Uint8Array(t,0,8);if(i[0]!=="D".charCodeAt(0)||i[1]!=="B".charCodeAt(0)||i[2]!=="D".charCodeAt(0)||i[3]!=="T".charCodeAt(0))return console.assert(!1,"Nonsupport data."),null;var a=new Uint32Array(t,8,1)[0],n=new Uint8Array(t,12,a),r=this._decodeUTF8(n),s=JSON.parse(r);return this._binaryOffset=12+a,this._binary=t,o.prototype.parseDragonBonesData.call(this,s,e)},t.getInstance=function(){return null===t._binaryDataParserInstance&&(t._binaryDataParserInstance=new t),t._binaryDataParserInstance},t._binaryDataParserInstance=null,t}(v.ObjectDataParser);v.BinaryDataParser=t}(dragonBones||(dragonBones={})),function(y){var t=function(){function s(t){void 0===t&&(t=null),this.autoSearch=!1,this._dragonBonesDataMap={},this._textureAtlasDataMap={},this._dragonBones=null,(this._dataParser=null)===s._objectParser&&(s._objectParser=new y.ObjectDataParser),null===s._binaryParser&&(s._binaryParser=new y.BinaryDataParser),this._dataParser=null!==t?t:s._objectParser}return s.prototype._isSupportMesh=function(){return!0},s.prototype._getTextureData=function(t,e){if(t in this._textureAtlasDataMap)for(var i=0,a=this._textureAtlasDataMap[t];i<a.length;i++){if(null!==(l=(o=a[i]).getTexture(e)))return l}if(this.autoSearch)for(var n in this._textureAtlasDataMap)for(var r=0,s=this._textureAtlasDataMap[n];r<s.length;r++){var o,l;if((o=s[r]).autoSearch)if(null!==(l=o.getTexture(e)))return l}return null},s.prototype._fillBuildArmaturePackage=function(t,e,i,a,n){var r=null,s=null;if(0<e.length&&e in this._dragonBonesDataMap&&(s=(r=this._dragonBonesDataMap[e]).getArmature(i)),null===s&&(0===e.length||this.autoSearch))for(var o in this._dragonBonesDataMap)if(r=this._dragonBonesDataMap[o],(0===e.length||r.autoSearch)&&null!==(s=r.getArmature(i))){e=o;break}if(null!==s){if(t.dataName=e,t.textureAtlasName=n,t.data=r,t.armature=s,t.skin=null,0<a.length&&(t.skin=s.getSkin(a),null===t.skin&&this.autoSearch))for(var o in this._dragonBonesDataMap){var l=this._dragonBonesDataMap[o].getArmature(a);if(null!==l){t.skin=l.defaultSkin;break}}return null===t.skin&&(t.skin=s.defaultSkin),!0}return!1},s.prototype._buildBones=function(t,e){for(var i=0,a=t.armature.sortedBones;i<a.length;i++){var n=a[i],r=y.BaseObject.borrowObject(y.Bone);r.init(n),null!==n.parent?e.addBone(r,n.parent.name):e.addBone(r,"")}var s=t.armature.constraints;for(var o in s){var l=s[o],h=y.BaseObject.borrowObject(y.IKConstraint);h.init(l,e),e.addConstraint(h)}},s.prototype._buildSlots=function(t,e){var i=t.skin,a=t.armature.defaultSkin;if(null!==i&&null!==a){var n={};for(var r in a.displays){var s=a.getDisplays(r);n[r]=s}if(i!==a)for(var r in i.displays){s=i.getDisplays(r);n[r]=s}for(var o=0,l=t.armature.sortedSlots;o<l.length;o++){var h=l[o],u=(s=h.name in n?n[h.name]:null,this._buildSlot(t,h,s,e));if(e.addSlot(u,h.parent.name),null!==s){for(var _=new Array,f=0,m=y.DragonBones.webAssembly?s.size():s.length;f<m;++f){var p=y.DragonBones.webAssembly?s.get(f):s[f];null!==p?_.push(this._getSlotDisplay(t,p,null,u)):_.push(null)}u._setDisplayList(_)}u._setDisplayIndex(h.displayIndex,!0)}}},s.prototype._buildChildArmature=function(t,e,i){return this.buildArmature(i.path,null!==t?t.dataName:"","",null!==t?t.textureAtlasName:"")},s.prototype._getSlotDisplay=function(t,e,i,a){var n=null!==t?t.dataName:e.parent.parent.parent.name,r=null;switch(e.type){case 0:var s=e;null===s.texture?s.texture=this._getTextureData(n,e.path):null!==t&&0<t.textureAtlasName.length&&(s.texture=this._getTextureData(t.textureAtlasName,e.path)),r=null!==i&&2===i.type&&this._isSupportMesh()?a.meshDisplay:a.rawDisplay;break;case 2:var o=e;null===o.texture?o.texture=this._getTextureData(n,o.path):null!==t&&0<t.textureAtlasName.length&&(o.texture=this._getTextureData(t.textureAtlasName,o.path)),r=this._isSupportMesh()?a.meshDisplay:a.rawDisplay;break;case 1:var l=e,h=this._buildChildArmature(t,a,e);if(null!==h){if(h.inheritAnimation=l.inheritAnimation,!h.inheritAnimation){var u=0<l.actions.length?l.actions:h.armatureData.defaultActions;if(0<u.length)for(var _=0,f=u;_<f.length;_++){var m=f[_];h._bufferAction(m,!0)}else h.animation.play()}l.armature=h.armatureData}r=h}return r},s.prototype.parseDragonBonesData=function(t,e,i){void 0===e&&(e=null),void 0===i&&(i=1);for(var a=t instanceof ArrayBuffer?s._binaryParser:this._dataParser,n=a.parseDragonBonesData(t,i);;){var r=this._buildTextureAtlasData(null,null);if(!a.parseTextureAtlasData(null,r,i)){r.returnToPool();break}this.addTextureAtlasData(r,e)}return null!==n&&this.addDragonBonesData(n,e),n},s.prototype.parseTextureAtlasData=function(t,e,i,a){void 0===i&&(i=null),void 0===a&&(a=1);var n=this._buildTextureAtlasData(null,null);return this._dataParser.parseTextureAtlasData(t,n,a),this._buildTextureAtlasData(n,e||null),this.addTextureAtlasData(n,i),n},s.prototype.updateTextureAtlasData=function(t,e){var i=this.getTextureAtlasData(t);if(null!==i)for(var a=0,n=i.length;a<n;++a)a<e.length&&this._buildTextureAtlasData(i[a],e[a])},s.prototype.getDragonBonesData=function(t){return t in this._dragonBonesDataMap?this._dragonBonesDataMap[t]:null},s.prototype.addDragonBonesData=function(t,e){if(void 0===e&&(e=null),(e=null!==e?e:t.name)in this._dragonBonesDataMap){if(this._dragonBonesDataMap[e]===t)return;console.warn("Can not add same name data: "+e)}else this._dragonBonesDataMap[e]=t},s.prototype.removeDragonBonesData=function(t,e){void 0===e&&(e=!0),t in this._dragonBonesDataMap&&(e&&this._dragonBones.bufferObject(this._dragonBonesDataMap[t]),delete this._dragonBonesDataMap[t])},s.prototype.getTextureAtlasData=function(t){return t in this._textureAtlasDataMap?this._textureAtlasDataMap[t]:null},s.prototype.addTextureAtlasData=function(t,e){void 0===e&&(e=null);var i=(e=null!==e?e:t.name)in this._textureAtlasDataMap?this._textureAtlasDataMap[e]:this._textureAtlasDataMap[e]=[];i.indexOf(t)<0&&i.push(t)},s.prototype.removeTextureAtlasData=function(t,e){if(void 0===e&&(e=!0),t in this._textureAtlasDataMap){var i=this._textureAtlasDataMap[t];if(e)for(var a=0,n=i;a<n.length;a++){var r=n[a];this._dragonBones.bufferObject(r)}delete this._textureAtlasDataMap[t]}},s.prototype.getArmatureData=function(t,e){void 0===e&&(e="");var i=new o;return this._fillBuildArmaturePackage(i,e,t,"","")?i.armature:null},s.prototype.clear=function(t){for(var e in void 0===t&&(t=!0),this._dragonBonesDataMap)t&&this._dragonBones.bufferObject(this._dragonBonesDataMap[e]),delete this._dragonBonesDataMap[e];for(var e in this._textureAtlasDataMap){if(t)for(var i=0,a=this._textureAtlasDataMap[e];i<a.length;i++){var n=a[i];this._dragonBones.bufferObject(n)}delete this._textureAtlasDataMap[e]}},s.prototype.buildArmature=function(t,e,i,a){void 0===e&&(e=""),void 0===i&&(i=""),void 0===a&&(a="");var n=new o;if(!this._fillBuildArmaturePackage(n,e||"",t,i||"",a||""))return console.warn("No armature data: "+t+", "+(null!==e?e:"")),null;var r=this._buildArmature(n);return this._buildBones(n,r),this._buildSlots(n,r),r.invalidUpdate(null,!0),r.advanceTime(0),r},s.prototype.replaceDisplay=function(t,e,i){void 0===i&&(i=-1),i<0&&(i=t.displayIndex),i<0&&(i=0),t.replaceDisplayData(e,i);var a=t.displayList;if(a.length<=i){a.length=i+1;for(var n=0,r=a.length;n<r;++n)a[n]||(a[n]=null)}if(null!==e){var s=t.rawDisplayDatas,o=null;s&&(y.DragonBones.webAssembly?i<s.size()&&(o=s.get(i)):i<s.length&&(o=s[i])),a[i]=this._getSlotDisplay(null,e,o,t)}else a[i]=null;t.displayList=a},s.prototype.replaceSlotDisplay=function(t,e,i,a,n,r){void 0===r&&(r=-1);var s=this.getArmatureData(e,t||"");if(!s||!s.defaultSkin)return!1;var o=s.defaultSkin.getDisplay(i,a);return!!o&&(this.replaceDisplay(n,o,r),!0)},s.prototype.replaceSlotDisplayList=function(t,e,i,a){var n=this.getArmatureData(e,t||"");if(!n||!n.defaultSkin)return!1;var r=n.defaultSkin.getDisplays(i);if(!r)return!1;for(var s=0,o=0,l=y.DragonBones.webAssembly?r.size():r.length;o<l;++o){var h=y.DragonBones.webAssembly?r.get(o):r[o];this.replaceDisplay(a,h,s++)}return!0},s.prototype.replaceSkin=function(t,e,i,a){void 0===i&&(i=!1),void 0===a&&(a=null);for(var n=!1,r=0,s=t.getSlots();r<s.length;r++){var o=s[r];if(!(null!==a&&0<=a.indexOf(o.name))){var l=e.getDisplays(o.name);if(l){for(var h=y.DragonBones.webAssembly?l.size():l.length,u=o.displayList,_=0,f=u.length=h;_<f;++_){var m=y.DragonBones.webAssembly?l.get(_):l[_];u[_]=null!==m?this._getSlotDisplay(null,m,null,o):null}n=!0,o.rawDisplayDatas=l,o.displayList=u}else i&&(o.rawDisplayDatas=null,o.displayList=[])}}return n},s.prototype.replaceAnimation=function(t,e,i){void 0===i&&(i=!0);var a=e.defaultSkin;if(null===a)return!1;if(i)t.animation.animations=e.animations;else{var n=t.animation.animations,r={};for(var s in n)r[s]=n[s];for(var s in e.animations)r[s]=e.animations[s];t.animation.animations=r}for(var o=0,l=t.getSlots();o<l.length;o++)for(var h=l[o],u=0,_=0,f=h.displayList;_<f.length;_++){var m=f[_];if(m instanceof y.Armature){var p=a.getDisplays(h.name);if(null!==p&&u<(y.DragonBones.webAssembly?p.size():p.length)){var c=y.DragonBones.webAssembly?p.get(u):p[u];if(null!==c&&1===c.type){var d=this.getArmatureData(c.path,c.parent.parent.parent.name);d&&this.replaceAnimation(m,d,i)}}}u++}return!0},s.prototype.getAllDragonBonesData=function(){return this._dragonBonesDataMap},s.prototype.getAllTextureAtlasData=function(){return this._textureAtlasDataMap},Object.defineProperty(s.prototype,"clock",{get:function(){return this._dragonBones.clock},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"dragonBones",{get:function(){return this._dragonBones},enumerable:!0,configurable:!0}),s.prototype.changeSkin=function(t,e,i){return void 0===i&&(i=null),this.replaceSkin(t,e,!1,i)},s.prototype.copyAnimationsToArmature=function(t,e,i,a,n){void 0===i&&(i=""),void 0===a&&(a=""),void 0===n&&(n=!0);var r=this.getArmatureData(e,a);return!!r&&this.replaceAnimation(t,r,n)},s._objectParser=null,s._binaryParser=null,s}();y.BaseFactory=t;var o=function(){this.dataName="",this.textureAtlasName="",this.skin=null};y.BuildArmaturePackage=o}(dragonBones||(dragonBones={})),function(i){var t=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._renderTexture=null,t}return __extends(t,e),t.toString=function(){return"[class dragonBones.PixiTextureAtlasData]"},t.prototype._onClear=function(){e.prototype._onClear.call(this),this._renderTexture,this._renderTexture=null},t.prototype.createTexture=function(){return i.BaseObject.borrowObject(a)},Object.defineProperty(t.prototype,"renderTexture",{get:function(){return this._renderTexture},set:function(t){if(this._renderTexture!==t)if(this._renderTexture=t,null!==this._renderTexture)for(var e in this.textures){(i=this.textures[e]).renderTexture=new PIXI.Texture(this._renderTexture,i.region,i.region,new PIXI.Rectangle(0,0,i.region.width,i.region.height),i.rotated)}else for(var e in this.textures){var i;(i=this.textures[e]).renderTexture=null}},enumerable:!0,configurable:!0}),t}(i.TextureAtlasData);i.PixiTextureAtlasData=t;var a=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.renderTexture=null,t}return __extends(t,e),t.toString=function(){return"[class dragonBones.PixiTextureData]"},t.prototype._onClear=function(){e.prototype._onClear.call(this),null!==this.renderTexture&&this.renderTexture.destroy(!1),this.renderTexture=null},t}(i.TextureData);i.PixiTextureData=a}(dragonBones||(dragonBones={})),function(v){var t=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._debugDraw=!1,t._disposeProxy=!1,t._armature=null,t._debugDrawer=null,t}return __extends(t,e),t.prototype.dbInit=function(t){this._armature=t},t.prototype.dbClear=function(){null!==this._debugDrawer&&this._debugDrawer.destroy(!0),this._disposeProxy=!1,this._armature=null,this._debugDrawer=null,e.prototype.destroy.call(this)},t.prototype.dbUpdate=function(){var t=v.DragonBones.debugDraw;if(t||this._debugDraw)if(this._debugDraw=t,this._debugDraw){if(null===this._debugDrawer){this._debugDrawer=new PIXI.Sprite;var e=new PIXI.Graphics;this._debugDrawer.addChild(e)}this.addChild(this._debugDrawer);var i=this._debugDrawer.getChildAt(0);i.clear();for(var a=this._armature.getBones(),n=0,r=a.length;n<r;++n){var s=a[n],o=s.boneData.length,l=s.globalTransformMatrix.tx,h=s.globalTransformMatrix.ty,u=l+s.globalTransformMatrix.a*o,_=h+s.globalTransformMatrix.b*o;i.lineStyle(2,65535,.7),i.moveTo(l,h),i.lineTo(u,_),i.lineStyle(0,0,0),i.beginFill(65535,.7),i.drawCircle(l,h,3),i.endFill()}var f=this._armature.getSlots();for(n=0,r=f.length;n<r;++n){var m=f[n],p=m.boundingBoxData;if(p){switch((b=this._debugDrawer.getChildByName(m.name))||((b=new PIXI.Graphics).name=m.name,this._debugDrawer.addChild(b)),b.clear(),b.beginFill(16711935,.3),p.type){case 0:b.drawRect(.5*-p.width,.5*-p.height,p.width,p.height);break;case 1:b.drawEllipse(.5*-p.width,.5*-p.height,p.width,p.height);break;case 2:for(var c=p.vertices,d=0,y=c.length;d<y;d+=2)0===d?b.moveTo(c[d],c[d+1]):b.lineTo(c[d],c[d+1])}b.endFill(),m.updateTransformAndMatrix(),m.updateGlobalTransform();var g=m.global;b.setTransform(g.x,g.y,g.scaleX,g.scaleY,g.rotation,g.skew,0,m._pivotX,m._pivotY)}else{var b;(b=this._debugDrawer.getChildByName(m.name))&&this._debugDrawer.removeChild(b)}}}else this._debugDrawer&&this._debugDrawer.parent===this&&this.removeChild(this._debugDrawer)},t.prototype.dispose=function(t){void 0===t&&(t=!0),this._disposeProxy=t,null!==this._armature&&(this._armature.dispose(),this._armature=null)},t.prototype.destroy=function(){this.dispose()},t.prototype.dispatchDBEvent=function(t,e){this.emit(t,e)},t.prototype.hasDBEventListener=function(t){return this.listeners(t,!0)},t.prototype.addDBEventListener=function(t,e,i){this.addListener(t,e,i)},t.prototype.removeDBEventListener=function(t,e,i){this.removeListener(t,e,i)},Object.defineProperty(t.prototype,"armature",{get:function(){return this._armature},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"animation",{get:function(){return this._armature.animation},enumerable:!0,configurable:!0}),t.prototype.hasEvent=function(t){return this.hasDBEventListener(t)},t.prototype.addEvent=function(t,e,i){this.addDBEventListener(t,e,i)},t.prototype.removeEvent=function(t,e,i){this.removeDBEventListener(t,e,i)},Object.defineProperty(t.prototype,"width",{get:function(){var t=1;if(this.armature.armatureData.defaultSkin&&this.armature.armatureData.defaultSkin.displays){var e=Object.getOwnPropertyNames(this.armature.armatureData.defaultSkin.displays),i=this.armature.armatureData.aabb;if(0<i.width)t=i.width;else{var a=this.armature.armatureData.defaultSkin.displays[e[0]][0];a&&a.texture&&(a.texture.frame?t=a.texture.frame.width:a.texture.region&&(t=a.texture.region.width))}}return t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"height",{get:function(){var t=1;if(this.armature.armatureData.defaultSkin&&this.armature.armatureData.defaultSkin.displays){var e=Object.getOwnPropertyNames(this.armature.armatureData.defaultSkin.displays),i=this.armature.armatureData.aabb;if(0<i.height)t=i.height;else{var a=this.armature.armatureData.defaultSkin.displays[e[0]][0];a&&a.texture&&(a.texture.frame?t=a.texture.frame.height:a.texture.region&&(t=a.texture.region.height))}}return t},enumerable:!0,configurable:!0}),t}(PIXI.Sprite);v.PixiArmatureDisplay=t}(dragonBones||(dragonBones={})),function(b){var t=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.toString=function(){return"[class dragonBones.PixiSlot]"},e.prototype._onClear=function(){t.prototype._onClear.call(this),this._textureScale=1,this._renderDisplay=null,this._updateTransform="3"===PIXI.VERSION[0]?this._updateTransformV3:this._updateTransformV4},e.prototype._initDisplay=function(t){},e.prototype._disposeDisplay=function(t){t.destroy()},e.prototype._onUpdateDisplay=function(){this._renderDisplay=this._display?this._display:this._rawDisplay},e.prototype._addDisplay=function(){this._armature.display.addChild(this._renderDisplay)},e.prototype._replaceDisplay=function(t){var e=this._armature.display,i=t;e.addChild(this._renderDisplay),e.swapChildren(this._renderDisplay,i),e.removeChild(i),this._textureScale=1},e.prototype._removeDisplay=function(){this._renderDisplay.parent.removeChild(this._renderDisplay)},e.prototype._updateZOrder=function(){var t=this._armature.display;t.getChildIndex(this._renderDisplay)!==this._zOrder&&t.addChildAt(this._renderDisplay,this._zOrder)},e.prototype._updateVisible=function(){this._renderDisplay.visible=this._parent.visible&&this._visible},e.prototype._updateBlendMode=function(){if(this._renderDisplay instanceof PIXI.Sprite)switch(this._blendMode){case 0:this._renderDisplay.blendMode=PIXI.BLEND_MODES.NORMAL;break;case 1:this._renderDisplay.blendMode=PIXI.BLEND_MODES.ADD;break;case 3:this._renderDisplay.blendMode=PIXI.BLEND_MODES.DARKEN;break;case 4:this._renderDisplay.blendMode=PIXI.BLEND_MODES.DIFFERENCE;break;case 6:this._renderDisplay.blendMode=PIXI.BLEND_MODES.HARD_LIGHT;break;case 9:this._renderDisplay.blendMode=PIXI.BLEND_MODES.LIGHTEN;break;case 10:this._renderDisplay.blendMode=PIXI.BLEND_MODES.MULTIPLY;break;case 11:this._renderDisplay.blendMode=PIXI.BLEND_MODES.OVERLAY;break;case 12:this._renderDisplay.blendMode=PIXI.BLEND_MODES.SCREEN}},e.prototype._updateColor=function(){if(this._renderDisplay.alpha=this._colorTransform.alphaMultiplier,this._renderDisplay instanceof PIXI.Sprite||this._renderDisplay instanceof PIXI.mesh.Mesh){var t=(Math.round(255*this._colorTransform.redMultiplier)<<16)+(Math.round(255*this._colorTransform.greenMultiplier)<<8)+Math.round(255*this._colorTransform.blueMultiplier);this._renderDisplay.tint=t}},e.prototype._updateFrame=function(){var t=this._display===this._meshDisplay?this._meshData:null,e=this._textureData;if(0<=this._displayIndex&&null!==this._display&&null!==e){var i=e.parent;null!==this._armature.replacedTexture&&null!==this._rawDisplayDatas&&0<=this._rawDisplayDatas.indexOf(this._displayData)&&(null===this._armature._replaceTextureAtlasData?((i=b.BaseObject.borrowObject(b.PixiTextureAtlasData)).copyFrom(e.parent),i.renderTexture=this._armature.replacedTexture,this._armature._replaceTextureAtlasData=i):i=this._armature._replaceTextureAtlasData,e=i.getTexture(e.name));var a=e.renderTexture;if(null!==a){if(null!==t){var n=t.parent.parent.parent,r=n.intArray,s=n.floatArray,o=r[t.offset+0],l=r[t.offset+1],h=r[t.offset+2];h<0&&(h+=65536);var u=h+2*o,_=this._renderDisplay,f=0<i.width?i.width:a.width,m=0<i.height?i.height:a.height;_.vertices=new Float32Array(2*o),_.uvs=new Float32Array(2*o),_.indices=new Uint16Array(3*l);for(var p=0,c=2*o;p<c;++p)_.vertices[p]=s[h+p],_.uvs[p]=s[u+p];for(p=0;p<3*l;++p)_.indices[p]=r[t.offset+4+p];for(p=0,c=_.uvs.length;p<c;p+=2){var d=_.uvs[p],y=_.uvs[p+1];e.rotated?(_.uvs[p]=(e.region.x+(1-y)*e.region.width)/f,_.uvs[p+1]=(e.region.y+d*e.region.height)/m):(_.uvs[p]=(e.region.x+d*e.region.width)/f,_.uvs[p+1]=(e.region.y+y*e.region.height)/m)}this._textureScale=1,_.texture=a,_.dirty++}else{var g;this._textureScale=e.parent.scale*this._armature._armatureData.scale,(g=this._renderDisplay).texture=a}return void(this._visibleDirty=!0)}}null!==t?((_=this._renderDisplay).texture=null,_.x=0,_.y=0,_.visible=!1):((g=this._renderDisplay).texture=null,g.x=0,g.y=0,g.visible=!1)},e.prototype._updateMesh=function(){var t=0<this._ffdVertices.length,e=this._armature._armatureData.scale,i=this._meshData,a=i.weight,n=this._renderDisplay;if(null!==a){var r=(O=i.parent.parent.parent).intArray,s=O.floatArray,o=r[i.offset+0],l=r[a.offset+1];l<0&&(l+=65536);for(var h=0,u=0,_=a.offset+2+a.bones.length,f=l,m=0;h<o;++h){for(var p=r[_++],c=0,d=0,y=0;y<p;++y){var g=r[_++],b=this._meshBones[g];if(null!==b){var v=b.globalTransformMatrix,T=s[f++],D=s[f++]*e,A=s[f++]*e;t&&(D+=this._ffdVertices[m++],A+=this._ffdVertices[m++]),c+=(v.a*D+v.c*A+v.tx)*T,d+=(v.b*D+v.d*A+v.ty)*T}}n.vertices[u++]=c,n.vertices[u++]=d}}else if(t){r=(O=i.parent.parent.parent).intArray,s=O.floatArray,o=r[i.offset+0];var O,S=r[i.offset+2];S<0&&(S+=65536);h=0;for(var x=2*o;h<x;++h)n.vertices[h]=s[S+h]*e+this._ffdVertices[h]}},e.prototype._updateTransform=function(t){throw new Error},e.prototype._updateTransformV3=function(t){if(t)this._renderDisplay.setTransform(0,0,1,1,0,0,0);else{this.updateGlobalTransform();var e=this.global;if(this._renderDisplay===this._rawDisplay||this._renderDisplay===this._meshDisplay){var i=e.x-(this.globalTransformMatrix.a*this._pivotX+this.globalTransformMatrix.c*this._pivotY),a=e.y-(this.globalTransformMatrix.b*this._pivotX+this.globalTransformMatrix.d*this._pivotY);this._renderDisplay.setTransform(i,a,e.scaleX*this._textureScale,e.scaleY*this._textureScale,e.rotation,e.skew,0)}else this._renderDisplay.position.set(e.x,e.y),this._renderDisplay.rotation=e.rotation,this._renderDisplay.skew.set(e.skew,0),this._renderDisplay.scale.set(e.scaleX,e.scaleY)}},e.prototype._updateTransformV4=function(t){if(t)this._renderDisplay.setTransform(0,0,1,1,0,0,0);else{this.updateGlobalTransform();var e=this.global;if(this._renderDisplay===this._rawDisplay||this._renderDisplay===this._meshDisplay){var i=e.x-(this.globalTransformMatrix.a*this._pivotX+this.globalTransformMatrix.c*this._pivotY),a=e.y-(this.globalTransformMatrix.b*this._pivotX+this.globalTransformMatrix.d*this._pivotY);this._renderDisplay.setTransform(i,a,e.scaleX*this._textureScale,e.scaleY*this._textureScale,e.rotation,-e.skew,0)}else this._renderDisplay.position.set(e.x,e.y),this._renderDisplay.rotation=e.rotation,this._renderDisplay.skew.set(-e.skew,0),this._renderDisplay.scale.set(e.scaleX,e.scaleY)}},e}(b.Slot);b.PixiSlot=t}(dragonBones||(dragonBones={})),function(r){var t=function(i){function a(t){void 0===t&&(t=null);var e=i.call(this,t)||this;return null===a._dragonBonesInstance&&(a._dragonBonesInstance=a._createDragonBones()),e._dragonBones=a._dragonBonesInstance,e}return __extends(a,i),a._clockHandler=function(t){a._dragonBonesInstance.advanceTime(PIXI.ticker.shared.elapsedMS*t*.001)},a._createDragonBones=function(){var t=new r.PixiArmatureDisplay,e=new r.DragonBones(t);return PIXI.ticker.shared.add(a._clockHandler,a),e},Object.defineProperty(a,"factory",{get:function(){return null===a._factory&&(a._factory=new a),a._factory},enumerable:!0,configurable:!0}),a.prototype._buildTextureAtlasData=function(t,e){return t?t.renderTexture=e:t=r.BaseObject.borrowObject(r.PixiTextureAtlasData),t},a.prototype._buildArmature=function(t){var e=r.BaseObject.borrowObject(r.Armature),i=new r.PixiArmatureDisplay;return e.init(t.armature,i,i,this._dragonBones),e},a.prototype._buildSlot=function(t,e,i,a){var n=r.BaseObject.borrowObject(r.PixiSlot);return n.init(e,i,new PIXI.Sprite,new PIXI.mesh.Mesh(null,null,null,null,PIXI.mesh.Mesh.DRAW_MODES.TRIANGLES)),n},a.prototype.buildArmatureDisplay=function(t,e,i,a){void 0===e&&(e=""),void 0===i&&(i=""),void 0===a&&(a="");var n=this.buildArmature(t,e||"",i||"",a||"");return null!==n?(this._dragonBones.clock.add(n),n.display):null},a.prototype.getTextureDisplay=function(t,e){void 0===e&&(e=null);var i=this._getTextureData(null!==e?e:"",t);return null!==i&&null!==i.renderTexture?new PIXI.Sprite(i.renderTexture):null},Object.defineProperty(a.prototype,"soundEventManager",{get:function(){return this._dragonBones.eventManager},enumerable:!0,configurable:!0}),Object.defineProperty(a,"clock",{get:function(){return a.factory.clock},enumerable:!0,configurable:!0}),a._dragonBonesInstance=null,a._factory=null,a}(r.BaseFactory);r.PixiFactory=t}(dragonBones||(dragonBones={})),exports.dragonBones=dragonBones;
//# sourceMappingURL=/sm/aac25cf7b18fd4b86d468ede04eb17927314e7e160cd2e5173ec75c3948bad7d.map